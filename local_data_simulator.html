<!DOCTYPE html>
<html lang="zh-CN">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>æœ¬åœ°æ•°æ®æ¨¡æ‹Ÿå™¨</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Arial', sans-serif;
                background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
                color: #fff;
                min-height: 100vh;
                padding: 20px;
            }

            .container {
                max-width: 1200px;
                margin: 0 auto;
            }

            .header {
                text-align: center;
                margin-bottom: 30px;
            }

            .header h1 {
                color: #00d4ff;
                font-size: 2.5rem;
                margin-bottom: 10px;
            }

            .controls {
                display: flex;
                gap: 15px;
                margin-bottom: 20px;
                flex-wrap: wrap;
                justify-content: center;
            }

            .btn {
                padding: 12px 24px;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-size: 1rem;
                font-weight: bold;
                transition: all 0.3s ease;
            }

            .btn-primary {
                background: linear-gradient(45deg, #00d4ff, #0099cc);
                color: white;
            }

            .btn-primary:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0, 212, 255, 0.4);
            }

            .btn-success {
                background: linear-gradient(45deg, #00ff88, #00cc6a);
                color: white;
            }

            .btn-success:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0, 255, 136, 0.4);
            }

            .btn-warning {
                background: linear-gradient(45deg, #ffa502, #ff6b35);
                color: white;
            }

            .btn-warning:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(255, 165, 2, 0.4);
            }

            .btn-danger {
                background: linear-gradient(45deg, #ff4757, #ff3742);
                color: white;
            }

            .btn-danger:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(255, 71, 87, 0.4);
            }

            .status-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 20px;
                margin-bottom: 30px;
            }

            .status-card {
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(0, 212, 255, 0.3);
                border-radius: 10px;
                padding: 20px;
                backdrop-filter: blur(10px);
            }

            .status-card h3 {
                color: #00d4ff;
                margin-bottom: 15px;
                font-size: 1.2rem;
            }

            .status-indicator {
                display: inline-block;
                width: 12px;
                height: 12px;
                border-radius: 50%;
                margin-right: 8px;
            }

            .status-indicator.running {
                background: #00ff88;
                box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
                animation: pulse 1.5s infinite;
            }

            .status-indicator.stopped {
                background: #ff4757;
                box-shadow: 0 0 10px rgba(255, 71, 87, 0.5);
            }

            @keyframes pulse {
                0% {
                    opacity: 1;
                }

                50% {
                    opacity: 0.5;
                }

                100% {
                    opacity: 1;
                }
            }

            .data-table {
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(0, 212, 255, 0.3);
                border-radius: 10px;
                padding: 20px;
                backdrop-filter: blur(10px);
                margin-bottom: 20px;
            }

            .data-table h3 {
                color: #00d4ff;
                margin-bottom: 15px;
            }

            table {
                width: 100%;
                border-collapse: collapse;
            }

            th,
            td {
                padding: 12px;
                text-align: left;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }

            th {
                background: rgba(0, 212, 255, 0.2);
                color: #00d4ff;
                font-weight: bold;
            }

            .price-up {
                color: #00ff88;
                animation: priceUp 0.5s ease;
            }

            .price-down {
                color: #ff4757;
                animation: priceDown 0.5s ease;
            }

            @keyframes priceUp {
                0% {
                    background: rgba(0, 255, 136, 0.3);
                }

                100% {
                    background: transparent;
                }
            }

            @keyframes priceDown {
                0% {
                    background: rgba(255, 71, 87, 0.3);
                }

                100% {
                    background: transparent;
                }
            }

            .stats {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
                margin-bottom: 20px;
            }

            .stat-item {
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(0, 212, 255, 0.3);
                border-radius: 8px;
                padding: 15px;
                text-align: center;
            }

            .stat-value {
                font-size: 2rem;
                font-weight: bold;
                color: #00d4ff;
            }

            .stat-label {
                color: #ccc;
                font-size: 0.9rem;
                margin-top: 5px;
            }

            .log-container {
                background: rgba(0, 0, 0, 0.8);
                border: 1px solid rgba(0, 212, 255, 0.3);
                border-radius: 10px;
                padding: 20px;
                height: 300px;
                overflow-y: auto;
                font-family: 'Courier New', monospace;
                font-size: 0.9rem;
            }

            .log-entry {
                margin-bottom: 5px;
                padding: 5px;
                border-radius: 4px;
            }

            .log-info {
                color: #00d4ff;
            }

            .log-success {
                color: #00ff88;
            }

            .log-warning {
                color: #ffa502;
            }

            .log-error {
                color: #ff4757;
            }

            .config-panel {
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(0, 212, 255, 0.3);
                border-radius: 10px;
                padding: 20px;
                margin-bottom: 20px;
            }

            .config-panel h3 {
                color: #00d4ff;
                margin-bottom: 15px;
            }

            .config-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
            }

            .config-item {
                display: flex;
                flex-direction: column;
            }

            .config-item label {
                color: #ccc;
                margin-bottom: 5px;
                font-size: 0.9rem;
            }

            .config-item input,
            .config-item select {
                padding: 8px;
                border: 1px solid rgba(0, 212, 255, 0.3);
                border-radius: 5px;
                background: rgba(0, 0, 0, 0.3);
                color: #fff;
            }

            .config-item input:focus,
            .config-item select:focus {
                outline: none;
                border-color: #00d4ff;
                box-shadow: 0 0 5px rgba(0, 212, 255, 0.3);
            }
        </style>
    </head>

    <body>
        <div class="container">
            <div class="header">
                <h1>ğŸ® æœ¬åœ°æ•°æ®æ¨¡æ‹Ÿå™¨</h1>
                <p>åœ¨æ— æ³•è¿æ¥å¤–éƒ¨APIæ—¶æä¾›æ¨¡æ‹Ÿæ•°æ®ï¼Œç¡®ä¿ç³»ç»Ÿæ­£å¸¸è¿è¡Œ</p>
            </div>

            <div class="controls">
                <button class="btn btn-success" onclick="startSimulator()">å¯åŠ¨æ¨¡æ‹Ÿå™¨</button>
                <button class="btn btn-danger" onclick="stopSimulator()">åœæ­¢æ¨¡æ‹Ÿå™¨</button>
                <button class="btn btn-warning" onclick="resetData()">é‡ç½®æ•°æ®</button>
                <button class="btn btn-primary" onclick="exportData()">å¯¼å‡ºæ•°æ®</button>
                <button class="btn btn-primary" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
            </div>

            <div class="config-panel">
                <h3>æ¨¡æ‹Ÿå™¨é…ç½®</h3>
                <div class="config-grid">
                    <div class="config-item">
                        <label>æ›´æ–°é¢‘ç‡ (ç§’)</label>
                        <input type="number" id="updateFrequency" value="3" min="1" max="60">
                    </div>
                    <div class="config-item">
                        <label>ä»·æ ¼æ³¢åŠ¨èŒƒå›´ (%)</label>
                        <input type="number" id="volatilityRange" value="2" min="0.1" max="10" step="0.1">
                    </div>
                    <div class="config-item">
                        <label>æ¨¡æ‹Ÿæ¨¡å¼</label>
                        <select id="simulationMode">
                            <option value="realistic">çœŸå®æ¨¡å¼</option>
                            <option value="volatile">é«˜æ³¢åŠ¨æ¨¡å¼</option>
                            <option value="stable">ç¨³å®šæ¨¡å¼</option>
                            <option value="trending">è¶‹åŠ¿æ¨¡å¼</option>
                        </select>
                    </div>
                    <div class="config-item">
                        <label>æ•°æ®è´¨é‡</label>
                        <select id="dataQuality">
                            <option value="high">é«˜è´¨é‡</option>
                            <option value="medium">ä¸­ç­‰è´¨é‡</option>
                            <option value="low">ä½è´¨é‡</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="simulationCount">0</div>
                    <div class="stat-label">æ¨¡æ‹Ÿæ¬¡æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="dataUpdateCount">0</div>
                    <div class="stat-label">æ•°æ®æ›´æ–°æ¬¡æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="uptime">0s</div>
                    <div class="stat-label">è¿è¡Œæ—¶é—´</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="successRate">0%</div>
                    <div class="stat-label">æˆåŠŸç‡</div>
                </div>
            </div>

            <div class="status-grid">
                <div class="status-card">
                    <h3>æ¨¡æ‹Ÿå™¨çŠ¶æ€</h3>
                    <div>
                        <span class="status-indicator" id="simulatorStatusIndicator"></span>
                        <span id="simulatorStatusText">å·²åœæ­¢</span>
                    </div>
                    <div style="margin-top: 10px;">
                        <strong>å¯åŠ¨æ—¶é—´:</strong> <span id="startTime">-</span>
                    </div>
                    <div>
                        <strong>æœ€åæ›´æ–°:</strong> <span id="lastUpdate">-</span>
                    </div>
                    <div>
                        <strong>è¿è¡Œæ¨¡å¼:</strong> <span id="currentMode">-</span>
                    </div>
                </div>

                <div class="status-card">
                    <h3>æ•°æ®è´¨é‡</h3>
                    <div>
                        <strong>å»¶è¿Ÿ:</strong> <span id="dataLatency">-</span>
                    </div>
                    <div>
                        <strong>æ•°æ®å®Œæ•´æ€§:</strong> <span id="dataIntegrity">-</span>
                    </div>
                    <div>
                        <strong>æ³¢åŠ¨æ€§:</strong> <span id="volatility">-</span>
                    </div>
                </div>

                <div class="status-card">
                    <h3>æ€§èƒ½æŒ‡æ ‡</h3>
                    <div>
                        <strong>CPUä½¿ç”¨ç‡:</strong> <span id="cpuUsage">-</span>
                    </div>
                    <div>
                        <strong>å†…å­˜ä½¿ç”¨:</strong> <span id="memoryUsage">-</span>
                    </div>
                    <div>
                        <strong>é”™è¯¯ç‡:</strong> <span id="errorRate">-</span>
                    </div>
                </div>
            </div>

            <div class="data-table">
                <h3>æ¨¡æ‹Ÿä»·æ ¼æ•°æ®</h3>
                <table>
                    <thead>
                        <tr>
                            <th>äº¤æ˜“å¯¹</th>
                            <th>å½“å‰ä»·æ ¼</th>
                            <th>24hæ¶¨è·Œ</th>
                            <th>æœ€åæ›´æ–°</th>
                            <th>æ•°æ®æº</th>
                            <th>æ›´æ–°é¢‘ç‡</th>
                            <th>è¶‹åŠ¿</th>
                        </tr>
                    </thead>
                    <tbody id="priceTableBody">
                        <tr>
                            <td>BTC/USDT</td>
                            <td id="btcPrice">-</td>
                            <td id="btcChange">-</td>
                            <td id="btcUpdate">-</td>
                            <td id="btcSource">-</td>
                            <td id="btcFrequency">-</td>
                            <td id="btcTrend">-</td>
                        </tr>
                        <tr>
                            <td>ETH/USDT</td>
                            <td id="ethPrice">-</td>
                            <td id="ethChange">-</td>
                            <td id="ethUpdate">-</td>
                            <td id="ethSource">-</td>
                            <td id="ethFrequency">-</td>
                            <td id="ethTrend">-</td>
                        </tr>
                        <tr>
                            <td>BNB/USDT</td>
                            <td id="bnbPrice">-</td>
                            <td id="bnbChange">-</td>
                            <td id="bnbUpdate">-</td>
                            <td id="bnbSource">-</td>
                            <td id="bnbFrequency">-</td>
                            <td id="bnbTrend">-</td>
                        </tr>
                        <tr>
                            <td>SOL/USDT</td>
                            <td id="solPrice">-</td>
                            <td id="solChange">-</td>
                            <td id="solUpdate">-</td>
                            <td id="solSource">-</td>
                            <td id="solFrequency">-</td>
                            <td id="solTrend">-</td>
                        </tr>
                        <tr>
                            <td>XRP/USDT</td>
                            <td id="xrpPrice">-</td>
                            <td id="xrpChange">-</td>
                            <td id="xrpUpdate">-</td>
                            <td id="xrpSource">-</td>
                            <td id="xrpFrequency">-</td>
                            <td id="xrpTrend">-</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="data-table">
                <h3>æ¨¡æ‹Ÿå™¨æ—¥å¿—</h3>
                <div class="log-container" id="logContainer">
                    <div class="log-entry log-info">æœ¬åœ°æ•°æ®æ¨¡æ‹Ÿå™¨å·²å¯åŠ¨</div>
                </div>
            </div>
        </div>

        <script>
            // å…¨å±€å˜é‡
            let simulatorRunning = false;
            let simulatorInterval = null;
            let startTime = 0;
            let lastUpdateTime = 0;
            let simulationCount = 0;
            let dataUpdateCount = 0;
            let errorCount = 0;

            // åŸºç¡€ä»·æ ¼æ•°æ®
            let basePrices = {
                btc: 45000,
                eth: 2800,
                bnb: 320,
                sol: 95,
                xrp: 0.52
            };

            // å½“å‰ä»·æ ¼æ•°æ®
            let currentPrices = { ...basePrices };

            // ä»·æ ¼è¶‹åŠ¿
            let priceTrends = {
                btc: 0,
                eth: 0,
                bnb: 0,
                sol: 0,
                xrp: 0
            };

            // åˆå§‹åŒ–
            document.addEventListener('DOMContentLoaded', function () {
                updateStats();
                startUptimeCounter();
                log('info', 'æœ¬åœ°æ•°æ®æ¨¡æ‹Ÿå™¨å·²å¯åŠ¨');
            });

            // å¯åŠ¨æ¨¡æ‹Ÿå™¨
            function startSimulator() {
                if (simulatorRunning) {
                    log('warning', 'æ¨¡æ‹Ÿå™¨å·²åœ¨è¿è¡Œä¸­');
                    return;
                }

                simulatorRunning = true;
                startTime = Date.now();
                simulationCount = 0;
                dataUpdateCount = 0;
                errorCount = 0;

                log('success', 'æ¨¡æ‹Ÿå™¨å¯åŠ¨æˆåŠŸ');
                updateSimulatorStatus('running', 'è¿è¡Œä¸­');
                updateStats();

                const frequency = parseInt(document.getElementById('updateFrequency').value) * 1000;
                simulatorInterval = setInterval(generateSimulatedData, frequency);
            }

            // åœæ­¢æ¨¡æ‹Ÿå™¨
            function stopSimulator() {
                if (!simulatorRunning) {
                    log('warning', 'æ¨¡æ‹Ÿå™¨æœªåœ¨è¿è¡Œ');
                    return;
                }

                simulatorRunning = false;
                if (simulatorInterval) {
                    clearInterval(simulatorInterval);
                    simulatorInterval = null;
                }

                log('info', 'æ¨¡æ‹Ÿå™¨å·²åœæ­¢');
                updateSimulatorStatus('stopped', 'å·²åœæ­¢');
            }

            // é‡ç½®æ•°æ®
            function resetData() {
                currentPrices = { ...basePrices };
                priceTrends = {
                    btc: 0,
                    eth: 0,
                    bnb: 0,
                    sol: 0,
                    xrp: 0
                };
                simulationCount = 0;
                dataUpdateCount = 0;
                errorCount = 0;

                log('info', 'æ•°æ®å·²é‡ç½®');
                updateStats();
                updatePriceDisplay();
            }

            // ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
            function generateSimulatedData() {
                try {
                    simulationCount++;
                    const mode = document.getElementById('simulationMode').value;
                    const volatility = parseFloat(document.getElementById('volatilityRange').value);

                    Object.keys(currentPrices).forEach(coin => {
                        const oldPrice = currentPrices[coin];
                        let changePercent = 0;

                        // æ ¹æ®æ¨¡å¼ç”Ÿæˆä»·æ ¼å˜åŒ–
                        switch (mode) {
                            case 'realistic':
                                changePercent = (Math.random() - 0.5) * volatility * 2;
                                break;
                            case 'volatile':
                                changePercent = (Math.random() - 0.5) * volatility * 4;
                                break;
                            case 'stable':
                                changePercent = (Math.random() - 0.5) * volatility * 0.5;
                                break;
                            case 'trending':
                                // æ·»åŠ è¶‹åŠ¿æ€§å˜åŒ–
                                priceTrends[coin] += (Math.random() - 0.5) * 0.1;
                                priceTrends[coin] = Math.max(-1, Math.min(1, priceTrends[coin]));
                                changePercent = priceTrends[coin] * volatility + (Math.random() - 0.5) * volatility;
                                break;
                        }

                        // è®¡ç®—æ–°ä»·æ ¼
                        const changeMultiplier = 1 + (changePercent / 100);
                        currentPrices[coin] = oldPrice * changeMultiplier;

                        // æ›´æ–°æ˜¾ç¤º
                        updatePriceDisplay(coin, oldPrice, changePercent);
                    });

                    dataUpdateCount++;
                    lastUpdateTime = Date.now();
                    updateStats();
                    updateSimulatorStatus('running', 'è¿è¡Œä¸­');

                } catch (error) {
                    errorCount++;
                    log('error', 'ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®å¤±è´¥: ' + error.message);
                    updateStats();
                }
            }

            // æ›´æ–°ä»·æ ¼æ˜¾ç¤º
            function updatePriceDisplay(coin, oldPrice, changePercent) {
                const priceElement = document.getElementById(coin + 'Price');
                const changeElement = document.getElementById(coin + 'Change');
                const updateElement = document.getElementById(coin + 'Update');
                const sourceElement = document.getElementById(coin + 'Source');
                const frequencyElement = document.getElementById(coin + 'Frequency');
                const trendElement = document.getElementById(coin + 'Trend');

                if (priceElement && changeElement && updateElement && sourceElement && frequencyElement && trendElement) {
                    const price = currentPrices[coin];
                    const trend = priceTrends[coin];

                    // ä»·æ ¼åŠ¨ç”»
                    if (price > oldPrice) {
                        priceElement.classList.add('price-up');
                        setTimeout(() => priceElement.classList.remove('price-up'), 500);
                    } else if (price < oldPrice) {
                        priceElement.classList.add('price-down');
                        setTimeout(() => priceElement.classList.remove('price-down'), 500);
                    }

                    priceElement.textContent = '$' + price.toLocaleString('en-US', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });

                    changeElement.textContent = (changePercent >= 0 ? '+' : '') + changePercent.toFixed(2) + '%';
                    changeElement.style.color = changePercent >= 0 ? '#00ff88' : '#ff4757';

                    updateElement.textContent = new Date().toLocaleTimeString();
                    sourceElement.textContent = 'æœ¬åœ°æ¨¡æ‹Ÿ';
                    frequencyElement.textContent = document.getElementById('updateFrequency').value + 's';

                    // è¶‹åŠ¿æŒ‡ç¤º
                    if (trend > 0.3) {
                        trendElement.textContent = 'ğŸ“ˆ ä¸Šæ¶¨';
                        trendElement.style.color = '#00ff88';
                    } else if (trend < -0.3) {
                        trendElement.textContent = 'ğŸ“‰ ä¸‹è·Œ';
                        trendElement.style.color = '#ff4757';
                    } else {
                        trendElement.textContent = 'â¡ï¸ æ¨ªç›˜';
                        trendElement.style.color = '#ffa502';
                    }
                }
            }

            // æ›´æ–°æ¨¡æ‹Ÿå™¨çŠ¶æ€
            function updateSimulatorStatus(status, text) {
                const indicator = document.getElementById('simulatorStatusIndicator');
                const statusText = document.getElementById('simulatorStatusText');
                const startTimeElement = document.getElementById('startTime');
                const lastUpdateElement = document.getElementById('lastUpdate');
                const currentModeElement = document.getElementById('currentMode');

                indicator.className = 'status-indicator ' + status;
                statusText.textContent = text;

                if (status === 'running') {
                    startTimeElement.textContent = new Date(startTime).toLocaleTimeString();
                    lastUpdateElement.textContent = new Date(lastUpdateTime).toLocaleTimeString();
                    currentModeElement.textContent = document.getElementById('simulationMode').value;
                }
            }

            // æ›´æ–°ç»Ÿè®¡æ•°æ®
            function updateStats() {
                document.getElementById('simulationCount').textContent = simulationCount;
                document.getElementById('dataUpdateCount').textContent = dataUpdateCount;

                const totalRequests = dataUpdateCount + errorCount;
                const successRate = totalRequests > 0 ? ((dataUpdateCount / totalRequests) * 100).toFixed(1) : '0.0';
                document.getElementById('successRate').textContent = successRate + '%';

                // æ›´æ–°æ€§èƒ½æŒ‡æ ‡
                document.getElementById('dataLatency').textContent = '< 10ms';
                document.getElementById('dataIntegrity').textContent = '100%';
                document.getElementById('volatility').textContent = document.getElementById('volatilityRange').value + '%';
                document.getElementById('cpuUsage').textContent = '< 1%';
                document.getElementById('memoryUsage').textContent = '< 1MB';
                document.getElementById('errorRate').textContent = errorCount > 0 ? ((errorCount / totalRequests) * 100).toFixed(1) + '%' : '0%';
            }

            // å¯åŠ¨è¿è¡Œæ—¶é—´è®¡æ•°å™¨
            function startUptimeCounter() {
                const startTime = Date.now();
                setInterval(() => {
                    const uptime = Math.floor((Date.now() - startTime) / 1000);
                    document.getElementById('uptime').textContent = uptime + 's';
                }, 1000);
            }

            // æ·»åŠ æ—¥å¿—
            function log(level, message) {
                const logContainer = document.getElementById('logContainer');
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry log-${level}`;
                logEntry.textContent = `[${timestamp}] ${message}`;

                logContainer.appendChild(logEntry);
                logContainer.scrollTop = logContainer.scrollHeight;

                // é™åˆ¶æ—¥å¿—æ¡æ•°
                while (logContainer.children.length > 100) {
                    logContainer.removeChild(logContainer.firstChild);
                }
            }

            // æ¸…ç©ºæ—¥å¿—
            function clearLog() {
                document.getElementById('logContainer').innerHTML = '';
                log('info', 'æ—¥å¿—å·²æ¸…ç©º');
            }

            // å¯¼å‡ºæ•°æ®
            function exportData() {
                const data = {
                    timestamp: new Date().toISOString(),
                    simulationCount: simulationCount,
                    dataUpdateCount: dataUpdateCount,
                    errorCount: errorCount,
                    currentPrices: currentPrices,
                    priceTrends: priceTrends,
                    config: {
                        updateFrequency: document.getElementById('updateFrequency').value,
                        volatilityRange: document.getElementById('volatilityRange').value,
                        simulationMode: document.getElementById('simulationMode').value,
                        dataQuality: document.getElementById('dataQuality').value
                    }
                };

                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `simulator_data_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                log('success', 'æ•°æ®å¯¼å‡ºæˆåŠŸ');
            }

            // é…ç½®å˜æ›´ç›‘å¬
            document.getElementById('updateFrequency').addEventListener('change', function () {
                if (simulatorRunning) {
                    log('info', 'æ›´æ–°é¢‘ç‡å·²æ›´æ”¹ï¼Œé‡å¯æ¨¡æ‹Ÿå™¨');
                    stopSimulator();
                    setTimeout(startSimulator, 100);
                }
            });

            document.getElementById('simulationMode').addEventListener('change', function () {
                log('info', 'æ¨¡æ‹Ÿæ¨¡å¼å·²æ›´æ”¹ä¸º: ' + this.value);
            });

            document.getElementById('volatilityRange').addEventListener('change', function () {
                log('info', 'æ³¢åŠ¨èŒƒå›´å·²æ›´æ”¹ä¸º: ' + this.value + '%');
            });

            // é¡µé¢å¸è½½æ—¶æ¸…ç†
            window.addEventListener('beforeunload', function () {
                if (simulatorRunning) {
                    stopSimulator();
                }
            });
        </script>
    </body>

</html>
