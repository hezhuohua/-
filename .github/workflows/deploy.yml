name: ğŸš€ è‡ªåŠ¨éƒ¨ç½²æ°¸ç»­åˆçº¦é¢„æµ‹ç³»ç»Ÿ

on:
  push:
    branches: [ master, main ]
  pull_request:
    branches: [ master, main ]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç 
      uses: actions/checkout@v4

    - name: ğŸ“¦ è®¾ç½®Node.jsç¯å¢ƒ
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'

    - name: ğŸ”§ å®‰è£…ä¾èµ–
      run: |
        npm install -g http-server
        npm install

    - name: ğŸ§ª è¿è¡Œæµ‹è¯•
      run: |
        echo "è¿è¡Œç³»ç»Ÿæµ‹è¯•..."
        # è¿™é‡Œå¯ä»¥æ·»åŠ è‡ªåŠ¨åŒ–æµ‹è¯•

    - name: ğŸ“‹ ç”Ÿæˆéƒ¨ç½²æŠ¥å‘Š
      run: |
        echo "=== éƒ¨ç½²æŠ¥å‘Š ===" > deploy-report.txt
        echo "éƒ¨ç½²æ—¶é—´: $(date)" >> deploy-report.txt
        echo "åˆ†æ”¯: ${{ github.ref }}" >> deploy-report.txt
        echo "æäº¤: ${{ github.sha }}" >> deploy-report.txt
        echo "ä½œè€…: ${{ github.actor }}" >> deploy-report.txt

    - name: ğŸš€ éƒ¨ç½²åˆ°GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      if: github.ref == 'refs/heads/master'
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: .
        publish_branch: gh-pages

    - name: ğŸ“§ å‘é€éƒ¨ç½²é€šçŸ¥
      if: always()
      run: |
        echo "éƒ¨ç½²çŠ¶æ€: ${{ job.status }}"
        echo "æŸ¥çœ‹éƒ¨ç½²ç»“æœ: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}"

    - name: ğŸ¯ éƒ¨ç½²å®Œæˆ
      if: success()
      run: |
        echo "âœ… éƒ¨ç½²æˆåŠŸå®Œæˆï¼"
        echo "ğŸŒ è®¿é—®åœ°å€: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}"
        echo "ğŸ“Š éƒ¨ç½²çŠ¶æ€: https://github.com/${{ github.repository }}/actions"
