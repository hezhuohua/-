<!DOCTYPE html>
<html lang="zh-CN">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ç®€å• Testnet æµ‹è¯•</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                background: #0a0a1a;
                color: #ffffff;
                padding: 20px;
            }

            .container {
                max-width: 800px;
                margin: 0 auto;
            }

            .test-section {
                background: #11112a;
                border: 1px solid #00f3ff;
                border-radius: 8px;
                padding: 20px;
                margin: 20px 0;
            }

            .btn {
                background: #11112a;
                border: 1px solid #00f3ff;
                color: #00f3ff;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                margin: 5px;
            }

            .btn:hover {
                background: #00f3ff;
                color: #0a0a1a;
            }

            .result {
                background: #0a0a1a;
                border: 1px solid #333;
                border-radius: 5px;
                padding: 15px;
                margin: 10px 0;
                white-space: pre-wrap;
                font-family: monospace;
            }

            .success {
                color: #28a745;
            }

            .error {
                color: #dc3545;
            }

            .info {
                color: #00f3ff;
            }
        </style>
    </head>

    <body>
        <div class="container">
            <h1>ğŸš€ Binance Testnet ç®€å•æµ‹è¯•</h1>

            <div class="test-section">
                <h2>1. æµ‹è¯•å…¬å¼€APIï¼ˆæ— éœ€è®¤è¯ï¼‰</h2>
                <button class="btn" onclick="testPublicApi()">æµ‹è¯•å…¬å¼€API</button>
                <div id="publicResult" class="result"></div>
            </div>

            <div class="test-section">
                <h2>2. æµ‹è¯•è´¦æˆ·APIï¼ˆéœ€è¦è®¤è¯ï¼‰</h2>
                <p>API Key: BZGVVshdX8o6JCwChl9Nl0DuXVDASJO5coMsWNbUSKWkQXet5tmAKe2uGN74era5</p>
                <button class="btn" onclick="testAccountApi()">æµ‹è¯•è´¦æˆ·API</button>
                <div id="accountResult" class="result"></div>
            </div>

            <div class="test-section">
                <h2>3. æµ‹è¯•ä¸‹å•API</h2>
                <button class="btn" onclick="testOrderApi()">æµ‹è¯•ä¸‹å•</button>
                <div id="orderResult" class="result"></div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>
        <script>
            const API_KEY = 'BZGVVshdX8o6JCwChl9Nl0DuXVDASJO5coMsWNbUSKWkQXet5tmAKe2uGN74era5';
            const API_SECRET = 'qRkCTvWI72lSFO6budBDv1fIyddb8Ag2UVlarqFuB8Qv7QRu0bB9LL29o8QFNlaD';
            const BASE_URL = 'https://testnet.binancefuture.com';

            function log(elementId, message, type = 'info') {
                const element = document.getElementById(elementId);
                const timestamp = new Date().toLocaleTimeString();
                element.innerHTML += `[${timestamp}] ${message}\n`;
                element.scrollTop = element.scrollHeight;
            }

            function generateSignature(queryString) {
                return CryptoJS.HmacSHA256(queryString, API_SECRET).toString();
            }

            async function testPublicApi() {
                log('publicResult', 'å¼€å§‹æµ‹è¯•å…¬å¼€API...', 'info');

                try {
                    // æµ‹è¯•è·å–æœåŠ¡å™¨æ—¶é—´
                    const response = await fetch(`${BASE_URL}/fapi/v1/time`);
                    const data = await response.json();

                    if (response.ok) {
                        log('publicResult', `âœ… æœåŠ¡å™¨æ—¶é—´: ${new Date(data.serverTime).toLocaleString()}`, 'success');
                    } else {
                        log('publicResult', `âŒ é”™è¯¯: ${JSON.stringify(data)}`, 'error');
                    }

                    // æµ‹è¯•è·å–äº¤æ˜“è§„åˆ™
                    const rulesResponse = await fetch(`${BASE_URL}/fapi/v1/exchangeInfo`);
                    const rulesData = await rulesResponse.json();

                    if (rulesResponse.ok) {
                        log('publicResult', `âœ… äº¤æ˜“è§„åˆ™è·å–æˆåŠŸï¼Œæ”¯æŒ ${rulesData.symbols.length} ä¸ªäº¤æ˜“å¯¹`, 'success');
                    } else {
                        log('publicResult', `âŒ äº¤æ˜“è§„åˆ™é”™è¯¯: ${JSON.stringify(rulesData)}`, 'error');
                    }

                } catch (error) {
                    log('publicResult', `âŒ ç½‘ç»œé”™è¯¯: ${error.message}`, 'error');
                }
            }

            async function testAccountApi() {
                log('accountResult', 'å¼€å§‹æµ‹è¯•è´¦æˆ·API...', 'info');

                try {
                    const timestamp = Date.now();
                    const queryString = `timestamp=${timestamp}`;
                    const signature = generateSignature(queryString);

                    const url = `${BASE_URL}/fapi/v2/account?${queryString}&signature=${signature}`;

                    log('accountResult', `è¯·æ±‚URL: ${url}`, 'info');

                    const response = await fetch(url, {
                        method: 'GET',
                        headers: {
                            'X-MBX-APIKEY': API_KEY
                        }
                    });

                    const data = await response.json();

                    if (response.ok) {
                        log('accountResult', `âœ… è´¦æˆ·ä¿¡æ¯è·å–æˆåŠŸ`, 'success');
                        log('accountResult', `æ€»ä½™é¢: ${data.totalWalletBalance} USDT`, 'success');
                        log('accountResult', `å¯ç”¨ä½™é¢: ${data.availableBalance} USDT`, 'success');
                        log('accountResult', `æœªå®ç°ç›ˆäº: ${data.totalUnrealizedProfit} USDT`, 'success');
                    } else {
                        log('accountResult', `âŒ é”™è¯¯ä»£ç : ${data.code}`, 'error');
                        log('accountResult', `âŒ é”™è¯¯ä¿¡æ¯: ${data.msg}`, 'error');

                        // æä¾›è§£å†³æ–¹æ¡ˆ
                        if (data.code === -2015) {
                            log('accountResult', 'ğŸ’¡ è§£å†³æ–¹æ¡ˆ: è¯·æ£€æŸ¥API Keyæƒé™ï¼Œç¡®ä¿æœ‰"åˆçº¦äº¤æ˜“"æƒé™', 'info');
                        }
                    }

                } catch (error) {
                    log('accountResult', `âŒ ç½‘ç»œé”™è¯¯: ${error.message}`, 'error');
                }
            }

            async function testOrderApi() {
                log('orderResult', 'å¼€å§‹æµ‹è¯•ä¸‹å•API...', 'info');

                try {
                    const symbol = 'BTCUSDT';
                    const side = 'BUY';
                    const type = 'MARKET';
                    const quantity = '0.001';
                    const timestamp = Date.now();

                    const queryString = `symbol=${symbol}&side=${side}&type=${type}&quantity=${quantity}&timestamp=${timestamp}`;
                    const signature = generateSignature(queryString);

                    const url = `${BASE_URL}/fapi/v1/order?${queryString}&signature=${signature}`;

                    log('orderResult', `ä¸‹å•å‚æ•°: ${symbol} ${side} ${quantity}`, 'info');

                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'X-MBX-APIKEY': API_KEY
                        }
                    });

                    const data = await response.json();

                    if (response.ok) {
                        log('orderResult', `âœ… ä¸‹å•æˆåŠŸï¼`, 'success');
                        log('orderResult', `è®¢å•ID: ${data.orderId}`, 'success');
                        log('orderResult', `çŠ¶æ€: ${data.status}`, 'success');
                        log('orderResult', `æˆäº¤ä»·æ ¼: ${data.avgPrice}`, 'success');
                        log('orderResult', `æˆäº¤æ•°é‡: ${data.executedQty}`, 'success');
                    } else {
                        log('orderResult', `âŒ ä¸‹å•å¤±è´¥`, 'error');
                        log('orderResult', `é”™è¯¯ä»£ç : ${data.code}`, 'error');
                        log('orderResult', `é”™è¯¯ä¿¡æ¯: ${data.msg}`, 'error');

                        if (data.code === -2015) {
                            log('orderResult', 'ğŸ’¡ è§£å†³æ–¹æ¡ˆ: è¯·æ£€æŸ¥API Keyæƒé™', 'info');
                        } else if (data.code === -2019) {
                            log('orderResult', 'ğŸ’¡ è§£å†³æ–¹æ¡ˆ: èµ„é‡‘ä¸è¶³ï¼Œè¯·æ£€æŸ¥è´¦æˆ·ä½™é¢', 'info');
                        }
                    }

                } catch (error) {
                    log('orderResult', `âŒ ç½‘ç»œé”™è¯¯: ${error.message}`, 'error');
                }
            }
        </script>
    </body>

</html>
