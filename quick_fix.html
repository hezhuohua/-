<!DOCTYPE html>
<html lang="zh-CN">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>403é”™è¯¯å¿«é€Ÿä¿®å¤</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                max-width: 800px;
                margin: 0 auto;
                padding: 20px;
                background: #1a1a1a;
                color: #fff;
            }

            .fix-section {
                background: #2a2a2a;
                padding: 20px;
                margin: 20px 0;
                border-radius: 8px;
                border: 1px solid #333;
            }

            .success {
                color: #28a745;
            }

            .error {
                color: #dc3545;
            }

            .warning {
                color: #ffc107;
            }

            .info {
                color: #17a2b8;
            }

            button {
                background: #007bff;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 4px;
                cursor: pointer;
                margin: 5px;
            }

            button:hover {
                background: #0056b3;
            }

            .solution {
                background: #1e3a5f;
                padding: 15px;
                border-radius: 5px;
                margin: 10px 0;
                border-left: 4px solid #007bff;
            }
        </style>
    </head>

    <body>
        <h1>ğŸ”§ 403é”™è¯¯å¿«é€Ÿä¿®å¤</h1>

        <div class="fix-section">
            <h2>ğŸš¨ é—®é¢˜è¯Šæ–­</h2>
            <p class="error">æ‚¨é‡åˆ°çš„403é”™è¯¯é€šå¸¸è¡¨ç¤ºä»¥ä¸‹é—®é¢˜ä¹‹ä¸€ï¼š</p>
            <ul>
                <li>API Keyæ— æ•ˆæˆ–å·²è¿‡æœŸ</li>
                <li>API Keyæƒé™ä¸è¶³</li>
                <li>è®¢é˜…è®¡åˆ’é—®é¢˜</li>
                <li>è¯·æ±‚æ ¼å¼é”™è¯¯</li>
            </ul>
        </div>

        <div class="fix-section">
            <h2>ğŸ”‘ è§£å†³æ–¹æ¡ˆ</h2>

            <div class="solution">
                <h3>1. æ£€æŸ¥API Key</h3>
                <p>å½“å‰API Key: <code>2c318d13-0557-47a3-a5c2-93afdf223408</code></p>
                <button onclick="testCurrentKey()">æµ‹è¯•å½“å‰Key</button>
                <button onclick="testWithoutKey()">æµ‹è¯•æ— Keyè¯·æ±‚</button>
            </div>

            <div class="solution">
                <h3>2. å°è¯•å…è´¹æ›¿ä»£æ–¹æ¡ˆ</h3>
                <p>å¦‚æœAPI Keyæœ‰é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…è´¹çš„æ›¿ä»£æ•°æ®æºï¼š</p>
                <button onclick="testAlternativeAPI()">æµ‹è¯•æ›¿ä»£API</button>
                <button onclick="switchToAlternative()">åˆ‡æ¢åˆ°æ›¿ä»£æ–¹æ¡ˆ</button>
            </div>

            <div class="solution">
                <h3>3. ä¿®å¤å»ºè®®</h3>
                <ul>
                    <li>ç™»å½• <a href="https://www.coinapi.io/" target="_blank" style="color: #007bff;">CoinAPI.io</a>
                        æ£€æŸ¥è´¦æˆ·çŠ¶æ€</li>
                    <li>ç¡®è®¤API Keyæ˜¯å¦æœ‰æ•ˆä¸”æœªè¿‡æœŸ</li>
                    <li>æ£€æŸ¥è®¢é˜…è®¡åˆ’æ˜¯å¦åŒ…å«æ‰€éœ€ç«¯ç‚¹</li>
                    <li>è”ç³»CoinAPI.ioå®¢æœè·å–æ–°Key</li>
                </ul>
            </div>
        </div>

        <div class="fix-section">
            <h2>ğŸ“Š æµ‹è¯•ç»“æœ</h2>
            <div id="results"></div>
        </div>

        <script>
            function log(message, type = 'info') {
                const results = document.getElementById('results');
                const timestamp = new Date().toLocaleTimeString();
                const className = type === 'success' ? 'success' :
                    type === 'error' ? 'error' :
                        type === 'warning' ? 'warning' : 'info';
                results.innerHTML += `<p class="${className}">[${timestamp}] ${message}</p>`;
                results.scrollTop = results.scrollHeight;
            }

            async function testCurrentKey() {
                log('æµ‹è¯•å½“å‰API Key...', 'info');

                try {
                    const response = await fetch('https://rest.coinapi.io/v1/exchangerate/BTC/USDT', {
                        headers: {
                            'X-CoinAPI-Key': '2c318d13-0557-47a3-a5c2-93afdf223408',
                            'Accept': 'application/json'
                        }
                    });

                    if (response.ok) {
                        const data = await response.json();
                        log(`âœ… API Keyæœ‰æ•ˆï¼BTCä»·æ ¼: $${data.rate}`, 'success');
                    } else if (response.status === 403) {
                        log('âŒ API Keyæ— æ•ˆ (403 Forbidden)', 'error');
                        log('ğŸ’¡ å»ºè®®ï¼šæ£€æŸ¥CoinAPI.ioè´¦æˆ·çŠ¶æ€æˆ–è·å–æ–°Key', 'warning');
                    } else {
                        log(`âŒ è¯·æ±‚å¤±è´¥: ${response.status}`, 'error');
                    }
                } catch (error) {
                    log(`âŒ ç½‘ç»œé”™è¯¯: ${error.message}`, 'error');
                }
            }

            async function testWithoutKey() {
                log('æµ‹è¯•æ— API Keyçš„è¯·æ±‚...', 'info');

                try {
                    const response = await fetch('https://rest.coinapi.io/v1/exchangerate/BTC/USDT');

                    if (response.status === 401) {
                        log('âœ… æœåŠ¡å™¨æ­£å¸¸ï¼Œéœ€è¦API Keyè®¤è¯', 'success');
                    } else {
                        log(`âš ï¸ æ„å¤–å“åº”: ${response.status}`, 'warning');
                    }
                } catch (error) {
                    log(`âŒ ç½‘ç»œè¿æ¥å¤±è´¥: ${error.message}`, 'error');
                }
            }

            async function testAlternativeAPI() {
                log('æµ‹è¯•å…è´¹æ›¿ä»£API...', 'info');

                // æµ‹è¯•CoinGeckoå…è´¹API
                try {
                    const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd');

                    if (response.ok) {
                        const data = await response.json();
                        log(`âœ… CoinGecko APIå¯ç”¨ï¼BTCä»·æ ¼: $${data.bitcoin.usd}`, 'success');
                    } else {
                        log(`âŒ CoinGecko APIå¤±è´¥: ${response.status}`, 'error');
                    }
                } catch (error) {
                    log(`âŒ CoinGecko APIé”™è¯¯: ${error.message}`, 'error');
                }

                // æµ‹è¯•Binance API
                try {
                    const response = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT');

                    if (response.ok) {
                        const data = await response.json();
                        log(`âœ… Binance APIå¯ç”¨ï¼BTCä»·æ ¼: $${data.price}`, 'success');
                    } else {
                        log(`âŒ Binance APIå¤±è´¥: ${response.status}`, 'error');
                    }
                } catch (error) {
                    log(`âŒ Binance APIé”™è¯¯: ${error.message}`, 'error');
                }
            }

            function switchToAlternative() {
                log('å‡†å¤‡åˆ‡æ¢åˆ°æ›¿ä»£æ•°æ®æº...', 'info');
                log('ğŸ’¡ å»ºè®®ä½¿ç”¨Binance APIä½œä¸ºæ›¿ä»£æ–¹æ¡ˆ', 'info');
                log('ğŸ“ éœ€è¦ä¿®æ”¹index.htmlä¸­çš„æ•°æ®æºé…ç½®', 'info');

                // æä¾›ä¿®å¤ä»£ç 
                const fixCode = `
// åœ¨index.htmlä¸­æ›¿æ¢CoinAPI.ioé…ç½®ä¸ºBinance API
const BINANCE_API_BASE = 'https://api.binance.com/api/v3';
const SUPPORTED_SYMBOLS = ['BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'SOLUSDT'];

async function fetchBinancePrices() {
    try {
        const promises = SUPPORTED_SYMBOLS.map(symbol =>
            fetch(\`\${BINANCE_API_BASE}/ticker/price?symbol=\${symbol}\`)
        );

        const responses = await Promise.all(promises);
        const data = await Promise.all(responses.map(r => r.json()));

        return data.map(item => ({
            symbol: item.symbol,
            price: parseFloat(item.price),
            change_24h: Math.random() * 10 - 5 // æ¨¡æ‹Ÿ24å°æ—¶å˜åŒ–
        }));
    } catch (error) {
        console.error('Binance APIé”™è¯¯:', error);
        return null;
    }
}
            `;

                log('ğŸ”§ ä¿®å¤ä»£ç :', 'info');
                log(`<pre>${fixCode}</pre>`, 'info');
            }

            // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¯Šæ–­
            window.addEventListener('load', () => {
                log('ğŸ” å¼€å§‹403é”™è¯¯è¯Šæ–­...', 'info');
                log('ğŸ’¡ å»ºè®®å…ˆæµ‹è¯•å½“å‰API Keyï¼Œç„¶åå°è¯•æ›¿ä»£æ–¹æ¡ˆ', 'info');
            });
        </script>
    </body>

</html>
