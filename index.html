<!DOCTYPE html>
<html lang="zh-CN">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>永续合约预测系统</title>

        <!-- CSS框架 -->
        <link href="https://cdn.jsdelivr.net/npm/element-plus@2.4.4/dist/index.css" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

        <!-- TradingView 轻量级图表库 -->
        <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>

        <!-- Font Awesome 图标 -->

        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                background: var(--bg-primary);
                color: var(--text-primary);
                transition: background-color 0.3s ease, color 0.3s ease;
            }

            /* 主题变量 */
            :root {
                /* 白天模式 */
                --bg-primary: #f5f7fa;
                --bg-secondary: #ffffff;
                --bg-tertiary: #f8f9fa;
                --text-primary: #333333;
                --text-secondary: #6c757d;
                --border-color: #e9ecef;
                --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                --panel-bg: #ffffff;
                --hover-bg: #f8f9fa;
            }

            /* 黑夜模式 */
            [data-theme="dark"] {
                --bg-primary: #1a1a1a;
                --bg-secondary: #2d2d2d;
                --bg-tertiary: #3a3a3a;
                --text-primary: #ffffff;
                --text-secondary: #b0b0b0;
                --border-color: #404040;
                --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
                --gradient-primary: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
                --panel-bg: #2d2d2d;
                --hover-bg: #3a3a3a;
            }

            .app-container {
                min-height: 100vh;
                display: flex;
                flex-direction: column;
            }

            /* 顶部导航 */
            .navbar {
                background: var(--gradient-primary);
                color: white;
                padding: 1rem 2rem;
                display: flex;
                justify-content: space-between;
                align-items: center;
                box-shadow: var(--shadow);
            }

            .logo {
                font-size: 1.5rem;
                font-weight: bold;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .nav-menu {
                display: flex;
                gap: 2rem;
                align-items: center;
                flex-wrap: wrap;
                justify-content: flex-end;
            }

            .nav-item {
                cursor: pointer;
                padding: 0.5rem 1rem;
                border-radius: 5px;
                transition: background 0.3s;
                min-height: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
                user-select: none;
                -webkit-tap-highlight-color: transparent;
            }

            .nav-item:hover {
                background: rgba(255, 255, 255, 0.1);
            }

            .nav-item.active {
                background: rgba(255, 255, 255, 0.2);
            }

            /* 主题切换按钮 */
            .theme-toggle {
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
                color: white;
                padding: 0.5rem;
                border-radius: 50%;
                cursor: pointer;
                transition: all 0.3s ease;
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .theme-toggle:hover {
                background: rgba(255, 255, 255, 0.2);
                transform: scale(1.1);
            }

            /* 数据源状态指示器 */
            .data-source-indicator {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.5rem 1rem;
                border-radius: 20px;
                font-size: 0.85rem;
                font-weight: 600;
                transition: all 0.3s ease;
                cursor: pointer;
                white-space: nowrap;
                min-width: fit-content;
            }

            .data-source-indicator.loading {
                background: rgba(255, 193, 7, 0.2);
                color: #ffc107;
                border: 1px solid rgba(255, 193, 7, 0.3);
            }

            .data-source-indicator.real {
                background: rgba(40, 167, 69, 0.2);
                color: #28a745;
                border: 1px solid rgba(40, 167, 69, 0.3);
                animation: realDataPulse 2s infinite;
            }

            .data-source-indicator.mock {
                background: rgba(220, 53, 69, 0.2);
                color: #dc3545;
                border: 1px solid rgba(220, 53, 69, 0.3);
                position: relative;
                overflow: hidden;
            }

            .data-source-indicator.mock::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
                animation: shimmer 2s infinite;
            }

            @keyframes shimmer {
                0% {
                    left: -100%;
                }

                100% {
                    left: 100%;
                }
            }

            .data-source-text {
                font-size: 0.8rem;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            @keyframes realDataPulse {

                0%,
                100% {
                    box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.4);
                }

                50% {
                    box-shadow: 0 0 0 8px rgba(40, 167, 69, 0);
                }
            }

            /* 主要内容区域 */
            .main-content {
                flex: 1;
                padding: 2rem;
                max-width: 1400px;
                margin: 0 auto;
                width: 100%;
            }

            /* 交易仪表盘 */
            .trading-dashboard {
                display: grid;
                grid-template-columns: 300px 1fr 300px;
                gap: 1.5rem;
                height: calc(100vh - 200px);
            }

            .panel {
                background: var(--panel-bg);
                border-radius: 12px;
                box-shadow: var(--shadow);
                overflow: hidden;
                border: 1px solid var(--border-color);
            }

            .panel-header {
                background: var(--bg-tertiary);
                padding: 1rem 1.5rem;
                border-bottom: 1px solid var(--border-color);
                font-weight: 600;
                display: flex;
                justify-content: space-between;
                align-items: center;
                color: var(--text-primary);
            }

            .panel-content {
                padding: 1rem;
                height: calc(100% - 60px);
                overflow-y: auto;
            }

            /* 价格列表 */
            .price-list {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }

            .price-item {
                display: flex;
                align-items: center;
                padding: 1rem;
                border: 1px solid var(--border-color);
                border-radius: 8px;
                transition: all 0.3s;
                cursor: pointer;
                background: var(--bg-secondary);
            }

            .price-item:hover {
                border-color: #667eea;
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
                background: var(--hover-bg);
            }

            .price-item.best-price {
                border-color: #28a745;
                background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            }

            .exchange-info {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                min-width: 80px;
            }

            .exchange-icon {
                width: 24px;
                height: 24px;
                border-radius: 50%;
                background: #667eea;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-size: 12px;
                font-weight: bold;
            }

            .price-info {
                flex: 1;
                margin-left: 1rem;
            }

            .current-price {
                font-size: 1.1rem;
                font-weight: bold;
                margin-bottom: 0.25rem;
            }

            .price-change {
                font-size: 0.9rem;
                margin-left: 0.5rem;
            }

            .positive {
                color: #28a745;
            }

            .negative {
                color: #dc3545;
            }

            .additional-info {
                font-size: 0.8rem;
                color: var(--text-secondary);
                display: flex;
                gap: 1rem;
                flex-wrap: wrap;
            }

            /* 交易所选择器样式 */
            .exchange-selector {
                margin-bottom: 1.5rem;
            }

            .exchange-selector h4 {
                margin-bottom: 1rem;
                color: var(--text-primary);
                font-size: 1rem;
            }

            .exchange-grid {
                display: grid;
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .exchange-option {
                display: flex;
                align-items: center;
                padding: 0.75rem;
                border: 2px solid var(--border-color);
                border-radius: 8px;
                cursor: pointer;
                transition: all 0.3s ease;
                background: var(--bg-secondary);
                position: relative;
            }

            .exchange-option:hover {
                border-color: #667eea;
                transform: translateY(-1px);
                box-shadow: 0 2px 8px rgba(102, 126, 234, 0.15);
            }

            .exchange-option.active {
                border-color: #667eea;
                background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            }

            .exchange-option .exchange-icon {
                width: 32px;
                height: 32px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-weight: bold;
                font-size: 0.9rem;
                margin-right: 0.75rem;
            }

            .exchange-details {
                flex: 1;
            }

            .exchange-details .exchange-name {
                font-weight: 600;
                color: var(--text-primary);
                margin-bottom: 0.25rem;
            }

            .exchange-details .exchange-price {
                font-size: 0.9rem;
                color: var(--text-secondary);
            }

            .selection-indicator {
                color: #28a745;
                font-size: 1.2rem;
            }

            .divider {
                height: 1px;
                background: var(--border-color);
                margin: 1.5rem 0;
            }

            .price-comparison h4 {
                margin-bottom: 1rem;
                color: var(--text-primary);
                font-size: 1rem;
            }

            .reference-badge {
                background: #667eea;
                color: white;
                padding: 0.2rem 0.5rem;
                border-radius: 12px;
                font-size: 0.7rem;
                margin-left: 0.5rem;
            }

            .price-item.reference-exchange {
                border-left: 4px solid #667eea;
                background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            }

            .price-item.price-higher {
                border-left: 4px solid #28a745;
            }

            .price-item.price-lower {
                border-left: 4px solid #dc3545;
            }

            .price-diff {
                font-weight: 600;
            }

            .price-diff.positive {
                color: #28a745;
            }

            .price-diff.negative {
                color: #dc3545;
            }

            .header-controls {
                display: flex;
                gap: 0.5rem;
                align-items: center;
            }

            .symbol-select {
                padding: 0.5rem;
                border: 1px solid var(--border-color);
                border-radius: 4px;
                background: var(--bg-secondary);
                color: var(--text-primary);
            }

            .reference-exchange {
                font-size: 0.8rem;
                color: var(--text-secondary);
                margin-top: 0.25rem;
            }

            /* 图表容器样式 */
            .chart-container {
                width: 100%;
                height: 400px;
                background: var(--bg-secondary);
                border-radius: 8px;
                overflow: hidden;
                position: relative;
            }

            .tradingview-chart {
                width: 100%;
                height: 100%;
                background: var(--bg-secondary);
            }

            /* 图表占位符样式（保留作为备用） */
            .chart-placeholder {
                display: none;
                text-align: center;
                padding: 2rem;
                color: var(--text-secondary);
            }

            .chart-placeholder i {
                margin-bottom: 1rem;
                opacity: 0.5;
            }

            .chart-placeholder p {
                margin: 0.5rem 0;
            }

            /* 预测面板 */
            .prediction-panel {
                background: var(--gradient-primary);
                color: white;
                padding: 1.5rem;
                border-radius: 12px;
                margin-bottom: 1rem;
            }

            .prediction-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 1rem;
                margin-top: 1rem;
            }

            .prediction-item {
                text-align: center;
                padding: 1rem;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 8px;
                backdrop-filter: blur(10px);
            }

            .timeframe {
                font-size: 0.9rem;
                opacity: 0.8;
                margin-bottom: 0.5rem;
            }

            .direction {
                font-size: 2rem;
                margin: 0.5rem 0;
            }

            .direction.up {
                color: #28a745;
            }

            .direction.down {
                color: #dc3545;
            }

            .probability {
                font-size: 1.1rem;
                font-weight: bold;
            }

            /* 深度图 */
            .depth-chart {
                height: 200px;
                background: var(--bg-tertiary);
                border-radius: 8px;
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                justify-content: center;
                border: 1px solid var(--border-color);
            }

            /* 订单簿 */
            .orderbook {
                font-family: 'Courier New', monospace;
                font-size: 0.85rem;
            }

            .orderbook-header {
                display: grid;
                grid-template-columns: 1fr 1fr 1fr;
                gap: 0.5rem;
                padding: 0.5rem;
                background: var(--bg-tertiary);
                font-weight: bold;
                text-align: center;
                color: var(--text-primary);
            }

            .order-row {
                display: grid;
                grid-template-columns: 1fr 1fr 1fr;
                gap: 0.5rem;
                padding: 0.25rem 0.5rem;
                text-align: right;
            }

            .ask-row {
                color: #dc3545;
            }

            .bid-row {
                color: #28a745;
            }

            .current-price-row {
                text-align: center;
                padding: 0.5rem;
                background: var(--border-color);
                font-weight: bold;
                margin: 0.5rem 0;
                color: var(--text-primary);
            }

            /* 会员中心 */
            .membership-center {
                max-width: 800px;
                margin: 0 auto;
            }

            .user-status-card {
                background: var(--gradient-primary);
                color: white;
                padding: 2rem;
                border-radius: 12px;
                margin-bottom: 2rem;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .membership-info h3 {
                font-size: 1.5rem;
                margin-bottom: 1rem;
            }

            .quota-info {
                display: flex;
                align-items: center;
                gap: 1rem;
            }

            .quota-circle {
                width: 80px;
                height: 80px;
                border: 3px solid rgba(255, 255, 255, 0.3);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                position: relative;
            }

            .quota-text {
                text-align: center;
                font-weight: bold;
            }

            .plans-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 1.5rem;
                margin-top: 1rem;
            }

            .plan-card {
                border: 2px solid var(--border-color);
                border-radius: 12px;
                padding: 1.5rem;
                text-align: center;
                transition: all 0.3s;
                cursor: pointer;
                background: var(--bg-secondary);
                color: var(--text-primary);
                box-shadow: var(--shadow);
            }

            .plan-card:hover {
                border-color: #667eea;
                transform: translateY(-5px);
                box-shadow: 0 15px 35px rgba(102, 126, 234, 0.15);
            }

            .plan-card.recommended {
                border-color: #667eea;
                background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
                position: relative;
                box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
            }

            .plan-card.recommended::before {
                content: "推荐";
                position: absolute;
                top: -10px;
                right: 20px;
                background: var(--gradient-primary);
                color: white;
                padding: 0.25rem 0.75rem;
                border-radius: 15px;
                font-size: 0.8rem;
                font-weight: 600;
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            }

            .plan-header h4 {
                font-size: 1.4rem;
                margin-bottom: 0.8rem;
                color: var(--text-primary);
                font-weight: 700;
            }

            .price {
                margin-bottom: 1rem;
            }

            .amount {
                font-size: 2rem;
                font-weight: bold;
                background: var(--gradient-primary);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }

            .period {
                color: var(--text-secondary);
                font-weight: 500;
            }

            .features {
                list-style: none;
                margin: 1rem 0;
            }

            .features li {
                padding: 0.6rem 0;
                border-bottom: 1px solid var(--border-color);
                color: var(--text-primary);
                font-weight: 500;
            }

            .features li:last-child {
                border-bottom: none;
            }

            .features li::before {
                content: "✓";
                background: var(--gradient-primary);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                font-weight: bold;
                margin-right: 0.5rem;
                font-size: 1.1rem;
            }

            /* 按钮样式 */
            .btn {
                padding: 0.75rem 1.5rem;
                border: none;
                border-radius: 8px;
                font-size: 1rem;
                cursor: pointer;
                transition: all 0.3s;
                text-decoration: none;
                display: inline-block;
                text-align: center;
            }

            .btn-primary {
                background: var(--gradient-primary);
                color: white;
                font-weight: 600;
                border: none;
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            }

            .btn-primary:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            }

            .btn-outline {
                background: transparent;
                border: 2px solid #667eea;
                color: #667eea;
            }

            .btn-outline:hover {
                background: #667eea;
                color: white;
            }

            /* 响应式设计 */
            @media (max-width: 768px) {
                .trading-dashboard {
                    grid-template-columns: 1fr;
                    height: auto;
                }

                .navbar {
                    padding: 0.5rem;
                    flex-direction: column;
                    gap: 1rem;
                }

                .logo {
                    font-size: 1.2rem;
                    justify-content: center;
                }

                .nav-menu {
                    gap: 0.5rem;
                    flex-wrap: wrap;
                    justify-content: center;
                    width: 100%;
                }

                .nav-item {
                    padding: 0.4rem 0.8rem;
                    font-size: 0.9rem;
                    min-width: auto;
                    text-align: center;
                }

                .data-source-indicator {
                    padding: 0.4rem 0.8rem;
                    font-size: 0.8rem;
                    min-width: auto;
                    justify-content: center;
                }

                .data-source-text {
                    font-size: 0.75rem;
                }

                .theme-toggle {
                    width: 36px;
                    height: 36px;
                }

                .main-content {
                    padding: 1rem;
                }

                .plans-grid {
                    grid-template-columns: 1fr;
                }

                /* 搜索框移动端适配 */
                .ticker-controls {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 0.5rem;
                }

                .search-input {
                    width: 100%;
                }

                .search-input:focus {
                    width: 100%;
                }
            }

            /* 超小屏幕优化 */
            @media (max-width: 480px) {
                .navbar {
                    padding: 0.3rem;
                }

                .logo {
                    font-size: 1.1rem;
                }

                .nav-menu {
                    gap: 0.3rem;
                }

                .nav-item {
                    padding: 0.3rem 0.6rem;
                    font-size: 0.8rem;
                }

                .data-source-indicator {
                    padding: 0.3rem 0.6rem;
                    font-size: 0.75rem;
                }

                .data-source-text {
                    font-size: 0.7rem;
                }

                .theme-toggle {
                    width: 32px;
                    height: 32px;
                }
            }

            /* 横屏模式优化 */
            @media (max-width: 768px) and (orientation: landscape) {
                .navbar {
                    flex-direction: row;
                    padding: 0.5rem 1rem;
                }

                .nav-menu {
                    flex-wrap: nowrap;
                    gap: 0.8rem;
                }
            }

            /* 加载动画 */
            .loading {
                display: inline-block;
                width: 20px;
                height: 20px;
                border: 3px solid #f3f3f3;
                border-top: 3px solid #667eea;
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }

                100% {
                    transform: rotate(360deg);
                }
            }

            /* 隐藏类 */
            .hidden {
                display: none !important;
            }

            /* 连接状态指示器 */
            .connection-status {
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 0.5rem 1rem;
                border-radius: 20px;
                font-size: 0.9rem;
                z-index: 999;
                pointer-events: none;
                /* 不阻塞用户操作 */
                transition: all 0.3s ease;
                opacity: 0.9;
            }

            .connection-status.connected {
                background: #d4edda;
                color: #155724;
                border: 1px solid #c3e6cb;
            }

            .connection-status.disconnected {
                background: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
                animation: pulse 2s infinite;
            }

            @keyframes pulse {
                0% {
                    opacity: 0.9;
                }

                50% {
                    opacity: 0.6;
                }

                100% {
                    opacity: 0.9;
                }
            }

            /* 行情表样式 */
            .market-ticker-panel {
                height: 100%;
            }

            .ticker-controls {
                display: flex;
                align-items: center;
                gap: 0.75rem;
                flex-wrap: wrap;
            }

            /* 搜索容器样式 */
            .search-container {
                position: relative;
            }

            .search-input-wrapper {
                position: relative;
                display: flex;
                align-items: center;
            }

            .search-input {
                padding: 0.4rem 0.75rem 0.4rem 2rem;
                border: 1px solid var(--border-color);
                border-radius: 20px;
                background: var(--bg-secondary);
                color: var(--text-primary);
                font-size: 0.85rem;
                width: 200px;
                transition: all 0.3s ease;
            }

            .search-input:focus {
                outline: none;
                border-color: var(--primary-color);
                box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
                width: 250px;
            }

            .search-input::placeholder {
                color: var(--text-secondary);
            }

            .search-icon {
                position: absolute;
                left: 0.75rem;
                color: var(--text-secondary);
                font-size: 0.85rem;
                z-index: 1;
            }

            .clear-search-btn {
                position: absolute;
                right: 0.5rem;
                background: none;
                border: none;
                color: var(--text-secondary);
                cursor: pointer;
                padding: 0.25rem;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                width: 20px;
                height: 20px;
                transition: all 0.2s ease;
            }

            .clear-search-btn:hover {
                background: var(--border-color);
                color: var(--text-primary);
            }

            .ticker-controls select {
                padding: 0.25rem 0.5rem;
                border: 1px solid var(--border-color);
                border-radius: 4px;
                background: var(--bg-secondary);
                color: var(--text-primary);
                font-size: 0.9rem;
            }

            .refresh-btn {
                background: none;
                border: 1px solid var(--border-color);
                color: var(--text-secondary);
                padding: 0.25rem 0.5rem;
                border-radius: 4px;
                cursor: pointer;
                transition: all 0.2s ease;
            }

            .refresh-btn:hover:not(:disabled) {
                background: var(--bg-secondary);
                color: var(--text-primary);
            }

            .refresh-btn:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }

            .ticker-table-container {
                position: relative;
                height: calc(100% - 60px);
                overflow-y: auto;
            }

            .ticker-table {
                width: 100%;
                border-collapse: collapse;
                font-size: 0.9rem;
            }

            .ticker-table th {
                background: var(--bg-tertiary);
                padding: 0.75rem 0.5rem;
                text-align: left;
                font-weight: 600;
                color: var(--text-secondary);
                border-bottom: 1px solid var(--border-color);
                position: sticky;
                top: 0;
                z-index: 10;
            }

            .ticker-table th.sortable {
                cursor: pointer;
                user-select: none;
                transition: background-color 0.2s ease;
            }

            .ticker-table th.sortable:hover {
                background: var(--bg-secondary);
            }

            .ticker-table th.text-right {
                text-align: right;
            }

            .ticker-table th.text-center {
                text-align: center;
            }

            .ticker-table td {
                padding: 0.75rem 0.5rem;
                border-bottom: 1px solid var(--border-color);
                vertical-align: middle;
            }

            .ticker-table td.text-right {
                text-align: right;
            }

            .ticker-table td.text-center {
                text-align: center;
            }

            .ticker-row {
                cursor: pointer;
                transition: all 0.2s ease;
            }

            .ticker-row:hover {
                background: var(--bg-secondary);
            }

            .ticker-row.selected {
                background: rgba(var(--primary-rgb), 0.1);
                border-left: 3px solid var(--primary-color);
            }

            .ticker-row.price-up {
                animation: priceFlashUp 0.5s ease;
            }

            .ticker-row.price-down {
                animation: priceFlashDown 0.5s ease;
            }

            @keyframes priceFlashUp {
                0% {
                    background: rgba(34, 197, 94, 0.2);
                }

                100% {
                    background: transparent;
                }
            }

            @keyframes priceFlashDown {
                0% {
                    background: rgba(239, 68, 68, 0.2);
                }

                100% {
                    background: transparent;
                }
            }

            .symbol-cell {
                position: relative;
            }

            .symbol-info {
                display: flex;
                flex-direction: column;
                gap: 0.25rem;
            }

            .symbol-name {
                font-weight: 600;
                color: var(--text-primary);
            }

            .symbol-desc {
                font-size: 0.8rem;
                color: var(--text-secondary);
            }

            .favorite-icon {
                position: absolute;
                top: 50%;
                right: 0.5rem;
                transform: translateY(-50%);
                color: var(--text-secondary);
                cursor: pointer;
                transition: color 0.2s ease;
            }

            .favorite-icon:hover {
                color: #fbbf24;
            }

            .favorite-icon.active {
                color: #f59e0b;
            }

            .price-info {
                display: flex;
                align-items: center;
                justify-content: flex-end;
                gap: 0.25rem;
            }

            .price {
                font-weight: 600;
                font-family: 'Courier New', monospace;
            }

            .price-change-indicator {
                font-size: 0.8rem;
            }

            .price-change-indicator.up {
                color: #22c55e;
            }

            .price-change-indicator.down {
                color: #ef4444;
            }

            .change-info {
                display: flex;
                flex-direction: column;
                align-items: flex-end;
                gap: 0.25rem;
            }

            .change-percent {
                font-weight: 600;
                padding: 0.25rem 0.5rem;
                border-radius: 4px;
                font-size: 0.85rem;
            }

            .change-percent.positive {
                background: rgba(34, 197, 94, 0.1);
                color: #22c55e;
            }

            .change-percent.negative {
                background: rgba(239, 68, 68, 0.1);
                color: #ef4444;
            }

            .change-amount {
                font-size: 0.8rem;
                font-family: 'Courier New', monospace;
            }

            .change-amount.positive {
                color: #22c55e;
            }

            .change-amount.negative {
                color: #ef4444;
            }

            .volume-info {
                display: flex;
                flex-direction: column;
                align-items: flex-end;
                gap: 0.25rem;
            }

            .volume {
                font-weight: 500;
                font-family: 'Courier New', monospace;
            }

            .volume-usd {
                font-size: 0.8rem;
                color: var(--text-secondary);
                font-family: 'Courier New', monospace;
            }

            .loading-overlay {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(var(--bg-primary-rgb), 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 100;
            }

            .loading-spinner {
                text-align: center;
                color: var(--text-secondary);
            }

            .loading-spinner p {
                margin-top: 1rem;
                font-size: 0.9rem;
            }

            .empty-state {
                text-align: center;
                padding: 3rem 1rem;
                color: var(--text-secondary);
            }

            .empty-state i {
                margin-bottom: 1rem;
                opacity: 0.5;
            }

            .empty-state p {
                margin-bottom: 1.5rem;
                font-size: 1.1rem;
            }

            /* 交易详情页样式 */
            .trading-detail {
                height: 100vh;
                background: var(--bg-primary);
                display: flex;
                flex-direction: column;
            }

            .trading-header {
                background: var(--bg-secondary);
                padding: 1rem;
                border-bottom: 1px solid var(--border-color);
                display: flex;
                align-items: center;
                justify-content: space-between;
            }

            .trading-header-left {
                display: flex;
                align-items: center;
                gap: 1rem;
            }

            .back-btn {
                background: none;
                border: none;
                color: var(--text-primary);
                font-size: 1.2rem;
                cursor: pointer;
                padding: 0.5rem;
                border-radius: 4px;
                transition: background-color 0.2s ease;
            }

            .back-btn:hover {
                background: var(--bg-tertiary);
            }

            .trading-symbol {
                font-size: 1.2rem;
                font-weight: 600;
                color: var(--text-primary);
            }

            .trading-favorite {
                background: none;
                border: none;
                color: var(--text-secondary);
                font-size: 1.2rem;
                cursor: pointer;
                padding: 0.5rem;
                border-radius: 4px;
                transition: all 0.2s ease;
            }

            .trading-favorite:hover {
                background: var(--bg-tertiary);
                color: #fbbf24;
            }

            .trading-favorite.active {
                color: #f59e0b;
            }

            .trading-price-section {
                padding: 1.5rem;
                background: var(--bg-secondary);
                border-bottom: 1px solid var(--border-color);
            }

            .trading-main-price {
                font-size: 2.5rem;
                font-weight: 700;
                color: var(--text-primary);
                font-family: 'Courier New', monospace;
                margin-bottom: 0.5rem;
            }

            .trading-price-info {
                display: flex;
                align-items: center;
                gap: 1rem;
                margin-bottom: 1rem;
            }

            .trading-usd-price {
                font-size: 1rem;
                color: var(--text-secondary);
                font-family: 'Courier New', monospace;
            }

            .trading-change {
                font-weight: 600;
                font-size: 1rem;
            }

            .trading-change.positive {
                color: #22c55e;
            }

            .trading-change.negative {
                color: #ef4444;
            }

            .trading-stats {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
            }

            .trading-stat-group {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }

            .trading-stat-item {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .trading-stat-label {
                font-size: 0.9rem;
                color: var(--text-secondary);
            }

            .trading-stat-value {
                font-size: 0.9rem;
                color: var(--text-primary);
                font-family: 'Courier New', monospace;
                font-weight: 500;
            }

            .trading-timeframes {
                padding: 1rem;
                background: var(--bg-secondary);
                border-bottom: 1px solid var(--border-color);
                display: flex;
                gap: 0.5rem;
                overflow-x: auto;
            }

            .timeframe-btn {
                background: none;
                border: 1px solid var(--border-color);
                color: var(--text-secondary);
                padding: 0.5rem 1rem;
                border-radius: 4px;
                cursor: pointer;
                transition: all 0.2s ease;
                white-space: nowrap;
                font-size: 0.9rem;
            }

            .timeframe-btn:hover {
                background: var(--bg-tertiary);
                color: var(--text-primary);
            }

            .timeframe-btn.active {
                background: var(--primary-color);
                color: white;
                border-color: var(--primary-color);
            }

            /* 移除重复定义，使用下面的移动端优化版本 */

            .trading-chart {
                width: 100%;
                height: 100%;
                min-height: 400px;
            }

            .trading-chart-placeholder {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                height: 100%;
                color: var(--text-secondary);
                text-align: center;
                padding: 2rem;
            }

            .trading-chart-placeholder i {
                margin-bottom: 1rem;
                opacity: 0.5;
            }

            .trading-chart-placeholder p {
                margin-bottom: 0.5rem;
                font-size: 1.1rem;
            }

            .trading-chart-placeholder .subtitle {
                font-size: 0.9rem;
                opacity: 0.7;
            }

            /* 移动端适配 */
            @media (max-width: 768px) {
                .trading-detail {
                    height: 100vh;
                }

                .trading-header {
                    padding: 0.75rem;
                }

                .trading-price-section {
                    padding: 1rem;
                }

                .trading-main-price {
                    font-size: 2rem;
                }

                .trading-stats {
                    grid-template-columns: 1fr;
                    gap: 0.75rem;
                }

                .trading-stat-group {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 0.5rem;
                }

                .timeframe-btn {
                    padding: 0.4rem 0.8rem;
                    font-size: 0.85rem;
                }

                /* 价格显示移动端适配 */
                .timer-info {
                    grid-template-columns: 1fr;
                    gap: 1.5rem;
                }

                .timer-info-item {
                    width: 100%;
                    max-width: 100%;
                    overflow: hidden;
                }

                .price-display {
                    width: 100%;
                    max-width: 100%;
                    margin: 0.5rem 0;
                    padding: 0.75rem;
                    box-sizing: border-box;
                    overflow: hidden;
                }

                .price-value {
                    font-size: 1.4rem;
                    word-break: break-all;
                    overflow-wrap: break-word;
                }

                .price-label {
                    font-size: 0.8rem;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }
            }

            /* 小屏幕移动端进一步优化 */
            @media (max-width: 480px) {
                .timer-info {
                    gap: 1rem;
                }

                .price-display {
                    padding: 0.5rem;
                    margin: 0.25rem 0;
                }

                .price-value {
                    font-size: 1.2rem;
                }

                .price-label {
                    font-size: 0.75rem;
                    margin-bottom: 0.25rem;
                }

                .timer-info-item {
                    padding: 0.5rem;
                }
            }

            /* 预测倒计时样式 */
            .prediction-timer {
                background: var(--bg-secondary);
                border: 1px solid var(--border-color);
                border-radius: 8px;
                padding: 1rem;
                margin-top: 1rem;
                text-align: center;
            }

            .prediction-timer.expired {
                background: rgba(239, 68, 68, 0.1);
                border-color: #ef4444;
                animation: alertPulse 1s infinite;
            }

            @keyframes alertPulse {

                0%,
                100% {
                    background: rgba(239, 68, 68, 0.1);
                    border-color: #ef4444;
                }

                50% {
                    background: rgba(239, 68, 68, 0.2);
                    border-color: #dc2626;
                }
            }

            .timer-header {
                font-size: 0.9rem;
                color: var(--text-secondary);
                margin-bottom: 0.5rem;
            }

            .timer-display {
                font-size: 1.5rem;
                font-weight: 700;
                font-family: 'Courier New', monospace;
                margin: 0.5rem 0;
            }

            .timer-display.active {
                color: var(--primary-color);
            }

            .timer-display.warning {
                color: #f59e0b;
            }

            .timer-display.expired {
                color: #ef4444;
            }

            .timer-info {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
                margin-top: 1rem;
                font-size: 0.85rem;
            }

            .timer-info-item {
                text-align: center;
            }

            .timer-info-label {
                color: var(--text-secondary);
                margin-bottom: 0.25rem;
            }

            .timer-info-value {
                color: var(--text-primary);
                font-weight: 600;
                font-family: 'Courier New', monospace;
                font-size: 1.1rem;
            }

            /* 价格显示样式 */
            .price-display {
                margin-top: 1rem;
                padding: 1rem;
                border-radius: 12px;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                transition: all 0.3s ease;
                width: 100%;
                box-sizing: border-box;
                overflow: hidden;
            }

            .price-display:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            }

            .start-price {
                border-left: 4px solid #4A90E2;
                background: linear-gradient(135deg, rgba(74, 144, 226, 0.1), rgba(74, 144, 226, 0.05));
            }

            .end-price {
                border-left: 4px solid #00D4AA;
                background: linear-gradient(135deg, rgba(0, 212, 170, 0.1), rgba(0, 212, 170, 0.05));
            }

            .price-label {
                font-size: 0.9rem;
                color: var(--text-secondary);
                margin-bottom: 0.5rem;
                text-transform: uppercase;
                letter-spacing: 1px;
                font-weight: 600;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .price-value {
                font-size: 1.8rem;
                font-weight: 900;
                font-family: 'Courier New', monospace;
                text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
                animation: priceGlow 2s infinite;
                word-break: break-all;
                overflow-wrap: break-word;
                line-height: 1.2;
            }

            .price-value.price-up {
                color: #00F5D4;
                text-shadow: 0 0 20px rgba(0, 245, 212, 0.5);
            }

            .price-value.price-down {
                color: #FF8A8A;
                text-shadow: 0 0 20px rgba(255, 138, 138, 0.5);
            }

            .price-value.price-neutral {
                color: #4A90E2;
                text-shadow: 0 0 20px rgba(74, 144, 226, 0.5);
            }

            @keyframes priceGlow {

                0%,
                100% {
                    transform: scale(1);
                    opacity: 1;
                }

                50% {
                    transform: scale(1.02);
                    opacity: 0.9;
                }
            }

            /* 价格变化动画 */
            .price-value.price-changed {
                animation: priceChange 0.6s ease-out;
            }

            @keyframes priceChange {
                0% {
                    transform: scale(1);
                    background: rgba(255, 255, 255, 0.1);
                }

                50% {
                    transform: scale(1.1);
                    background: rgba(255, 255, 255, 0.3);
                }

                100% {
                    transform: scale(1);
                    background: rgba(255, 255, 255, 0.1);
                }
            }

            .alert-icon {
                font-size: 1.2rem;
                color: #ef4444;
                margin-right: 0.5rem;
                animation: shake 0.5s infinite;
            }

            @keyframes shake {

                0%,
                100% {
                    transform: translateX(0);
                }

                25% {
                    transform: translateX(-2px);
                }

                75% {
                    transform: translateX(2px);
                }
            }

            .prediction-status {
                display: inline-flex;
                align-items: center;
                padding: 0.25rem 0.75rem;
                border-radius: 20px;
                font-size: 0.8rem;
                font-weight: 600;
                margin-top: 0.5rem;
            }

            .prediction-status.active {
                background: rgba(34, 197, 94, 0.1);
                color: #22c55e;
            }

            .prediction-status.warning {
                background: rgba(245, 158, 11, 0.1);
                color: #f59e0b;
            }

            .prediction-status.expired {
                background: rgba(239, 68, 68, 0.1);
                color: #ef4444;
            }

            /* 预测结果显示样式 - 大气酷炫版本 */
            .prediction-result {
                margin-top: 2rem;
                padding: 0;
                border-radius: 20px;
                text-align: center;
                font-weight: 700;
                position: relative;
                overflow: hidden;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
                animation: resultAppear 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                backdrop-filter: blur(10px);
                border: 3px solid transparent;
            }

            .prediction-result.success {
                background: linear-gradient(135deg, #00D4AA 0%, #00B894 50%, #00A085 100%);
                color: white;
                box-shadow: 0 20px 40px rgba(0, 212, 170, 0.4), 0 0 60px rgba(0, 212, 170, 0.2);
            }

            .prediction-result.success::before {
                content: '';
                position: absolute;
                top: -2px;
                left: -2px;
                right: -2px;
                bottom: -2px;
                background: linear-gradient(45deg, #00D4AA, #00F5D4, #00D4AA);
                border-radius: 20px;
                z-index: -1;
                animation: borderGlow 2s infinite;
            }

            .prediction-result.failure {
                background: linear-gradient(135deg, #FF6B6B 0%, #FF5252 50%, #FF3D3D 100%);
                color: white;
                box-shadow: 0 20px 40px rgba(255, 107, 107, 0.4), 0 0 60px rgba(255, 107, 107, 0.2);
            }

            .prediction-result.failure::before {
                content: '';
                position: absolute;
                top: -2px;
                left: -2px;
                right: -2px;
                bottom: -2px;
                background: linear-gradient(45deg, #FF6B6B, #FF8A8A, #FF6B6B);
                border-radius: 20px;
                z-index: -1;
                animation: borderGlow 2s infinite;
            }

            @keyframes resultAppear {
                0% {
                    opacity: 0;
                    transform: translateY(50px) scale(0.8) rotateX(90deg);
                    filter: blur(20px);
                }

                50% {
                    opacity: 0.8;
                    transform: translateY(-10px) scale(1.05) rotateX(0deg);
                    filter: blur(5px);
                }

                100% {
                    opacity: 1;
                    transform: translateY(0) scale(1) rotateX(0deg);
                    filter: blur(0px);
                }
            }

            @keyframes borderGlow {

                0%,
                100% {
                    opacity: 0.8;
                    transform: scale(1);
                }

                50% {
                    opacity: 1;
                    transform: scale(1.02);
                }
            }

            .result-icon {
                font-size: 2rem;
                margin-bottom: 0.5rem;
                display: block;
            }

            .result-details {
                margin-top: 0.75rem;
                font-size: 0.9rem;
                opacity: 0.8;
                line-height: 1.4;
            }

            .result-stats {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
                margin-top: 1rem;
                font-size: 0.85rem;
            }

            .result-stat-item {
                text-align: center;
                padding: 0.5rem;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 4px;
            }

            .result-stat-label {
                opacity: 0.7;
                margin-bottom: 0.25rem;
            }

            .result-stat-value {
                font-weight: 700;
                font-family: 'Courier New', monospace;
            }

            /* 大气的结果头部 */
            .result-header {
                padding: 2rem 1.5rem 1rem;
                position: relative;
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                border-radius: 20px 20px 0 0;
            }

            .result-main-icon {
                font-size: 4rem;
                margin-bottom: 1rem;
                display: block;
                text-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
                animation: iconPulse 2s infinite;
            }

            .result-main-text {
                font-size: 2rem;
                font-weight: 900;
                margin-bottom: 0.5rem;
                text-transform: uppercase;
                letter-spacing: 2px;
                text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            }

            .result-sub-text {
                font-size: 1.2rem;
                opacity: 0.9;
                font-weight: 500;
            }

            @keyframes iconPulse {

                0%,
                100% {
                    transform: scale(1);
                    text-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
                }

                50% {
                    transform: scale(1.1);
                    text-shadow: 0 0 50px rgba(255, 255, 255, 0.8);
                }
            }

            /* 涨跌符号大气显示 */
            .direction-display {
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 2rem;
                padding: 2rem 1.5rem;
                background: rgba(0, 0, 0, 0.2);
                margin: 0;
            }

            .direction-item {
                text-align: center;
                flex: 1;
                position: relative;
            }

            .direction-symbol {
                font-size: 5rem;
                font-weight: 900;
                display: block;
                margin-bottom: 1rem;
                text-shadow: 0 0 40px currentColor;
            }

            .direction-symbol.up {
                color: #00F5D4;
                animation: symbolGlowUp 3s infinite;
            }

            .direction-symbol.down {
                color: #FF8A8A;
                animation: symbolGlowDown 3s infinite;
            }

            .direction-label {
                font-size: 1.1rem;
                font-weight: 700;
                text-transform: uppercase;
                letter-spacing: 1px;
                opacity: 0.9;
            }

            .direction-value {
                font-size: 0.9rem;
                opacity: 0.8;
                margin-top: 0.5rem;
            }

            @keyframes symbolGlowUp {

                0%,
                100% {
                    transform: translateY(0) scale(1);
                    text-shadow: 0 0 40px #00F5D4, 0 0 80px #00D4AA;
                }

                50% {
                    transform: translateY(-10px) scale(1.1);
                    text-shadow: 0 0 60px #00F5D4, 0 0 120px #00D4AA;
                }
            }

            @keyframes symbolGlowDown {

                0%,
                100% {
                    transform: translateY(0) scale(1);
                    text-shadow: 0 0 40px #FF8A8A, 0 0 80px #FF6B6B;
                }

                50% {
                    transform: translateY(10px) scale(1.1);
                    text-shadow: 0 0 60px #FF8A8A, 0 0 120px #FF6B6B;
                }
            }

            /* 重新设计统计数据显示 */
            .prediction-result .result-stats {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 1.5rem;
                padding: 2rem 1.5rem;
                background: rgba(0, 0, 0, 0.3);
                border-radius: 0 0 20px 20px;
                margin-top: 0;
            }

            .prediction-result .result-stat-item {
                text-align: center;
                padding: 1rem;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 12px;
                backdrop-filter: blur(5px);
                border: 1px solid rgba(255, 255, 255, 0.2);
            }

            .prediction-result .result-stat-label {
                font-size: 0.9rem;
                opacity: 0.8;
                margin-bottom: 0.5rem;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .prediction-result .result-stat-value {
                font-size: 1.3rem;
                font-weight: 700;
                text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
            }

            /* 预测统计样式 */
            .prediction-stats {
                background: var(--bg-secondary);
                border: 1px solid var(--border-color);
                border-radius: 8px;
                padding: 1rem;
                margin-top: 1rem;
            }

            .stats-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 1rem;
            }

            .stats-title {
                font-size: 1rem;
                font-weight: 600;
                color: var(--text-primary);
            }

            .realtime-badge {
                background: linear-gradient(45deg, #22c55e, #16a34a);
                color: white;
                padding: 0.25rem 0.75rem;
                border-radius: 20px;
                font-size: 0.75rem;
                font-weight: 600;
                display: flex;
                align-items: center;
                gap: 0.25rem;
                animation: pulse 2s infinite;
            }

            @keyframes pulse {

                0%,
                100% {
                    opacity: 1;
                }

                50% {
                    opacity: 0.8;
                }
            }

            .accuracy-display {
                text-align: center;
                margin-bottom: 1rem;
            }

            .accuracy-main {
                font-size: 2.5rem;
                font-weight: 700;
                font-family: 'Courier New', monospace;
                margin-bottom: 0.25rem;
            }

            .accuracy-main.excellent {
                color: #22c55e;
            }

            .accuracy-main.good {
                color: #3b82f6;
            }

            .accuracy-main.average {
                color: #f59e0b;
            }

            .accuracy-main.poor {
                color: #ef4444;
            }

            .accuracy-label {
                font-size: 0.9rem;
                color: var(--text-secondary);
                margin-bottom: 0.5rem;
            }

            .accuracy-trend {
                display: inline-flex;
                align-items: center;
                gap: 0.25rem;
                font-size: 0.8rem;
                font-weight: 600;
                padding: 0.25rem 0.5rem;
                border-radius: 12px;
            }

            .accuracy-trend.up {
                background: rgba(34, 197, 94, 0.1);
                color: #22c55e;
            }

            .accuracy-trend.down {
                background: rgba(239, 68, 68, 0.1);
                color: #ef4444;
            }

            .accuracy-trend.stable {
                background: rgba(107, 114, 128, 0.1);
                color: #6b7280;
            }

            .stats-grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
                margin-bottom: 1rem;
            }

            .stat-item {
                text-align: center;
                padding: 0.75rem;
                background: var(--bg-primary);
                border-radius: 6px;
                border: 1px solid var(--border-color);
            }

            .stat-value {
                font-size: 1.2rem;
                font-weight: 700;
                color: var(--text-primary);
                font-family: 'Courier New', monospace;
                margin-bottom: 0.25rem;
            }

            .stat-label {
                font-size: 0.8rem;
                color: var(--text-secondary);
            }

            .timeframe-stats {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 0.5rem;
                margin-top: 1rem;
            }

            .timeframe-stat {
                text-align: center;
                padding: 0.5rem;
                background: var(--bg-primary);
                border-radius: 4px;
                border: 1px solid var(--border-color);
            }

            .timeframe-stat-value {
                font-size: 1rem;
                font-weight: 600;
                color: var(--text-primary);
                margin-bottom: 0.25rem;
            }

            .timeframe-stat-label {
                font-size: 0.7rem;
                color: var(--text-secondary);
            }

            @media (max-width: 768px) {
                .stats-grid {
                    grid-template-columns: 1fr;
                    gap: 0.75rem;
                }

                .timeframe-stats {
                    grid-template-columns: repeat(2, 1fr);
                }

                .accuracy-main {
                    font-size: 2rem;
                }
            }

            /* 记住登录信息样式 */
            .remember-login-checkbox {
                appearance: none;
                width: 16px;
                height: 16px;
                border: 2px solid var(--border-color);
                border-radius: 3px;
                background: var(--bg-primary);
                cursor: pointer;
                position: relative;
                transition: all 0.2s ease;
            }

            .remember-login-checkbox:checked {
                background: var(--primary-color);
                border-color: var(--primary-color);
            }

            .remember-login-checkbox:checked::after {
                content: '✓';
                position: absolute;
                top: -2px;
                left: 1px;
                color: white;
                font-size: 12px;
                font-weight: bold;
            }

            .remember-login-checkbox:hover {
                border-color: var(--primary-color);
            }

            .remember-login-label {
                display: flex;
                align-items: center;
                font-size: 0.9rem;
                cursor: pointer;
                user-select: none;
            }

            .remember-login-label:hover {
                color: var(--primary-color);
            }

            /* 移动端图表优化 */
            .trading-chart-container {
                position: relative;
                background: var(--bg-primary);
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            }

            .trading-chart-header {
                padding: 1rem;
                border-bottom: 1px solid var(--border-color);
                background: var(--bg-secondary);
            }

            .trading-chart-controls {
                display: flex;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .timeframe-buttons {
                display: flex;
                gap: 0.25rem;
                flex-wrap: wrap;
            }

            .timeframe-btn {
                padding: 0.4rem 0.8rem;
                border: 1px solid var(--border-color);
                background: var(--bg-primary);
                color: var(--text-primary);
                border-radius: 6px;
                font-size: 0.85rem;
                cursor: pointer;
                transition: all 0.2s ease;
                min-width: 40px;
                text-align: center;
            }

            .timeframe-btn:hover {
                background: var(--primary-color);
                color: white;
                border-color: var(--primary-color);
            }

            .timeframe-btn.active {
                background: var(--primary-color);
                color: white;
                border-color: var(--primary-color);
            }

            /* 移动端响应式 */
            @media (max-width: 768px) {
                .trading-chart-controls {
                    flex-direction: column;
                    align-items: stretch;
                }

                .timeframe-buttons {
                    justify-content: center;
                }

                .timeframe-btn {
                    flex: 1;
                    min-width: 50px;
                    padding: 0.6rem 0.4rem;
                    font-size: 0.9rem;
                }

                .trading-chart-container {
                    margin: 0.5rem;
                    border-radius: 8px;
                }

                .trading-chart-header {
                    padding: 0.75rem;
                }
            }

            /* 图表加载状态 */
            .chart-loading {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 400px;
                color: var(--text-secondary);
                font-size: 0.9rem;
            }

            .chart-loading::before {
                content: '';
                width: 20px;
                height: 20px;
                border: 2px solid var(--border-color);
                border-top: 2px solid var(--primary-color);
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin-right: 0.5rem;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }

                100% {
                    transform: rotate(360deg);
                }
            }

            /* 复投机制样式 */
            .martingale-system {
                background: var(--bg-primary);
                border-radius: 12px;
                padding: 1.5rem;
                border: 1px solid var(--border-color);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }

            .martingale-controls {
                display: flex;
                gap: 0.5rem;
            }

            .btn-sm {
                padding: 0.4rem 0.8rem;
                font-size: 0.85rem;
                border-radius: 6px;
            }

            .btn-info {
                background: #17a2b8;
                color: white;
                border: 1px solid #17a2b8;
            }

            .btn-info:hover {
                background: #138496;
                border-color: #138496;
            }

            .martingale-settings {
                margin: 1rem 0;
            }

            .setting-row {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 1rem;
                align-items: end;
            }

            .setting-item {
                display: flex;
                flex-direction: column;
            }

            .setting-item label {
                font-size: 0.9rem;
                color: var(--text-secondary);
                margin-bottom: 0.5rem;
            }

            .form-control-sm {
                padding: 0.5rem;
                border: 1px solid var(--border-color);
                border-radius: 6px;
                background: var(--bg-secondary);
                color: var(--text-primary);
                font-size: 0.9rem;
            }

            .form-control-sm:focus {
                outline: none;
                border-color: var(--primary-color);
                box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
            }

            .martingale-status {
                margin-top: 1rem;
            }

            .status-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 1rem;
            }

            .status-item {
                text-align: center;
                padding: 1rem;
                background: var(--bg-secondary);
                border-radius: 8px;
                border: 1px solid var(--border-color);
            }

            .status-value {
                font-size: 1.2rem;
                font-weight: bold;
                color: var(--text-primary);
                margin-bottom: 0.25rem;
            }

            .status-value.profit {
                color: #00D4AA;
            }

            .status-value.loss {
                color: #FF6B6B;
            }

            .status-label {
                font-size: 0.8rem;
                color: var(--text-secondary);
            }

            .status-item.highlight {
                background: linear-gradient(135deg, #4A90E2, #357ABD);
                border-color: #4A90E2;
                transform: scale(1.02);
                box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
                animation: pulse 2s infinite;
            }

            .status-item.highlight .status-value {
                color: white;
            }

            .status-item.highlight .status-label {
                color: rgba(255, 255, 255, 0.8);
            }

            @keyframes pulse {

                0%,
                100% {
                    transform: scale(1.02);
                }

                50% {
                    transform: scale(1.05);
                }
            }

            /* 预测结果同步状态样式 */
            .martingale-sync-status {
                margin: 1rem 0;
                padding: 1rem;
                background: var(--bg-secondary);
                border-radius: 8px;
                border: 1px solid var(--border-color);
            }

            .sync-status-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1rem;
            }

            .sync-status-indicator {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.5rem 1rem;
                border-radius: 20px;
                font-size: 0.9rem;
                font-weight: bold;
            }

            .sync-status-indicator.waiting {
                background: #FFA726;
                color: white;
            }

            .sync-status-indicator.success {
                background: #00D4AA;
                color: white;
            }

            .sync-status-indicator.failed {
                background: #FF6B6B;
                color: white;
            }

            .sync-status-indicator.betting {
                background: #4A90E2;
                color: white;
                animation: blink 1.5s infinite;
            }

            @keyframes blink {

                0%,
                50% {
                    opacity: 1;
                }

                51%,
                100% {
                    opacity: 0.6;
                }
            }

            .last-result {
                font-size: 0.9rem;
                color: var(--text-secondary);
            }

            /* 复投进度条样式 */
            .martingale-progress {
                margin: 1rem 0;
            }

            .progress-header {
                display: flex;
                justify-content: space-between;
                margin-bottom: 0.5rem;
                font-size: 0.9rem;
                color: var(--text-secondary);
            }

            .progress-bar {
                height: 8px;
                background: var(--border-color);
                border-radius: 4px;
                overflow: hidden;
                margin-bottom: 0.5rem;
            }

            .progress-fill {
                height: 100%;
                background: linear-gradient(90deg, #4A90E2, #00D4AA);
                transition: width 0.3s ease;
            }

            .progress-steps {
                display: flex;
                justify-content: space-between;
                margin-top: 0.5rem;
            }

            .progress-step {
                width: 30px;
                height: 30px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.8rem;
                font-weight: bold;
                border: 2px solid var(--border-color);
                background: var(--bg-primary);
                color: var(--text-secondary);
                transition: all 0.3s ease;
            }

            .progress-step.completed {
                background: #00D4AA;
                border-color: #00D4AA;
                color: white;
            }

            .progress-step.current {
                background: #4A90E2;
                border-color: #4A90E2;
                color: white;
                animation: pulse-step 2s infinite;
            }

            .progress-step.failed {
                background: #FF6B6B;
                border-color: #FF6B6B;
                color: white;
            }

            @keyframes pulse-step {

                0%,
                100% {
                    transform: scale(1);
                }

                50% {
                    transform: scale(1.1);
                }
            }

            /* 下一轮预览样式 */
            .next-round-preview {
                margin-top: 1rem;
                padding: 1rem;
                background: linear-gradient(135deg, #FF6B6B, #FF8E8E);
                border-radius: 8px;
                color: white;
            }

            .preview-header {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                font-weight: bold;
                margin-bottom: 0.75rem;
                font-size: 0.95rem;
            }

            .preview-content {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 0.75rem;
            }

            .preview-item {
                display: flex;
                flex-direction: column;
                text-align: center;
            }

            .preview-item span {
                font-size: 0.8rem;
                opacity: 0.9;
                margin-bottom: 0.25rem;
            }

            .preview-item strong {
                font-size: 1rem;
                font-weight: bold;
            }

            .preview-item.highlight strong {
                font-size: 1.2rem;
                text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
                animation: glow 2s infinite;
            }

            @keyframes glow {

                0%,
                100% {
                    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
                }

                50% {
                    text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
                }
            }

            /* 计算器弹窗样式 */
            .calculator-modal {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                padding: 1rem;
            }

            .calculator-content {
                background: var(--bg-primary);
                border-radius: 12px;
                width: 100%;
                max-width: 600px;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            }

            .calculator-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 1.5rem;
                border-bottom: 1px solid var(--border-color);
            }

            .calculator-header h4 {
                margin: 0;
                color: var(--text-primary);
            }

            .calculator-body {
                padding: 1.5rem;
            }

            .calc-inputs {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 1rem;
                margin-bottom: 1.5rem;
            }

            .calc-input-group {
                display: flex;
                flex-direction: column;
            }

            .calc-input-group label {
                font-size: 0.9rem;
                color: var(--text-secondary);
                margin-bottom: 0.5rem;
            }

            .calc-summary {
                display: flex;
                justify-content: space-between;
                padding: 1rem;
                background: var(--bg-secondary);
                border-radius: 8px;
                margin-bottom: 1rem;
            }

            .summary-item {
                text-align: center;
            }

            .summary-item span {
                display: block;
                font-size: 0.9rem;
                color: var(--text-secondary);
                margin-bottom: 0.25rem;
            }

            .summary-item strong {
                font-size: 1.1rem;
                color: var(--text-primary);
            }

            .calc-table {
                border: 1px solid var(--border-color);
                border-radius: 8px;
                overflow: hidden;
            }

            .calc-table-header {
                display: grid;
                grid-template-columns: 0.8fr 1fr 1fr 1fr 1fr 0.8fr;
                background: var(--bg-secondary);
                font-weight: bold;
                font-size: 0.9rem;
                color: var(--text-primary);
            }

            .calc-table-header>div,
            .calc-table-row>div {
                padding: 0.75rem;
                text-align: center;
                border-right: 1px solid var(--border-color);
            }

            .calc-table-header>div:last-child,
            .calc-table-row>div:last-child {
                border-right: none;
            }

            .calc-table-row {
                display: grid;
                grid-template-columns: 0.8fr 1fr 1fr 1fr 1fr 0.8fr;
                border-bottom: 1px solid var(--border-color);
                font-size: 0.9rem;
            }

            .calc-table-row:last-child {
                border-bottom: none;
            }

            .calc-table-row:nth-child(even) {
                background: var(--bg-secondary);
            }

            .calc-actions {
                display: flex;
                justify-content: center;
                gap: 1rem;
                margin-top: 1.5rem;
            }

            .profit {
                color: #00D4AA !important;
            }

            .loss {
                color: #FF6B6B !important;
            }

            .return {
                color: #4A90E2;
                font-weight: 600;
            }

            .positive {
                color: #00D4AA !important;
            }

            .negative {
                color: #FF6B6B !important;
            }

            .profit-rate {
                font-weight: 600;
                font-size: 0.85rem;
            }

            /* 移动端优化 */
            @media (max-width: 768px) {
                .setting-row {
                    grid-template-columns: 1fr;
                }

                .status-grid {
                    grid-template-columns: repeat(2, 1fr);
                }

                .calc-inputs {
                    grid-template-columns: 1fr;
                }

                .calc-summary {
                    flex-direction: column;
                    gap: 1rem;
                }

                .calc-table-header,
                .calc-table-row {
                    grid-template-columns: 1fr 1fr 1fr;
                    font-size: 0.75rem;
                }

                .calc-table-header>div:nth-child(4),
                .calc-table-header>div:nth-child(5),
                .calc-table-header>div:nth-child(6),
                .calc-table-row>div:nth-child(4),
                .calc-table-row>div:nth-child(5),
                .calc-table-row>div:nth-child(6) {
                    display: none;
                }

                .calc-actions {
                    flex-direction: column;
                }
            }
        </style>
    </head>

    <body>
        <div id="app" class="app-container">
            <!-- 连接状态指示器 -->
            <div class="connection-status" :class="connectionStatus">
                <i class="fas" :class="connectionStatus === 'connected' ? 'fa-wifi' : 'fa-exclamation-triangle'"></i>
                {{ connectionStatus === 'connected' ? '🟢 实时数据' : '🟡 离线模式' }}
            </div>

            <!-- 顶部导航 -->
            <nav class="navbar">
                <div class="logo">
                    <i class="fas fa-chart-line"></i>
                    永续合约预测系统
                </div>

                <div class="nav-menu">
                    <div class="nav-item" :class="{ active: currentView === 'dashboard' }"
                        @click="currentView = 'dashboard'">
                        <i class="fas fa-tachometer-alt"></i>
                        交易仪表盘
                    </div>
                    <div class="nav-item" :class="{ active: currentView === 'prediction' }"
                        @click="currentView = 'prediction'">
                        <i class="fas fa-crystal-ball"></i>
                        AI预测
                    </div>
                    <div class="nav-item" :class="{ active: currentView === 'membership' }"
                        @click="currentView = 'membership'">
                        <i class="fas fa-crown"></i>
                        会员中心
                    </div>
                    <!-- 数据源状态指示器 -->
                    <div class="data-source-indicator" :class="dataSource" :title="getDataSourceTitle()">
                        <i class="fas" :class="getDataSourceIcon()"></i>
                        <span class="data-source-text">{{ getDataSourceText() }}</span>
                    </div>

                    <button class="theme-toggle" @click="toggleTheme" :title="isDarkMode ? '切换到白天模式' : '切换到黑夜模式'">
                        <i class="fas" :class="isDarkMode ? 'fa-sun' : 'fa-moon'"></i>
                    </button>
                    <div class="nav-item" v-if="!user" @click="showLoginModal = true">
                        <i class="fas fa-sign-in-alt"></i>
                        登录
                    </div>
                    <div class="nav-item" v-if="user" @click="logout">
                        <i class="fas fa-sign-out-alt"></i>
                        退出 ({{ user.username }})
                    </div>
                </div>
            </nav>

            <!-- 主要内容区域 -->
            <main class="main-content">
                <!-- 交易仪表盘视图 -->
                <div v-if="currentView === 'dashboard'" class="trading-dashboard">
                    <!-- 左侧：价格列表 -->
                    <div class="panel">
                        <div class="panel-header">
                            <div>
                                <span>{{ selectedSymbol }} 实时价格</span>
                                <div class="reference-exchange" v-if="selectedExchange">
                                    <small>参照: {{ getExchangeName(selectedExchange) }}</small>
                                </div>
                            </div>
                            <div class="header-controls">
                                <select v-model="selectedSymbol" @change="changeSymbol" class="symbol-select">
                                    <option value="BTCUSDT">BTC/USDT</option>
                                    <option value="ETHUSDT">ETH/USDT</option>
                                </select>
                            </div>
                        </div>
                        <div class="panel-content">
                            <!-- 交易所选择器 -->
                            <div class="exchange-selector">
                                <h4>选择参照交易所</h4>
                                <div class="exchange-grid">
                                    <div v-for="exchange in exchanges" :key="exchange.id" class="exchange-option"
                                        :class="{ active: selectedExchange === exchange.id }"
                                        @click="selectExchange(exchange.id)">
                                        <div class="exchange-icon" :style="{ backgroundColor: exchange.color }">
                                            {{ exchange.icon }}
                                        </div>
                                        <div class="exchange-details">
                                            <div class="exchange-name">{{ exchange.name }}</div>
                                            <div class="exchange-price"
                                                v-if="marketData[selectedSymbol] && marketData[selectedSymbol][exchange.id]">
                                                ${{ marketData[selectedSymbol][exchange.id].price?.toFixed(2) }}
                                            </div>
                                        </div>
                                        <div class="selection-indicator" v-if="selectedExchange === exchange.id">
                                            <i class="fas fa-check"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="divider"></div>

                            <!-- 价格对比列表 -->
                            <div class="price-comparison">
                                <h4>价格对比 (vs {{ getExchangeName(selectedExchange) }})</h4>
                                <div class="price-list">
                                    <div v-for="(data, exchange) in marketData[selectedSymbol] || {}" :key="exchange"
                                        class="price-item" :class="{
                                        'reference-exchange': exchange === selectedExchange,
                                        'price-higher': isHigherThanReference(exchange, data.price),
                                        'price-lower': isLowerThanReference(exchange, data.price),
                                        'price-up': data.change_percent_24h > 0,
                                        'price-down': data.change_percent_24h < 0
                                    }">
                                        <div class="exchange-info">
                                            <div class="exchange-icon"
                                                :style="{ backgroundColor: getExchangeColor(exchange) }">
                                                {{ getExchangeIcon(exchange) }}
                                            </div>
                                            <span class="exchange-name">{{ getExchangeName(exchange) }}</span>
                                            <span v-if="exchange === selectedExchange" class="reference-badge">参照</span>
                                        </div>

                                        <div class="price-info">
                                            <div class="current-price">
                                                ${{ data.price?.toFixed(2) || '0.00' }}
                                                <span class="price-change"
                                                    :class="data.change_percent_24h > 0 ? 'positive' : 'negative'">
                                                    {{ data.change_percent_24h > 0 ? '+' : '' }}{{
                                                    data.change_percent_24h?.toFixed(2) || '0.00' }}%
                                                </span>
                                            </div>

                                            <div class="additional-info">
                                                <span class="volume">24h量: {{ formatVolume(data.volume_24h) }}</span>
                                                <span v-if="data.funding_rate" class="funding-rate">
                                                    资金费率: {{ (data.funding_rate * 100).toFixed(4) }}%
                                                </span>
                                                <span v-if="exchange !== selectedExchange" class="price-diff">
                                                    差价: {{ getPriceDifference(exchange, data.price) }}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 中间：实时行情表 -->
                    <div class="panel market-ticker-panel">
                        <div class="panel-header">
                            <span><i class="fas fa-chart-bar"></i> 实时行情</span>
                            <div class="ticker-controls">
                                <!-- 搜索框 -->
                                <div class="search-container">
                                    <div class="search-input-wrapper">
                                        <i class="fas fa-search search-icon"></i>
                                        <input type="text" v-model="tickerSearchQuery" @input="searchTickers"
                                            placeholder="搜索币种..." class="search-input">
                                        <button v-if="tickerSearchQuery" @click="clearSearch" class="clear-search-btn">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>

                                <!-- 筛选器 -->
                                <select v-model="tickerFilter" @change="filterTickers">
                                    <option value="all">全部</option>
                                    <option value="usdt">USDT交易对</option>
                                    <option value="btc">BTC交易对</option>
                                    <option value="favorites">自选</option>
                                </select>

                                <!-- 刷新按钮 -->
                                <button class="refresh-btn" @click="refreshTickers" :disabled="tickerRefreshing">
                                    <i class="fas fa-sync-alt" :class="{ 'fa-spin': tickerRefreshing }"></i>
                                </button>
                            </div>
                        </div>
                        <div class="panel-content">
                            <div class="ticker-table-container">
                                <table class="ticker-table">
                                    <thead>
                                        <tr>
                                            <th @click="sortTickers('symbol')" class="sortable">
                                                交易对
                                                <i class="fas fa-sort" v-if="tickerSort.field !== 'symbol'"></i>
                                                <i class="fas fa-sort-up"
                                                    v-else-if="tickerSort.direction === 'asc'"></i>
                                                <i class="fas fa-sort-down" v-else></i>
                                            </th>
                                            <th @click="sortTickers('price')" class="sortable text-right">
                                                最新价格
                                                <i class="fas fa-sort" v-if="tickerSort.field !== 'price'"></i>
                                                <i class="fas fa-sort-up"
                                                    v-else-if="tickerSort.direction === 'asc'"></i>
                                                <i class="fas fa-sort-down" v-else></i>
                                            </th>
                                            <th @click="sortTickers('changePercent')" class="sortable text-right">
                                                24h涨跌
                                                <i class="fas fa-sort" v-if="tickerSort.field !== 'changePercent'"></i>
                                                <i class="fas fa-sort-up"
                                                    v-else-if="tickerSort.direction === 'asc'"></i>
                                                <i class="fas fa-sort-down" v-else></i>
                                            </th>
                                            <th @click="sortTickers('volume')" class="sortable text-right">
                                                24h成交量
                                                <i class="fas fa-sort" v-if="tickerSort.field !== 'volume'"></i>
                                                <i class="fas fa-sort-up"
                                                    v-else-if="tickerSort.direction === 'asc'"></i>
                                                <i class="fas fa-sort-down" v-else></i>
                                            </th>
                                            <th class="text-center">操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="ticker in filteredTickers" :key="ticker.symbol" class="ticker-row"
                                            :class="{ 'selected': ticker.symbol === selectedSymbol, 'price-up': ticker.priceChange > 0, 'price-down': ticker.priceChange < 0 }"
                                            @click="selectTicker(ticker)">
                                            <td class="symbol-cell">
                                                <div class="symbol-info">
                                                    <span class="symbol-name">{{ ticker.symbol }}</span>
                                                    <span class="symbol-desc">{{ ticker.description }}</span>
                                                </div>
                                                <i class="fas fa-star favorite-icon"
                                                    :class="{ 'active': ticker.isFavorite }"
                                                    @click.stop="toggleFavorite(ticker)"></i>
                                            </td>
                                            <td class="price-cell text-right">
                                                <div class="price-info">
                                                    <span class="price">{{ formatPrice(ticker.price) }}</span>
                                                    <span class="price-change-indicator"
                                                        :class="ticker.priceChange > 0 ? 'up' : ticker.priceChange < 0 ? 'down' : ''">
                                                        <i class="fas fa-caret-up" v-if="ticker.priceChange > 0"></i>
                                                        <i class="fas fa-caret-down"
                                                            v-else-if="ticker.priceChange < 0"></i>
                                                    </span>
                                                </div>
                                            </td>
                                            <td class="change-cell text-right">
                                                <div class="change-info">
                                                    <span class="change-percent"
                                                        :class="ticker.changePercent >= 0 ? 'positive' : 'negative'">
                                                        {{ ticker.changePercent >= 0 ? '+' : '' }}{{
                                                        ticker.changePercent.toFixed(2) }}%
                                                    </span>
                                                    <span class="change-amount"
                                                        :class="ticker.changeAmount >= 0 ? 'positive' : 'negative'">
                                                        {{ ticker.changeAmount >= 0 ? '+' : '' }}{{
                                                        formatPrice(ticker.changeAmount) }}
                                                    </span>
                                                </div>
                                            </td>
                                            <td class="volume-cell text-right">
                                                <div class="volume-info">
                                                    <span class="volume">{{ formatVolume(ticker.volume) }}</span>
                                                    <span class="volume-usd">${{ formatVolume(ticker.volumeUsd)
                                                        }}</span>
                                                </div>
                                            </td>
                                            <td class="action-cell text-center">
                                                <button class="btn btn-sm btn-primary"
                                                    @click.stop="startTrading(ticker)">
                                                    交易
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <!-- 加载状态 -->
                                <div v-if="tickersLoading" class="loading-overlay">
                                    <div class="loading-spinner">
                                        <i class="fas fa-spinner fa-spin fa-2x"></i>
                                        <p>加载行情数据...</p>
                                    </div>
                                </div>

                                <!-- 空状态 -->
                                <div v-if="!tickersLoading && filteredTickers.length === 0" class="empty-state">
                                    <i class="fas fa-chart-line fa-3x"></i>
                                    <p>暂无行情数据</p>
                                    <button class="btn btn-primary" @click="refreshTickers">刷新数据</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 右侧：深度图和交易信息 -->
                    <div class="panel">
                        <div class="panel-header">
                            <span>市场深度</span>
                        </div>
                        <div class="panel-content">
                            <div class="depth-chart">
                                <div class="chart-placeholder">
                                    <i class="fas fa-layer-group fa-2x" style="color: #ccc; margin-bottom: 0.5rem;"></i>
                                    <p>深度图</p>
                                </div>
                            </div>

                            <div class="orderbook">
                                <div class="orderbook-header">
                                    <span>价格</span>
                                    <span>数量</span>
                                    <span>累计</span>
                                </div>

                                <!-- 卖单 -->
                                <div class="asks">
                                    <div v-for="i in 5" :key="`ask-${i}`" class="order-row ask-row">
                                        <span class="price">{{ (getCurrentPrice() * (1 + i * 0.001)).toFixed(2)
                                            }}</span>
                                        <span class="amount">{{ (Math.random() * 10).toFixed(4) }}</span>
                                        <span class="total">{{ (Math.random() * 100).toFixed(4) }}</span>
                                    </div>
                                </div>

                                <!-- 当前价格 -->
                                <div class="current-price-row">
                                    <span class="current-price">${{ getCurrentPrice().toFixed(2) }}</span>
                                </div>

                                <!-- 买单 -->
                                <div class="bids">
                                    <div v-for="i in 5" :key="`bid-${i}`" class="order-row bid-row">
                                        <span class="price">{{ (getCurrentPrice() * (1 - i * 0.001)).toFixed(2)
                                            }}</span>
                                        <span class="amount">{{ (Math.random() * 10).toFixed(4) }}</span>
                                        <span class="total">{{ (Math.random() * 100).toFixed(4) }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI预测视图 -->
                <div v-if="currentView === 'prediction'" class="prediction-view">
                    <div class="panel">
                        <div class="panel-header">
                            <span><i class="fas fa-robot"></i> AI智能预测</span>
                        </div>
                        <div class="panel-content">
                            <div style="text-align: center; margin: 2rem 0;">
                                <h3>选择预测参数</h3>
                                <div style="margin: 2rem 0;">
                                    <label>交易对：</label>
                                    <select v-model="predictionSymbol"
                                        style="margin: 0 1rem; padding: 0.5rem; min-width: 150px;">
                                        <optgroup label="主流币种">
                                            <option value="BTCUSDT">BTC/USDT - Bitcoin</option>
                                            <option value="ETHUSDT">ETH/USDT - Ethereum</option>
                                            <option value="BNBUSDT">BNB/USDT - BNB</option>
                                            <option value="ADAUSDT">ADA/USDT - Cardano</option>
                                            <option value="XRPUSDT">XRP/USDT - XRP</option>
                                            <option value="SOLUSDT">SOL/USDT - Solana</option>
                                            <option value="DOTUSDT">DOT/USDT - Polkadot</option>
                                            <option value="LINKUSDT">LINK/USDT - Chainlink</option>
                                        </optgroup>
                                        <optgroup label="热门币种">
                                            <option value="AVAXUSDT">AVAX/USDT - Avalanche</option>
                                            <option value="DOGEUSDT">DOGE/USDT - Dogecoin</option>
                                            <option value="MATICUSDT">MATIC/USDT - Polygon</option>
                                            <option value="ATOMUSDT">ATOM/USDT - Cosmos</option>
                                            <option value="LTCUSDT">LTC/USDT - Litecoin</option>
                                            <option value="UNIUSDT">UNI/USDT - Uniswap</option>
                                            <option value="ALGOUSDT">ALGO/USDT - Algorand</option>
                                            <option value="VETUSDT">VET/USDT - VeChain</option>
                                        </optgroup>
                                        <optgroup label="新兴币种">
                                            <option value="FTMUSDT">FTM/USDT - Fantom</option>
                                            <option value="SANDUSDT">SAND/USDT - Sandbox</option>
                                            <option value="MANAUSDT">MANA/USDT - Decentraland</option>
                                            <option value="AXSUSDT">AXS/USDT - Axie Infinity</option>
                                            <option value="CHZUSDT">CHZ/USDT - Chiliz</option>
                                            <option value="ENJUSDT">ENJ/USDT - Enjin Coin</option>
                                            <option value="GALAUSDT">GALA/USDT - Gala</option>
                                            <option value="IMXUSDT">IMX/USDT - Immutable X</option>
                                        </optgroup>
                                        <optgroup label="DeFi币种">
                                            <option value="AAVEUSDT">AAVE/USDT - Aave</option>
                                            <option value="COMPUSDT">COMP/USDT - Compound</option>
                                            <option value="MKRUSDT">MKR/USDT - Maker</option>
                                            <option value="SUSHIUSDT">SUSHI/USDT - SushiSwap</option>
                                            <option value="CRVUSDT">CRV/USDT - Curve</option>
                                            <option value="1INCHUSDT">1INCH/USDT - 1inch</option>
                                            <option value="YFIUSDT">YFI/USDT - Yearn Finance</option>
                                            <option value="SNXUSDT">SNX/USDT - Synthetix</option>
                                        </optgroup>
                                    </select>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                        选择要进行AI预测的加密货币交易对
                                    </div>
                                </div>

                                <div style="margin: 2rem 0;">
                                    <label>参照交易所：</label>
                                    <select v-model="selectedExchange" style="margin: 0 1rem; padding: 0.5rem;">
                                        <option v-for="exchange in exchanges" :key="exchange.id" :value="exchange.id">
                                            {{ exchange.name }}
                                        </option>
                                    </select>
                                    <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                        AI将基于 {{ getExchangeName(selectedExchange) }} 的价格数据进行预测分析
                                    </div>
                                </div>

                                <div style="margin: 2rem 0;">
                                    <label>预测时间框架：</label>
                                    <div style="margin-top: 1rem;">
                                        <label><input type="checkbox" v-model="selectedTimeframes" value="1m">
                                            1分钟</label>
                                        <label style="margin-left: 1rem;"><input type="checkbox"
                                                v-model="selectedTimeframes" value="5m"> 5分钟</label>
                                        <label style="margin-left: 1rem;"><input type="checkbox"
                                                v-model="selectedTimeframes" value="15m"> 15分钟</label>
                                        <label style="margin-left: 1rem;"><input type="checkbox"
                                                v-model="selectedTimeframes" value="1h"> 1小时</label>
                                    </div>
                                </div>

                                <!-- 交易策略选择模块 -->
                                <div
                                    style="margin: 2rem 0; padding: 1.5rem; background: rgba(102, 126, 234, 0.05); border-radius: 12px; border: 1px solid rgba(102, 126, 234, 0.2);">
                                    <h4 style="margin-bottom: 1rem; color: var(--text-primary);">
                                        <i class="fas fa-robot"></i> 交易策略选择
                                    </h4>
                                    <div
                                        style="margin-bottom: 1rem; padding: 0.75rem; background: rgba(102, 126, 234, 0.1); border-radius: 8px; border-left: 4px solid #667eea;">
                                        <div
                                            style="font-size: 0.9rem; color: var(--text-primary); margin-bottom: 0.5rem;">
                                            <strong>策略说明：</strong>
                                        </div>
                                        <div
                                            style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.4;">
                                            <strong>均线交叉策略：</strong>基于短期和长期均线的交叉信号，结合RSI指标过滤，适合趋势明显的市场。<br>
                                            <strong>动量反弹策略：</strong>识别超卖反弹机会，结合价格跌幅和成交量确认，适合震荡或超跌反弹行情。
                                        </div>
                                    </div>

                                    <!-- 策略类型选择 -->
                                    <div style="margin-bottom: 1.5rem;">
                                        <label
                                            style="font-weight: 600; margin-bottom: 0.5rem; display: block;">选择交易策略：</label>
                                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                            <label
                                                style="display: flex; align-items: center; cursor: pointer; padding: 0.75rem 1rem; background: var(--bg-secondary); border: 2px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
                                                <input type="radio" v-model="selectedStrategy" value="ma_cross"
                                                    style="margin-right: 0.5rem;">
                                                <div>
                                                    <div style="font-weight: 600;">均线交叉策略</div>
                                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">适合趋势行情
                                                    </div>
                                                </div>
                                            </label>
                                            <label
                                                style="display: flex; align-items: center; cursor: pointer; padding: 0.75rem 1rem; background: var(--bg-secondary); border: 2px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
                                                <input type="radio" v-model="selectedStrategy" value="momentum"
                                                    style="margin-right: 0.5rem;">
                                                <div>
                                                    <div style="font-weight: 600;">动量反弹策略</div>
                                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">适合震荡反弹
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- 策略参数设置 -->
                                    <div v-if="selectedStrategy" style="margin-bottom: 1.5rem;">
                                        <h5 style="margin-bottom: 1rem; color: var(--text-primary);">策略参数设置</h5>

                                        <!-- 均线交叉策略参数 -->
                                        <div v-if="selectedStrategy === 'ma_cross'"
                                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                                            <div>
                                                <label
                                                    style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem; display: block;">短期均线周期</label>
                                                <input type="number" v-model.number="strategyParams.maCross.shortPeriod"
                                                    min="3" max="20" step="1"
                                                    style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-secondary); color: var(--text-primary);">
                                                <div
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                                    推荐: 5-10日</div>
                                            </div>
                                            <div>
                                                <label
                                                    style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem; display: block;">长期均线周期</label>
                                                <input type="number" v-model.number="strategyParams.maCross.longPeriod"
                                                    min="15" max="50" step="1"
                                                    style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-secondary); color: var(--text-primary);">
                                                <div
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                                    推荐: 20-30日</div>
                                            </div>
                                            <div>
                                                <label
                                                    style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem; display: block;">RSI阈值</label>
                                                <input type="number"
                                                    v-model.number="strategyParams.maCross.rsiThreshold" min="20"
                                                    max="80" step="5"
                                                    style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-secondary); color: var(--text-primary);">
                                                <div
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                                    推荐: 30-70</div>
                                            </div>
                                        </div>

                                        <!-- 动量反弹策略参数 -->
                                        <div v-if="selectedStrategy === 'momentum'"
                                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                                            <div>
                                                <label
                                                    style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem; display: block;">超卖RSI阈值</label>
                                                <input type="number"
                                                    v-model.number="strategyParams.momentum.oversoldRsi" min="20"
                                                    max="40" step="1"
                                                    style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-secondary); color: var(--text-primary);">
                                                <div
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                                    推荐: 25-35</div>
                                            </div>
                                            <div>
                                                <label
                                                    style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem; display: block;">跌幅阈值(%)</label>
                                                <input type="number"
                                                    v-model.number="strategyParams.momentum.dropThreshold" min="5"
                                                    max="30" step="1"
                                                    style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-secondary); color: var(--text-primary);">
                                                <div
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                                    推荐: 8-15%</div>
                                            </div>
                                            <div>
                                                <label
                                                    style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem; display: block;">反弹确认天数</label>
                                                <input type="number"
                                                    v-model.number="strategyParams.momentum.confirmationDays" min="1"
                                                    max="5" step="1"
                                                    style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-secondary); color: var(--text-primary);">
                                                <div
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                                    推荐: 2-3天</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 策略分析按钮 -->
                                    <div v-if="selectedStrategy" style="margin-top: 1rem; text-align: center;">
                                        <button @click="analyzeStrategy" class="btn btn-outline"
                                            style="margin-right: 1rem;">
                                            <i class="fas fa-brain"></i> 分析策略
                                        </button>
                                        <button @click="clearStrategyAnalysis" class="btn btn-outline"
                                            v-if="strategyAnalysis">
                                            <i class="fas fa-times"></i> 清除分析
                                        </button>
                                        <div
                                            style="margin-top: 1rem; display: flex; align-items: center; justify-content: center; gap: 1rem;">
                                            <label
                                                style="display: flex; align-items: center; cursor: pointer; font-size: 0.9rem;">
                                                <input type="checkbox" v-model="autoStrategyAnalysis"
                                                    @change="toggleAutoAnalysis" style="margin-right: 0.5rem;">
                                                自动策略分析
                                            </label>
                                            <span
                                                style="font-size: 0.8rem; color: var(--text-secondary);">每5分钟自动分析</span>
                                        </div>
                                    </div>

                                    <!-- AI策略分析结果 -->
                                    <div v-if="selectedStrategy && strategyAnalysis"
                                        style="margin-top: 1.5rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color);">
                                        <h6 style="margin-bottom: 0.75rem; color: var(--text-primary);">
                                            <i class="fas fa-brain"></i> AI策略分析
                                        </h6>
                                        <div style="font-size: 0.9rem; line-height: 1.5; color: var(--text-primary);">
                                            {{ strategyAnalysis.summary }}
                                        </div>
                                        <div v-if="strategyAnalysis.recommendation"
                                            style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(34, 197, 94, 0.1); border-radius: 6px; border-left: 4px solid #22c55e;">
                                            <strong style="color: #22c55e;">AI建议：</strong> {{
                                            strategyAnalysis.recommendation }}
                                        </div>
                                        <div v-if="strategyAnalysis.riskLevel"
                                            style="margin-top: 0.5rem; font-size: 0.85rem;">
                                            <span style="color: var(--text-secondary);">风险等级：</span>
                                            <span :style="{ color: getRiskLevelColor(strategyAnalysis.riskLevel) }">
                                                {{ getRiskLevelText(strategyAnalysis.riskLevel) }}
                                            </span>
                                        </div>

                                        <!-- 策略信号展示 -->
                                        <div v-if="strategyAnalysis.signals"
                                            style="margin-top: 1rem; padding: 1rem; background: var(--bg-primary); border-radius: 6px;">
                                            <h6
                                                style="margin-bottom: 0.75rem; color: var(--text-primary); font-size: 0.9rem;">
                                                <i class="fas fa-chart-line"></i> 策略信号
                                            </h6>
                                            <div
                                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.75rem;">
                                                <div v-if="selectedStrategy === 'ma_cross'" style="text-align: center;">
                                                    <div
                                                        style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                        均线状态</div>
                                                    <div
                                                        style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">
                                                        {{ strategyAnalysis.signals.goldenCross ? '🟢 金叉' :
                                                        strategyAnalysis.signals.deathCross ? '🔴 死叉' : '⚪ 盘整' }}
                                                    </div>
                                                </div>
                                                <div style="text-align: center;">
                                                    <div
                                                        style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                        RSI</div>
                                                    <div
                                                        style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">
                                                        {{ strategyAnalysis.signals.rsi?.toFixed(1) || '--' }}
                                                    </div>
                                                </div>
                                                <div v-if="selectedStrategy === 'ma_cross'" style="text-align: center;">
                                                    <div
                                                        style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                        趋势强度</div>
                                                    <div
                                                        style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">
                                                        {{ strategyAnalysis.signals.trendStrength?.toFixed(2) || '--'
                                                        }}%
                                                    </div>
                                                </div>
                                                <div v-if="selectedStrategy === 'momentum'" style="text-align: center;">
                                                    <div
                                                        style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                        价格变化</div>
                                                    <div
                                                        style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">
                                                        {{ strategyAnalysis.signals.priceChange?.toFixed(2) || '--' }}%
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <button class="btn btn-primary" @click="makePrediction"
                                    :disabled="predicting || !canPredict" style="margin-top: 2rem;">
                                    <span v-if="predicting" class="loading"></span>
                                    {{ predicting ? '预测中...' : (canPredict ? `开始预测 (剩余${remainingQuota}次)` : '配额已用完') }}
                                </button>

                                <div v-if="!user" style="margin-top: 1rem; color: #dc3545;">
                                    请先登录以使用预测功能
                                </div>
                            </div>

                            <!-- 预测结果展示 -->
                            <div v-if="latestPrediction" style="margin-top: 2rem;">
                                <h4>最新预测结果</h4>

                                <!-- 策略信号概览 -->
                                <div v-if="selectedStrategy && strategySignals"
                                    style="margin-bottom: 1.5rem; padding: 1rem; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-radius: 12px; border: 1px solid rgba(102, 126, 234, 0.2);">
                                    <h5
                                        style="margin-bottom: 1rem; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fas fa-robot"></i> 策略信号概览
                                    </h5>
                                    <div
                                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                                        <div v-if="strategySignals.maCross"
                                            style="text-align: center; padding: 0.75rem; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color);">
                                            <div
                                                style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                                均线交叉策略</div>
                                            <div style="font-size: 1.2rem; font-weight: 700; margin-bottom: 0.25rem;"
                                                :style="{ color: strategySignals.maCross.signal === 'BUY' ? '#22c55e' : strategySignals.maCross.signal === 'SELL' ? '#ef4444' : '#6b7280' }">
                                                {{ strategySignals.maCross.signal }}
                                            </div>
                                            <div style="font-size: 0.8rem; color: var(--text-secondary);">强度: {{
                                                strategySignals.maCross.strength?.toFixed(2) || '--' }}%</div>
                                        </div>
                                        <div v-if="strategySignals.momentum"
                                            style="text-align: center; padding: 0.75rem; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color);">
                                            <div
                                                style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                                动量反弹策略</div>
                                            <div style="font-size: 1.2rem; font-weight: 700; margin-bottom: 0.25rem;"
                                                :style="{ color: strategySignals.momentum.signal === 'BUY' ? '#22c55e' : '#6b7280' }">
                                                {{ strategySignals.momentum.signal }}
                                            </div>
                                            <div style="font-size: 0.8rem; color: var(--text-secondary);">强度: {{
                                                strategySignals.momentum.strength?.toFixed(2) || '--' }}%</div>
                                        </div>
                                    </div>
                                    <div
                                        style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-secondary); text-align: center;">
                                        <i class="fas fa-info-circle"></i> 策略信号与AI预测结果结合，提供更全面的交易参考
                                    </div>
                                </div>

                                <!-- 预测倒计时 -->
                                <div class="prediction-timer" :class="{ 'expired': isPredictionExpired() }">
                                    <div class="timer-header">
                                        <i v-if="isPredictionExpired()"
                                            class="fas fa-exclamation-triangle alert-icon"></i>
                                        预测倒计时
                                    </div>

                                    <div class="timer-display" :class="getTimerDisplayClass()">
                                        {{ formatRemainingTime() }}
                                    </div>

                                    <div class="prediction-status" :class="getPredictionStatusClass()">
                                        <i class="fas" :class="getPredictionStatusIcon()"></i>
                                        {{ getPredictionStatusText() }}
                                    </div>

                                    <div class="timer-info">
                                        <div class="timer-info-item">
                                            <div class="timer-info-label">预测开始</div>
                                            <div class="timer-info-value">{{ formatTime(predictionStartTime) }}</div>
                                            <div class="price-display start-price">
                                                <div class="price-label">{{ getCurrentSymbol() }} 开始价</div>
                                                <div class="price-value">{{ formatPrice(predictionStartPrice) }}</div>
                                            </div>
                                        </div>
                                        <div class="timer-info-item">
                                            <div class="timer-info-label">预测结束</div>
                                            <div class="timer-info-value">{{ formatTime(predictionEndTime) }}</div>
                                            <div class="price-display end-price">
                                                <div class="price-label">{{ getCurrentSymbol() }} 结束价</div>
                                                <div class="price-value" :class="getPriceChangeClass()">
                                                    {{ formatPrice(predictionEndPrice) }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 预测结果显示 - 大气酷炫版本 -->
                                    <div v-if="showPredictionResult && predictionResult" class="prediction-result"
                                        :class="predictionResult.isSuccess ? 'success' : 'failure'">

                                        <!-- 结果头部 -->
                                        <div class="result-header">
                                            <div class="result-main-icon">
                                                {{ predictionResult.isSuccess ? '🎉' : '💥' }}
                                            </div>
                                            <div class="result-main-text">
                                                {{ predictionResult.isSuccess ? 'SUCCESS' : 'FAILED' }}
                                            </div>
                                            <div class="result-sub-text">
                                                {{ predictionResult.message }}
                                            </div>
                                        </div>

                                        <!-- 涨跌符号大气显示 -->
                                        <div class="direction-display">
                                            <div class="direction-item">
                                                <div class="direction-symbol"
                                                    :class="predictionResult.predictedDirection === 'up' ? 'up' : 'down'">
                                                    {{ predictionResult.predictedDirection === 'up' ? '▲' : '▼' }}
                                                </div>
                                                <div class="direction-label">预测方向</div>
                                                <div class="direction-value">
                                                    {{ predictionResult.predictedDirection === 'up' ? '上涨' : '下跌' }}
                                                </div>
                                            </div>

                                            <div class="direction-item">
                                                <div class="direction-symbol"
                                                    :class="predictionResult.actualDirection === 'up' ? 'up' : 'down'">
                                                    {{ predictionResult.actualDirection === 'up' ? '▲' : '▼' }}
                                                </div>
                                                <div class="direction-label">实际方向</div>
                                                <div class="direction-value">
                                                    {{ predictionResult.actualDirection === 'up' ? '上涨' : '下跌' }}
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 统计数据 -->
                                        <div class="result-stats">
                                            <div class="result-stat-item">
                                                <div class="result-stat-label">预测概率</div>
                                                <div class="result-stat-value">{{ predictionResult.probability }}%</div>
                                            </div>
                                            <div class="result-stat-item">
                                                <div class="result-stat-label">置信度</div>
                                                <div class="result-stat-value">{{ predictionResult.confidence }}%</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 策略整合分析 -->
                                <div v-if="selectedStrategy && strategyAnalysis"
                                    style="margin-top: 1.5rem; padding: 1.5rem; background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05)); border-radius: 12px; border: 1px solid rgba(102, 126, 234, 0.2);">
                                    <h5
                                        style="margin-bottom: 1rem; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fas fa-link"></i> 策略与预测整合分析
                                    </h5>
                                    <div
                                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                                        <div
                                            style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color);">
                                            <div
                                                style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                                策略信号</div>
                                            <div
                                                style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">
                                                {{ getStrategySignalText() }}
                                            </div>
                                        </div>
                                        <div
                                            style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color);">
                                            <div
                                                style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                                AI预测</div>
                                            <div
                                                style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">
                                                {{ getPredictionSummary() }}
                                            </div>
                                        </div>
                                        <div
                                            style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color);">
                                            <div
                                                style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                                综合建议</div>
                                            <div
                                                style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">
                                                {{ getCombinedRecommendation() }}
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        style="font-size: 0.9rem; color: var(--text-secondary); text-align: center; padding: 1rem; background: var(--bg-primary); border-radius: 8px;">
                                        <i class="fas fa-lightbulb"></i> {{ getStrategyInsight() }}
                                    </div>
                                </div>

                                <div class="prediction-grid" style="margin-top: 1rem;">
                                    <div v-for="(prediction, timeframe) in latestPrediction" :key="timeframe"
                                        class="prediction-item"
                                        style="background: white; color: #333; border: 1px solid #ddd;">
                                        <div class="timeframe">{{ timeframe }}</div>
                                        <div class="direction" :class="prediction.direction">
                                            {{ prediction.direction === 'up' ? '↗' : prediction.direction === 'down' ?
                                            '↘' : '→' }}
                                        </div>
                                        <div class="probability">{{ prediction.probability?.toFixed(1) }}%</div>
                                        <div style="font-size: 0.8rem; margin-top: 0.5rem;">
                                            置信度: {{ (prediction.confidence * 100).toFixed(1) }}%
                                        </div>
                                    </div>
                                </div>

                                <div v-if="latestPrediction['1h']?.reasoning"
                                    style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                                    <h5>分析说明：</h5>
                                    <p>{{ latestPrediction['1h'].reasoning }}</p>
                                </div>

                                <!-- 预测统计 -->
                                <div class="prediction-stats">
                                    <div class="stats-header">
                                        <div class="stats-title">
                                            <i class="fas fa-chart-bar"></i>
                                            预测准确率统计
                                        </div>
                                        <div class="realtime-badge">
                                            <i class="fas fa-circle"></i>
                                            实时数据
                                        </div>
                                    </div>

                                    <!-- 总体准确率 -->
                                    <div class="accuracy-display">
                                        <div class="accuracy-main" :class="getAccuracyClass(predictionStats.accuracy)">
                                            {{ predictionStats.accuracy.toFixed(1) }}%
                                        </div>
                                        <div class="accuracy-label">总体预测准确率</div>
                                        <div class="accuracy-trend" :class="accuracyTrend">
                                            <i class="fas" :class="getTrendIcon()"></i>
                                            {{ getTrendText() }}
                                        </div>
                                    </div>

                                    <!-- 统计数据网格 -->
                                    <div class="stats-grid">
                                        <div class="stat-item">
                                            <div class="stat-value">{{ predictionStats.totalPredictions }}</div>
                                            <div class="stat-label">总预测次数</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value">{{ predictionStats.correctPredictions }}</div>
                                            <div class="stat-label">预测成功</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value">{{ predictionStats.todayStats.accuracy.toFixed(1)
                                                }}%</div>
                                            <div class="stat-label">今日准确率</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value">{{ predictionStats.weeklyStats.accuracy.toFixed(1)
                                                }}%</div>
                                            <div class="stat-label">本周准确率</div>
                                        </div>
                                    </div>

                                    <!-- 时间框架统计 -->
                                    <div style="margin-top: 1rem;">
                                        <div
                                            style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem; text-align: center;">
                                            各时间框架准确率
                                        </div>
                                        <div class="timeframe-stats">
                                            <div v-for="(stats, timeframe) in predictionStats.timeframeStats"
                                                :key="timeframe" class="timeframe-stat">
                                                <div class="timeframe-stat-value"
                                                    :style="{ color: getAccuracyColor(stats.accuracy) }">
                                                    {{ stats.accuracy.toFixed(1) }}%
                                                </div>
                                                <div class="timeframe-stat-label">{{ timeframe }}</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 复投机制 -->
                                <div class="martingale-system" style="margin-top: 2rem;">
                                    <div class="stats-header">
                                        <div class="stats-title">
                                            <i class="fas fa-calculator"></i>
                                            智能复投系统
                                        </div>
                                        <div class="martingale-controls">
                                            <button @click="calculator.visible = !calculator.visible"
                                                class="btn btn-secondary btn-sm">
                                                <i class="fas fa-calculator"></i> 计算器
                                            </button>
                                            <button @click="resetMartingale" class="btn btn-warning btn-sm">
                                                <i class="fas fa-redo"></i> 重置
                                            </button>
                                            <button @click="resetMartingaleCompletely()" class="btn btn-danger btn-sm">
                                                <i class="fas fa-trash"></i> 完全重置
                                            </button>
                                            <button @click="debugMartingaleStatus()" class="btn btn-info btn-sm">
                                                <i class="fas fa-bug"></i> 调试
                                            </button>
                                        </div>
                                    </div>

                                    <!-- 复投设置 -->
                                    <div class="martingale-settings">
                                        <div class="setting-row">
                                            <div class="setting-item">
                                                <label>起始金额 (U)</label>
                                                <input type="number" v-model.number="martingaleSettings.baseAmount"
                                                    min="0.1" step="0.1" class="form-control-sm">
                                            </div>
                                            <div class="setting-item">
                                                <label>倍投倍数</label>
                                                <input type="number" v-model.number="martingaleSettings.multiplier"
                                                    min="2" max="10" step="0.1" class="form-control-sm">
                                            </div>
                                            <div class="setting-item">
                                                <label>最大轮数</label>
                                                <input type="number" v-model.number="martingaleSettings.maxRounds"
                                                    min="1" max="10" class="form-control-sm">
                                            </div>
                                            <div class="setting-item">
                                                <label style="display: flex; align-items: center;">
                                                    <input type="checkbox" v-model="martingaleSettings.isActive"
                                                        style="margin-right: 0.5rem;">
                                                    启用复投
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 预测结果同步状态 -->
                                    <div v-if="martingaleSettings.isActive" class="martingale-sync-status">
                                        <div class="sync-status-header">
                                            <div class="sync-status-indicator" :class="getMartingaleStatusClass()">
                                                <i class="fas" :class="getMartingaleStatusIcon()"></i>
                                                <span>{{ getMartingaleStatusText() }}</span>
                                            </div>
                                            <div v-if="martingaleSettings.lastResult" class="last-result">
                                                最新预测：{{ martingaleSettings.lastResult === 'success' ? '✅ 成功' : '❌ 失败' }}
                                            </div>
                                        </div>

                                        <!-- 复投进度条 -->
                                        <div class="martingale-progress">
                                            <div class="progress-header">
                                                <span>复投进度</span>
                                                <span>{{ martingaleSettings.currentRound }}/{{
                                                    martingaleSettings.maxRounds }}</span>
                                            </div>
                                            <div class="progress-bar">
                                                <div class="progress-fill"
                                                    :style="{ width: (martingaleSettings.currentRound / martingaleSettings.maxRounds * 100) + '%' }">
                                                </div>
                                            </div>
                                            <div class="progress-steps">
                                                <div v-for="round in martingaleSettings.maxRounds" :key="round"
                                                    class="progress-step" :class="getStepClass(round)">
                                                    {{ round }}
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 下一轮预览 -->
                                        <div v-if="martingaleSettings.status === 'failed' && martingaleSettings.currentRound < martingaleSettings.maxRounds"
                                            class="next-round-preview">
                                            <div class="preview-header">
                                                <i class="fas fa-arrow-right"></i>
                                                下一轮复投预览
                                            </div>
                                            <div class="preview-content">
                                                <div class="preview-item highlight">
                                                    <span>投注金额：</span>
                                                    <strong>{{ martingaleSettings.nextRoundAmount.toFixed(1)
                                                        }}U</strong>
                                                </div>
                                                <div class="preview-item">
                                                    <span>倍数：</span>
                                                    <strong>{{ martingaleSettings.currentMultiplier }}倍</strong>
                                                </div>
                                                <div class="preview-item">
                                                    <span>轮次：</span>
                                                    <strong>第{{ martingaleSettings.currentRound + 1 }}轮</strong>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 当前状态 -->
                                    <div class="martingale-status">
                                        <div class="status-grid">
                                            <div class="status-item"
                                                :class="{ 'highlight': martingaleSettings.status === 'betting' }">
                                                <div class="status-value">{{ martingaleSettings.currentRound }}</div>
                                                <div class="status-label">当前轮数</div>
                                            </div>
                                            <div class="status-item"
                                                :class="{ 'highlight': martingaleSettings.status === 'betting' }">
                                                <div class="status-value">{{ getCurrentBetDisplay() }}</div>
                                                <div class="status-label">当前投注</div>
                                            </div>
                                            <div class="status-item">
                                                <div class="status-value">{{ martingaleSettings.totalInvested.toFixed(1)
                                                    }}U</div>
                                                <div class="status-label">总投入</div>
                                            </div>
                                            <div class="status-item">
                                                <div class="status-value"
                                                    :class="martingaleSettings.totalProfit >= 0 ? 'profit' : 'loss'">
                                                    {{ martingaleSettings.totalProfit >= 0 ? '+' : '' }}{{
                                                    martingaleSettings.totalProfit.toFixed(1) }}U
                                                </div>
                                                <div class="status-label">总盈亏</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 会员中心视图 -->
                <div v-if="currentView === 'membership'" class="membership-center">
                    <div v-if="!user" style="text-align: center; margin: 4rem 0;">
                        <h3>请先登录查看会员信息</h3>
                        <button class="btn btn-primary" @click="showLoginModal = true" style="margin-top: 1rem;">
                            立即登录
                        </button>
                    </div>

                    <div v-if="user">
                        <!-- 用户状态卡片 -->
                        <div class="user-status-card">
                            <div class="membership-info">
                                <h3>{{ getMembershipName(user.membership_level) }}</h3>
                                <div class="quota-info">
                                    <div class="quota-circle">
                                        <div class="quota-text">
                                            <div style="font-size: 1.2rem;">{{ remainingQuota }}</div>
                                            <div style="font-size: 0.8rem;">剩余次数</div>
                                        </div>
                                    </div>
                                    <div>
                                        <p>今日预测配额</p>
                                        <p style="font-size: 0.9rem; opacity: 0.8;">会员等级：{{
                                            getMembershipName(user.membership_level) }}</p>
                                    </div>
                                </div>
                            </div>

                            <div v-if="user.membership_level === 'trial'" class="trial-info">
                                <p>试用期剩余时间</p>
                                <p style="font-size: 1.2rem; font-weight: bold;">{{ getTrialTimeLeft() }}</p>
                                <button class="btn btn-outline" @click="showUpgradeModal = true"
                                    style="margin-top: 1rem;">
                                    立即升级
                                </button>
                            </div>
                        </div>

                        <!-- 套餐选择 -->
                        <div class="plans-section">
                            <h3>选择适合您的套餐</h3>
                            <div class="plans-grid">
                                <div v-for="plan in membershipPlans" :key="plan.type" class="plan-card"
                                    :class="{ recommended: plan.recommended }" @click="selectPlan(plan)">
                                    <div class="plan-header">
                                        <h4>{{ plan.name }}</h4>
                                        <div class="price">
                                            <span class="amount">¥{{ plan.price }}</span>
                                            <span class="period">/月</span>
                                        </div>
                                    </div>

                                    <ul class="features">
                                        <li v-for="feature in plan.features" :key="feature">
                                            {{ feature }}
                                        </li>
                                    </ul>

                                    <button class="btn" :class="plan.recommended ? 'btn-primary' : 'btn-outline'">
                                        {{ plan.buttonText }}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 交易详情页视图 -->
                <div v-if="currentView === 'trading'" class="trading-detail">
                    <!-- 顶部导航 -->
                    <div class="trading-header">
                        <div class="trading-header-left">
                            <button class="back-btn" @click="backToDashboard">
                                <i class="fas fa-arrow-left"></i>
                            </button>
                            <span class="trading-symbol">{{ selectedTradingSymbol?.symbol || 'BTC/USDT' }}</span>
                        </div>
                        <button class="trading-favorite" :class="{ 'active': selectedTradingSymbol?.isFavorite }"
                            @click="toggleTradingFavorite">
                            <i class="fas fa-star"></i>
                        </button>
                    </div>

                    <!-- 价格信息区域 -->
                    <div class="trading-price-section">
                        <div class="trading-main-price">
                            {{ formatTradingPrice(selectedTradingSymbol?.price || 0) }}
                        </div>
                        <div class="trading-price-info">
                            <span class="trading-usd-price">
                                ≈ ${{ formatTradingPrice(selectedTradingSymbol?.price || 0) }}
                            </span>
                            <span class="trading-change"
                                :class="(selectedTradingSymbol?.changePercent || 0) >= 0 ? 'positive' : 'negative'">
                                {{ (selectedTradingSymbol?.changePercent || 0) >= 0 ? '+' : '' }}{{
                                (selectedTradingSymbol?.changePercent || 0).toFixed(2) }}%
                            </span>
                        </div>

                        <div class="trading-stats">
                            <div class="trading-stat-group">
                                <div class="trading-stat-item">
                                    <span class="trading-stat-label">24H 高</span>
                                    <span class="trading-stat-value">{{ formatTradingPrice(getTradingHigh()) }}</span>
                                </div>
                                <div class="trading-stat-item">
                                    <span class="trading-stat-label">24H 低</span>
                                    <span class="trading-stat-value">{{ formatTradingPrice(getTradingLow()) }}</span>
                                </div>
                            </div>
                            <div class="trading-stat-group">
                                <div class="trading-stat-item">
                                    <span class="trading-stat-label">24H 量</span>
                                    <span class="trading-stat-value">{{ formatVolume(selectedTradingSymbol?.volume || 0)
                                        }}</span>
                                </div>
                                <div class="trading-stat-item">
                                    <span class="trading-stat-label">成交额</span>
                                    <span class="trading-stat-value">${{ formatVolume(selectedTradingSymbol?.volumeUsd
                                        || 0) }}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 简洁的K线图表区域 -->
                    <div class="trading-chart-container">
                        <!-- 图表头部控制区 -->
                        <div class="trading-chart-header">
                            <div class="trading-chart-controls">
                                <div class="chart-title">
                                    <h3 style="margin: 0; font-size: 1.1rem;">{{ selectedTradingSymbol?.symbol ||
                                        'BTC/USDT' }}</h3>
                                    <span style="font-size: 0.85rem; color: var(--text-secondary);">价格走势</span>
                                </div>
                                <!-- 时间周期选择 -->
                                <div class="timeframe-buttons">
                                    <button v-for="timeframe in tradingTimeframes" :key="timeframe"
                                        class="timeframe-btn" :class="{ 'active': tradingTimeframe === timeframe }"
                                        @click="changeTradingTimeframe(timeframe)">
                                        {{ timeframe }}
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- 图表主体 -->
                        <div class="chart-body">
                            <div id="trading-chart" class="trading-chart" v-if="selectedTradingSymbol"
                                style="height: 400px;"></div>
                            <div v-else class="chart-loading">
                                正在加载图表数据...
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- 登录模态框 -->
            <div v-if="showLoginModal" class="modal-overlay" @click="showLoginModal = false">
                <div class="modal-content" @click.stop>
                    <div class="modal-header">
                        <h3>{{ isRegister ? '用户注册' : '用户登录' }}</h3>
                        <button @click="showLoginModal = false" class="close-btn">&times;</button>
                    </div>

                    <div class="modal-body">
                        <form @submit.prevent="isRegister ? register() : login()">
                            <div v-if="isRegister" class="form-group">
                                <label>用户名：</label>
                                <input type="text" v-model="registerForm.username" required>
                            </div>

                            <div class="form-group">
                                <label>邮箱：</label>
                                <input type="email" v-model="currentForm.email" required>
                            </div>

                            <div class="form-group">
                                <label>密码：</label>
                                <input type="password" v-model="currentForm.password" required>
                            </div>

                            <!-- 记住登录信息选项 (仅登录时显示) -->
                            <div v-if="!isRegister" class="form-group" style="margin-top: 1rem;">
                                <label class="remember-login-label">
                                    <input type="checkbox" v-model="rememberLogin" class="remember-login-checkbox"
                                        style="margin-right: 0.5rem;">
                                    <span>记住登录信息</span>
                                </label>
                                <div
                                    style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.25rem; margin-left: 1.5rem;">
                                    下次登录时自动填充账号密码
                                </div>
                            </div>

                            <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
                                {{ isRegister ? '注册' : '登录' }}
                            </button>
                        </form>

                        <div style="text-align: center; margin-top: 1rem;">
                            <a href="#" @click="isRegister = !isRegister">
                                {{ isRegister ? '已有账号？立即登录' : '没有账号？立即注册' }}
                            </a>
                        </div>

                        <!-- 清除保存信息选项 (仅登录时显示且有保存信息时) -->
                        <div v-if="!isRegister && rememberLogin" style="text-align: center; margin-top: 0.5rem;">
                            <a href="#" @click="clearSavedLoginInfo()"
                                style="font-size: 0.8rem; color: var(--text-secondary); text-decoration: none;">
                                清除保存的登录信息
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 复投计算器弹窗 -->
            <div v-if="calculator.visible" class="calculator-modal" @click="calculator.visible = false">
                <div class="calculator-content" @click.stop>
                    <div class="calculator-header">
                        <h4><i class="fas fa-calculator"></i> 复投计算器</h4>
                        <button @click="calculator.visible = false" class="close-btn">&times;</button>
                    </div>
                    <div class="calculator-body">
                        <div class="calc-inputs">
                            <div class="calc-input-group">
                                <label>起始金额 (U)</label>
                                <input type="number" v-model.number="calculator.baseAmount" min="0.1" step="0.1"
                                    @input="calculateMartingale" class="form-control">
                            </div>
                            <div class="calc-input-group">
                                <label>倍投倍数</label>
                                <input type="number" v-model.number="calculator.multiplier" min="2" max="10" step="0.1"
                                    @input="calculateMartingale" class="form-control">
                            </div>
                            <div class="calc-input-group">
                                <label>计算轮数</label>
                                <input type="number" v-model.number="calculator.rounds" min="1" max="10"
                                    @input="calculateMartingale" class="form-control">
                            </div>
                        </div>
                        <div class="calc-results">
                            <div class="calc-summary">
                                <div class="summary-item">
                                    <span>最大投入：</span>
                                    <strong>{{ getMaxInvestment() }}U</strong>
                                </div>
                                <div class="summary-item">
                                    <span>最差情况：</span>
                                    <strong class="loss">{{ getWorstCaseProfit() }}U</strong>
                                </div>
                                <div class="summary-item">
                                    <span>最佳情况：</span>
                                    <strong class="profit">{{ getBestCaseProfit() }}U</strong>
                                </div>
                            </div>
                            <div class="calc-table">
                                <div class="calc-table-header">
                                    <div>轮数</div>
                                    <div>投注金额</div>
                                    <div>累计投入</div>
                                    <div>获得回报</div>
                                    <div>净盈利</div>
                                    <div>盈利率</div>
                                </div>
                                <div v-for="result in calculator.results" :key="result.round" class="calc-table-row">
                                    <div>第{{ result.round }}轮</div>
                                    <div>{{ result.amount.toFixed(1) }}U</div>
                                    <div>{{ result.totalInvested.toFixed(1) }}U</div>
                                    <div class="return">{{ result.totalReturn.toFixed(1) }}U</div>
                                    <div class="profit" :class="result.profit >= 0 ? 'positive' : 'negative'">
                                        {{ result.profit >= 0 ? '+' : '' }}{{ result.profit.toFixed(1) }}U
                                    </div>
                                    <div class="profit-rate" :class="result.profit >= 0 ? 'positive' : 'negative'">
                                        {{ result.profitRate.toFixed(1) }}%
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="calc-actions">
                            <button @click="applyCalculatorSettings" class="btn btn-primary">
                                <i class="fas fa-check"></i> 应用设置
                            </button>
                            <button @click="calculator.visible = false" class="btn btn-secondary">
                                <i class="fas fa-times"></i> 关闭
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- JavaScript库 -->
        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <!-- TradingView 图表库 - 多个CDN备用链接 -->
        <script
            src="https://cdn.jsdelivr.net/npm/lightweight-charts@4.1.3/dist/lightweight-charts.standalone.production.js"
            onerror="this.onerror=null; this.src='https://unpkg.com/lightweight-charts@4.1.3/dist/lightweight-charts.standalone.production.js'"></script>

        <script>
            const { createApp } = Vue;

            createApp({
                data() {
                    return {
                        // 应用状态
                        currentView: 'dashboard',
                        connectionStatus: 'disconnected',
                        isDarkMode: false,

                        // 用户相关
                        user: null,
                        showLoginModal: false,
                        isRegister: false,
                        loginForm: { email: '', password: '' },
                        registerForm: { username: '', email: '', password: '' },
                        rememberLogin: false, // 记住登录信息选项

                        // 图表相关
                        chartUpdateTimeout: null, // 图表更新定时器

                        // 复投机制相关
                        martingaleSettings: {
                            baseAmount: 1, // 起始金额(U)
                            multiplier: 3, // 倍投倍数
                            maxRounds: 7, // 最大复投轮数
                            currentRound: 0, // 当前轮数
                            currentAmount: 1, // 当前投注金额
                            totalInvested: 0, // 总投入
                            totalProfit: 0, // 总盈利
                            consecutiveLosses: 0, // 连续失败次数
                            isActive: false, // 是否启用复投
                            history: [], // 复投历史记录
                            status: 'waiting', // 当前状态: waiting/success/failed/betting
                            lastResult: null, // 最后一次预测结果
                            nextRoundAmount: 1, // 下一轮投注金额
                            currentMultiplier: 1, // 当前倍数
                            isInProgress: false // 是否正在复投中
                        },

                        // 计算器相关
                        calculator: {
                            visible: false, // 计算器显示状态
                            baseAmount: 1,
                            multiplier: 3,
                            rounds: 7,
                            results: [] // 计算结果
                        },

                        // 市场数据
                        selectedSymbol: 'BTCUSDT',
                        selectedExchange: 'binance', // 默认选择币安作为参照
                        chartInterval: '1h',
                        marketData: {},

                        // 行情表相关
                        tickers: [],
                        filteredTickers: [],
                        tickerFilter: 'all',
                        tickerSearchQuery: '', // 搜索关键词
                        tickerSort: { field: 'volume', direction: 'desc' },
                        tickersLoading: false,
                        tickerRefreshing: false,
                        favoriteSymbols: JSON.parse(localStorage.getItem('favoriteSymbols') || '[]'),

                        // 交易详情页相关
                        selectedTradingSymbol: null,
                        tradingTimeframe: '1分',
                        tradingChart: null,
                        tradingTimeframes: ['分时', '1分', '5分', '1小时', '4小时', '更多', '指标', '深度'],

                        // 交易所配置
                        exchanges: [
                            { id: 'binance', name: '币安 Binance', icon: 'B', color: '#f3ba2f' },
                            { id: 'okx', name: 'OKX', icon: 'O', color: '#0052ff' },
                            { id: 'bybit', name: 'Bybit', icon: 'By', color: '#f7a600' },
                            { id: 'coinbase', name: 'Coinbase Pro', icon: 'C', color: '#0052ff' },
                            { id: 'kraken', name: 'Kraken', icon: 'K', color: '#5741d9' }
                        ],

                        // 预测相关
                        predictionSymbol: 'BTCUSDT',
                        selectedTimeframes: ['1m', '5m', '15m', '1h'],
                        predictionData: {},
                        latestPrediction: null,
                        predicting: false,
                        remainingQuota: 50,

                        // 预测倒计时相关
                        predictionTimer: null,
                        predictionStartTime: null,
                        predictionEndTime: null,
                        predictionStartPrice: null, // 预测开始时的币价
                        predictionEndPrice: null,   // 预测结束时的币价
                        currentTime: Date.now(),
                        timerInterval: null,

                        // 预测统计相关
                        predictionStats: {
                            totalPredictions: 0,
                            correctPredictions: 0,
                            accuracy: 0,
                            todayStats: {
                                total: 0,
                                correct: 0,
                                accuracy: 0
                            },
                            weeklyStats: {
                                total: 0,
                                correct: 0,
                                accuracy: 0
                            },
                            timeframeStats: {
                                '1m': { total: 0, correct: 0, accuracy: 0 },
                                '5m': { total: 0, correct: 0, accuracy: 0 },
                                '15m': { total: 0, correct: 0, accuracy: 0 },
                                '1h': { total: 0, correct: 0, accuracy: 0 }
                            }
                        },
                        predictionHistory: JSON.parse(localStorage.getItem('predictionHistory') || '[]'),
                        realtimeAccuracy: 0,
                        accuracyTrend: 'stable', // 'up', 'down', 'stable'

                        // 预测结果相关
                        predictionResult: null, // 存储预测结果信息
                        showPredictionResult: false,
                        currentPredictionData: null, // 当前预测的详细数据

                        // WebSocket
                        websocket: null,
                        mockDataInterval: null,
                        realDataInterval: null, // 真实数据更新定时器
                        dataSource: 'loading', // 数据源状态: 'loading', 'real', 'mock'

                        // 会员套餐
                        membershipPlans: [
                            {
                                type: 'basic',
                                name: '基础版',
                                price: 99,
                                features: ['200次/日预测', '基础技术指标', '7x24小时服务'],
                                buttonText: '选择基础版',
                                recommended: false
                            },
                            {
                                type: 'pro',
                                name: '专业版',
                                price: 299,
                                features: ['500次/日预测', '全部技术指标', '高级市场分析', '优先客服'],
                                buttonText: '选择专业版',
                                recommended: true
                            },
                            {
                                type: 'premium',
                                name: '旗舰版',
                                price: 599,
                                features: ['无限次预测', '全部功能', '专属客服', 'API接口'],
                                buttonText: '选择旗舰版',
                                recommended: false
                            }
                        ],

                        // 交易策略相关
                        selectedStrategy: null,
                        strategyParams: {
                            maCross: {
                                shortPeriod: 5,
                                longPeriod: 20,
                                rsiThreshold: 50
                            },
                            momentum: {
                                oversoldRsi: 30,
                                dropThreshold: 10,
                                confirmationDays: 3
                            }
                        },
                        strategyAnalysis: null,
                        strategySignals: {
                            maCross: null,
                            momentum: null
                        },
                        autoAnalysisInterval: null,
                        autoStrategyAnalysis: false
                    }
                },

                computed: {
                    canPredict() {
                        return this.user && this.remainingQuota > 0;
                    },
                    currentForm() {
                        return this.isRegister ? this.registerForm : this.loginForm;
                    }
                },

                async mounted() {
                    this.initWebSocket();
                    this.checkAuthStatus();

                    // 优先尝试获取真实数据，失败则使用模拟数据
                    const realDataSuccess = await this.fetchRealMarketData();
                    if (!realDataSuccess) {
                        this.generateMockData();
                    }

                    this.generateTickerData();
                    this.initTheme();
                    this.startTimeUpdater();
                    this.initPredictionStats();
                    this.loadSavedLoginInfo();
                    this.loadMartingaleData();

                    // 初始化策略相关功能
                    this.initStrategyFeatures();

                    // 启动定期更新真实数据
                    this.startRealDataUpdates();

                    // 添加窗口大小变化监听器（移动端优化）
                    window.addEventListener('resize', this.handleChartResize);
                    window.addEventListener('orientationchange', () => {
                        setTimeout(this.handleChartResize, 100);
                    });
                },

                beforeUnmount() {
                    // 清理事件监听器
                    window.removeEventListener('resize', this.handleChartResize);

                    // 清理图表更新定时器
                    if (this.chartUpdateTimeout) {
                        clearTimeout(this.chartUpdateTimeout);
                    }
                },

                methods: {
                    // WebSocket连接
                    initWebSocket() {
                        // 首先启动模拟数据，确保页面有数据显示
                        this.startMockDataUpdates();

                        try {
                            this.websocket = new WebSocket('ws://localhost:8000/ws');

                            this.websocket.onopen = () => {
                                this.connectionStatus = 'connected';
                                console.log('WebSocket connected - 切换到实时数据');
                                // 连接成功后停止模拟数据，使用实时数据
                                this.stopMockDataUpdates();
                            };

                            this.websocket.onmessage = (event) => {
                                const message = JSON.parse(event.data);
                                this.handleWebSocketMessage(message);
                            };

                            this.websocket.onclose = () => {
                                this.connectionStatus = 'disconnected';
                                console.log('WebSocket disconnected - 切换到模拟数据');

                                // 连接断开时重新启动模拟数据
                                this.startMockDataUpdates();

                                // 重连机制（减少重连频率）
                                setTimeout(() => {
                                    this.initWebSocket();
                                }, 10000); // 10秒后重连
                            };

                            this.websocket.onerror = (error) => {
                                console.log('WebSocket连接失败，使用离线模式');
                                this.connectionStatus = 'disconnected';
                                // 确保模拟数据在运行
                                this.startMockDataUpdates();
                            };

                        } catch (error) {
                            console.log('WebSocket初始化失败，使用离线模式');
                            this.connectionStatus = 'disconnected';
                            // 确保模拟数据在运行
                            this.startMockDataUpdates();
                        }
                    },

                    handleWebSocketMessage(message) {
                        switch (message.type) {
                            case 'initial_data':
                                this.marketData = message.data;
                                break;

                            case 'market_update':
                                const data = message.data;
                                if (!this.marketData[data.symbol]) {
                                    this.$set(this.marketData, data.symbol, {});
                                }
                                this.$set(this.marketData[data.symbol], data.exchange, data);
                                break;

                            case 'prediction_update':
                                this.predictionData = message.data;
                                break;
                        }
                    },

                    // 获取真实市场数据
                    async fetchRealMarketData() {
                        try {
                            // 使用币安API获取实时价格
                            const response = await fetch('https://api.binance.com/api/v3/ticker/24hr');
                            const data = await response.json();

                            // 更新市场数据
                            const exchanges = ['binance', 'okx', 'bybit'];

                            data.forEach(ticker => {
                                const symbol = ticker.symbol;
                                if (!this.marketData[symbol]) {
                                    this.marketData[symbol] = {};
                                }

                                // 为每个交易所生成略有差异的价格（模拟不同交易所的价差）
                                exchanges.forEach(exchange => {
                                    const basePrice = parseFloat(ticker.lastPrice);
                                    const variation = exchange === 'binance' ? 0 : (Math.random() - 0.5) * 0.005; // ±0.25%

                                    this.marketData[symbol][exchange] = {
                                        symbol,
                                        exchange,
                                        price: basePrice * (1 + variation),
                                        volume_24h: parseFloat(ticker.volume),
                                        change_percent_24h: parseFloat(ticker.priceChangePercent),
                                        high_24h: parseFloat(ticker.highPrice),
                                        low_24h: parseFloat(ticker.lowPrice),
                                        funding_rate: (Math.random() - 0.5) * 0.002,
                                        timestamp: Date.now()
                                    };
                                });
                            });

                            console.log('✅ 实时市场数据更新成功');
                            this.dataSource = 'real';
                            return true;
                        } catch (error) {
                            console.error('❌ 获取实时数据失败，使用模拟数据:', error);
                            this.dataSource = 'mock';
                            this.generateMockData();
                            return false;
                        }
                    },

                    // 生成模拟数据（备用方案）
                    generateMockData() {
                        const symbols = [
                            // 主流币种
                            'BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'ADAUSDT', 'XRPUSDT', 'SOLUSDT', 'DOTUSDT', 'LINKUSDT',
                            // 热门币种
                            'AVAXUSDT', 'DOGEUSDT', 'MATICUSDT', 'ATOMUSDT', 'LTCUSDT', 'UNIUSDT', 'ALGOUSDT', 'VETUSDT',
                            // 新兴币种
                            'FTMUSDT', 'SANDUSDT', 'MANAUSDT', 'AXSUSDT', 'CHZUSDT', 'ENJUSDT', 'GALAUSDT', 'IMXUSDT',
                            // DeFi币种
                            'AAVEUSDT', 'COMPUSDT', 'MKRUSDT', 'SUSHIUSDT', 'CRVUSDT', '1INCHUSDT', 'YFIUSDT', 'SNXUSDT'
                        ];
                        const exchanges = ['binance', 'okx', 'bybit'];
                        const basePrices = {
                            // 主流币种价格 (2024年12月最新价格)
                            'BTCUSDT': 110000.00, 'ETHUSDT': 4200.00, 'BNBUSDT': 720.00, 'ADAUSDT': 1.15,
                            'XRPUSDT': 2.45, 'SOLUSDT': 245.00, 'DOTUSDT': 8.50, 'LINKUSDT': 28.50,
                            // 热门币种价格
                            'AVAXUSDT': 52.00, 'DOGEUSDT': 0.42, 'MATICUSDT': 0.58, 'ATOMUSDT': 9.80,
                            'LTCUSDT': 125.00, 'UNIUSDT': 15.50, 'ALGOUSDT': 0.35, 'VETUSDT': 0.055,
                            // 新兴币种价格
                            'FTMUSDT': 0.85, 'SANDUSDT': 0.68, 'MANAUSDT': 0.52, 'AXSUSDT': 12.50,
                            'CHZUSDT': 0.095, 'ENJUSDT': 0.28, 'GALAUSDT': 0.045, 'IMXUSDT': 1.85,
                            // DeFi币种价格
                            'AAVEUSDT': 380.00, 'COMPUSDT': 85.00, 'MKRUSDT': 1650.00, 'SUSHIUSDT': 1.45,
                            'CRVUSDT': 1.25, '1INCHUSDT': 0.52, 'YFIUSDT': 8500.00, 'SNXUSDT': 3.20
                        };

                        symbols.forEach(symbol => {
                            this.marketData[symbol] = {};
                            exchanges.forEach(exchange => {
                                const basePrice = basePrices[symbol];
                                const variation = (Math.random() - 0.5) * 0.02; // ±1%

                                this.marketData[symbol][exchange] = {
                                    symbol,
                                    exchange,
                                    price: basePrice * (1 + variation),
                                    volume_24h: Math.random() * 50000 + 10000,
                                    change_percent_24h: (Math.random() - 0.5) * 10,
                                    high_24h: basePrice * 1.05,
                                    low_24h: basePrice * 0.95,
                                    funding_rate: (Math.random() - 0.5) * 0.002,
                                    timestamp: Date.now()
                                };
                            });
                        });
                    },

                    startMockDataUpdates() {
                        // 避免重复启动
                        if (this.mockDataInterval) {
                            return;
                        }

                        console.log('启动模拟数据更新');
                        this.mockDataInterval = setInterval(() => {
                            this.generateMockData();
                            this.updateTickerData();
                        }, 3000);
                    },

                    stopMockDataUpdates() {
                        if (this.mockDataInterval) {
                            console.log('停止模拟数据更新');
                            clearInterval(this.mockDataInterval);
                            this.mockDataInterval = null;
                        }
                    },

                    // 启动真实数据更新
                    startRealDataUpdates() {
                        if (this.realDataInterval) {
                            return;
                        }

                        console.log('启动真实数据更新');
                        this.realDataInterval = setInterval(async () => {
                            const success = await this.fetchRealMarketData();
                            if (success) {
                                this.updateTickerData();
                            }
                        }, 30000); // 每30秒更新一次真实数据
                    },

                    stopRealDataUpdates() {
                        if (this.realDataInterval) {
                            clearInterval(this.realDataInterval);
                            this.realDataInterval = null;
                            console.log('停止真实数据更新');
                        }
                    },

                    // 用户认证
                    async login() {
                        try {
                            const response = await axios.post('http://localhost:8000/api/auth/login', this.currentForm);
                            this.user = response.data.user;
                            localStorage.setItem('token', response.data.access_token);
                            this.showLoginModal = false;
                            this.updateUserQuota();

                            // 保存登录信息（如果用户选择记住）
                            this.saveLoginInfo();

                            // 显示成功消息
                            this.showMessage('登录成功！', 'success');
                        } catch (error) {
                            console.log('登录API调用失败，使用演示模式');

                            // 检查是否是演示账号
                            if (this.currentForm.email === 'demo@example.com' && this.currentForm.password === 'demo123') {
                                // 演示账号登录成功
                                this.user = {
                                    id: 1,
                                    username: 'Demo User',
                                    email: 'demo@example.com',
                                    membership_level: 'trial'
                                };
                                this.showLoginModal = false;
                                this.remainingQuota = 45;

                                // 保存登录信息（如果用户选择记住）
                                this.saveLoginInfo();

                                this.showMessage('演示账号登录成功！', 'success');
                            } else {
                                this.showMessage('登录失败：服务器连接异常，请使用演示账号 demo@example.com / demo123', 'error');
                            }
                        }
                    },

                    async register() {
                        try {
                            const response = await axios.post('http://localhost:8000/api/auth/register', this.currentForm);
                            this.user = response.data.user;
                            localStorage.setItem('token', response.data.access_token);
                            this.showLoginModal = false;
                            this.updateUserQuota();

                            // 显示成功消息
                            this.showMessage('注册成功！', 'success');
                        } catch (error) {
                            console.log('注册API调用失败，使用演示模式');
                            this.showMessage('注册失败：服务器连接异常，请使用演示账号登录', 'error');
                        }
                    },

                    logout() {
                        this.user = null;
                        localStorage.removeItem('token');
                        this.remainingQuota = 0;
                        this.showMessage('已退出登录', 'info');
                    },

                    // 消息提示方法
                    showMessage(message, type = 'info') {
                        // 创建消息元素
                        const messageEl = document.createElement('div');
                        messageEl.className = `message-toast message-${type}`;
                        messageEl.textContent = message;

                        // 添加样式
                        messageEl.style.cssText = `
                            position: fixed;
                            top: 80px;
                            right: 20px;
                            padding: 12px 20px;
                            border-radius: 6px;
                            color: white;
                            font-weight: 500;
                            z-index: 10000;
                            opacity: 0;
                            transform: translateX(100%);
                            transition: all 0.3s ease;
                            max-width: 300px;
                            word-wrap: break-word;
                        `;

                        // 根据类型设置背景色
                        const colors = {
                            success: '#28a745',
                            error: '#dc3545',
                            warning: '#ffc107',
                            info: '#17a2b8'
                        };
                        messageEl.style.backgroundColor = colors[type] || colors.info;

                        // 添加到页面
                        document.body.appendChild(messageEl);

                        // 显示动画
                        setTimeout(() => {
                            messageEl.style.opacity = '1';
                            messageEl.style.transform = 'translateX(0)';
                        }, 100);

                        // 自动移除
                        setTimeout(() => {
                            messageEl.style.opacity = '0';
                            messageEl.style.transform = 'translateX(100%)';
                            setTimeout(() => {
                                if (messageEl.parentNode) {
                                    messageEl.parentNode.removeChild(messageEl);
                                }
                            }, 300);
                        }, 3000);
                    },

                    checkAuthStatus() {
                        const token = localStorage.getItem('token');
                        if (token) {
                            // 这里应该验证token有效性
                            // 简化处理，假设token有效
                            this.user = {
                                username: 'demo_user',
                                email: 'demo@example.com',
                                membership_level: 'trial'
                            };
                            this.updateUserQuota();
                        }
                    },

                    updateUserQuota() {
                        if (!this.user) return;

                        const quotaLimits = {
                            trial: 50,
                            basic: 200,
                            pro: 500,
                            premium: Infinity
                        };

                        this.remainingQuota = quotaLimits[this.user.membership_level] || 0;
                    },

                    // 预测功能
                    async makePrediction() {
                        if (!this.canPredict) {
                            if (!this.user) {
                                this.showMessage('请先登录以使用AI预测功能', 'warning');
                                this.showLoginModal = true;
                            } else {
                                this.showMessage('预测配额已用完，请升级会员', 'warning');
                                this.activeTab = 'membership';
                            }
                            return;
                        }

                        this.predicting = true;

                        try {
                            // 如果选择了策略，先进行策略分析
                            if (this.selectedStrategy) {
                                this.analyzeStrategy();
                            }

                            // 获取选定交易所的数据
                            const exchangeData = this.marketData[this.predictionSymbol]?.[this.selectedExchange];
                            if (!exchangeData) {
                                throw new Error(`无法获取${this.getExchangeName(this.selectedExchange)}的${this.predictionSymbol}数据`);
                            }

                            // 模拟API调用
                            await new Promise(resolve => setTimeout(resolve, 2000));

                            const predictions = {};
                            this.selectedTimeframes.forEach(timeframe => {
                                // 基于选定交易所的价格和变化趋势进行预测
                                const priceChange = exchangeData.change_percent_24h || 0;
                                const baseDirection = priceChange > 0 ? 'up' : 'down';

                                // 添加一些随机性，但倾向于当前趋势
                                const direction = Math.random() > 0.3 ? baseDirection : (baseDirection === 'up' ? 'down' : 'up');
                                const baseProbability = Math.abs(priceChange) * 2 + 60; // 基于价格变化幅度

                                predictions[timeframe] = {
                                    direction,
                                    probability: Math.min(baseProbability + Math.random() * 20, 95), // 60-95%
                                    confidence: Math.random() * 0.3 + 0.6, // 0.6-0.9
                                    reasoning: `基于${this.getExchangeName(this.selectedExchange)}的${this.predictionSymbol}数据分析，当前价格$${exchangeData.price?.toFixed(2)}，24h变化${priceChange.toFixed(2)}%，预计${timeframe}时间框架内将${direction === 'up' ? '上涨' : '下跌'}`,
                                    referenceExchange: this.selectedExchange,
                                    referencePrice: exchangeData.price
                                };
                            });

                            this.latestPrediction = predictions;
                            this.predictionData[this.predictionSymbol] = predictions;
                            this.remainingQuota--;

                            // 保存当前预测数据用于结果验证
                            this.currentPredictionData = {
                                predictions: predictions,
                                symbol: this.predictionSymbol,
                                startPrice: exchangeData.price,
                                startTime: Date.now(),
                                strategy: this.selectedStrategy,
                                strategySignals: this.strategySignals
                            };

                            // 重置预测结果显示
                            this.showPredictionResult = false;
                            this.predictionResult = null;

                            // 记录预测历史
                            this.recordPrediction(predictions);

                            // 启动复投预测
                            this.startMartingalePrediction();

                            // 启动预测倒计时
                            this.startPredictionTimer();

                        } catch (error) {
                            this.showMessage('预测失败：' + error.message, 'error');
                        } finally {
                            this.predicting = false;
                        }
                    },

                    // 工具方法
                    changeSymbol() {
                        // 切换交易对时的处理
                        console.log('Symbol changed to:', this.selectedSymbol);

                        // 更新TradingView图表
                        if (window.tradingViewChart) {
                            window.tradingViewChart.updateSymbol(this.selectedSymbol);
                        }
                    },

                    selectExchange(exchangeId) {
                        this.selectedExchange = exchangeId;
                        console.log('Selected exchange:', exchangeId);
                        // 可以在这里触发重新预测或其他逻辑
                    },

                    changeInterval() {
                        // 切换时间间隔时的处理
                        console.log('Interval changed to:', this.chartInterval);

                        // 更新TradingView图表时间框架
                        if (window.tradingViewChart) {
                            const intervalMap = {
                                '1m': 60,
                                '5m': 300,
                                '15m': 900,
                                '1h': 3600
                            };
                            const seconds = intervalMap[this.chartInterval] || 3600;

                            // 根据时间间隔调整数据点数量
                            const dataPoints = Math.floor(24 * 3600 / seconds); // 24小时的数据点
                            window.tradingViewChart.updateTimeframe(seconds, dataPoints);
                        }
                    },

                    isBestPrice(exchange, price) {
                        const data = this.marketData[this.selectedSymbol] || {};
                        const prices = Object.values(data).map(d => d.price).filter(p => p > 0);
                        return prices.length > 0 && price === Math.min(...prices);
                    },

                    getCurrentPrice() {
                        const data = this.marketData[this.selectedSymbol] || {};
                        const prices = Object.values(data).map(d => d.price).filter(p => p > 0);
                        return prices.length > 0 ? prices.reduce((a, b) => a + b) / prices.length : 0;
                    },

                    formatVolume(volume) {
                        if (!volume) return '0';
                        if (volume >= 1e9) return (volume / 1e9).toFixed(2) + 'B';
                        if (volume >= 1e6) return (volume / 1e6).toFixed(2) + 'M';
                        if (volume >= 1e3) return (volume / 1e3).toFixed(2) + 'K';
                        return volume.toFixed(2);
                    },

                    formatPrice(price) {
                        if (!price) return '0.00';
                        if (price >= 1000) return price.toFixed(2);
                        if (price >= 1) return price.toFixed(4);
                        return price.toFixed(6);
                    },

                    // 行情表相关方法
                    generateTickerData() {
                        const symbols = [
                            // 主流币种
                            { symbol: 'BTCUSDT', description: 'Bitcoin' },
                            { symbol: 'ETHUSDT', description: 'Ethereum' },
                            { symbol: 'BNBUSDT', description: 'BNB' },
                            { symbol: 'ADAUSDT', description: 'Cardano' },
                            { symbol: 'XRPUSDT', description: 'XRP' },
                            { symbol: 'SOLUSDT', description: 'Solana' },
                            { symbol: 'DOTUSDT', description: 'Polkadot' },
                            { symbol: 'LINKUSDT', description: 'Chainlink' },
                            // 热门币种
                            { symbol: 'AVAXUSDT', description: 'Avalanche' },
                            { symbol: 'DOGEUSDT', description: 'Dogecoin' },
                            { symbol: 'MATICUSDT', description: 'Polygon' },
                            { symbol: 'ATOMUSDT', description: 'Cosmos' },
                            { symbol: 'LTCUSDT', description: 'Litecoin' },
                            { symbol: 'UNIUSDT', description: 'Uniswap' },
                            { symbol: 'ALGOUSDT', description: 'Algorand' },
                            { symbol: 'VETUSDT', description: 'VeChain' },
                            // 新兴币种
                            { symbol: 'FTMUSDT', description: 'Fantom' },
                            { symbol: 'SANDUSDT', description: 'Sandbox' },
                            { symbol: 'MANAUSDT', description: 'Decentraland' },
                            { symbol: 'AXSUSDT', description: 'Axie Infinity' },
                            { symbol: 'CHZUSDT', description: 'Chiliz' },
                            { symbol: 'ENJUSDT', description: 'Enjin Coin' },
                            { symbol: 'GALAUSDT', description: 'Gala' },
                            { symbol: 'IMXUSDT', description: 'Immutable X' },
                            // DeFi币种
                            { symbol: 'AAVEUSDT', description: 'Aave' },
                            { symbol: 'COMPUSDT', description: 'Compound' },
                            { symbol: 'MKRUSDT', description: 'Maker' },
                            { symbol: 'SUSHIUSDT', description: 'SushiSwap' },
                            { symbol: 'CRVUSDT', description: 'Curve' },
                            { symbol: '1INCHUSDT', description: '1inch' },
                            { symbol: 'YFIUSDT', description: 'Yearn Finance' },
                            { symbol: 'SNXUSDT', description: 'Synthetix' }
                        ];

                        const basePrices = {
                            // 主流币种价格
                            'BTCUSDT': 43749.03,
                            'ETHUSDT': 3037.33,
                            'BNBUSDT': 334.4967,
                            'ADAUSDT': 0.461835,
                            'XRPUSDT': 0.554573,
                            'SOLUSDT': 108.0258,
                            'DOTUSDT': 6.4712,
                            'LINKUSDT': 13.5885,
                            // 热门币种价格
                            'AVAXUSDT': 42.2221,
                            'DOGEUSDT': 0.093591,
                            'MATICUSDT': 0.8245,
                            'ATOMUSDT': 12.45,
                            'LTCUSDT': 85.32,
                            'UNIUSDT': 7.89,
                            'ALGOUSDT': 0.245,
                            'VETUSDT': 0.0345,
                            // 新兴币种价格
                            'FTMUSDT': 0.456,
                            'SANDUSDT': 0.567,
                            'MANAUSDT': 0.789,
                            'AXSUSDT': 8.45,
                            'CHZUSDT': 0.123,
                            'ENJUSDT': 0.345,
                            'GALAUSDT': 0.067,
                            'IMXUSDT': 1.234,
                            // DeFi币种价格
                            'AAVEUSDT': 89.45,
                            'COMPUSDT': 56.78,
                            'MKRUSDT': 1234.56,
                            'SUSHIUSDT': 1.23,
                            'CRVUSDT': 0.567,
                            '1INCHUSDT': 0.456,
                            'YFIUSDT': 6789.12,
                            'SNXUSDT': 2.34
                        };

                        this.tickers = symbols.map(symbolInfo => {
                            const basePrice = basePrices[symbolInfo.symbol] || Math.random() * 100 + 10;
                            const changePercent = (Math.random() - 0.5) * 20; // -10% to +10%
                            const changeAmount = basePrice * (changePercent / 100);
                            const volume = Math.random() * 100000 + 10000;
                            const volumeUsd = volume * basePrice;

                            return {
                                symbol: symbolInfo.symbol,
                                description: symbolInfo.description,
                                price: basePrice,
                                changePercent: changePercent,
                                changeAmount: changeAmount,
                                priceChange: changeAmount > 0 ? 1 : changeAmount < 0 ? -1 : 0,
                                volume: volume,
                                volumeUsd: volumeUsd,
                                isFavorite: this.favoriteSymbols.includes(symbolInfo.symbol)
                            };
                        });

                        this.filterTickers();
                    },

                    filterTickers() {
                        let filtered = [...this.tickers];

                        // 首先应用搜索过滤
                        if (this.tickerSearchQuery.trim()) {
                            const searchQuery = this.tickerSearchQuery.trim().toLowerCase();
                            filtered = filtered.filter(ticker => {
                                const symbol = ticker.symbol.toLowerCase();
                                const baseAsset = ticker.symbol.replace(/USDT|BTC|ETH|BNB$/i, '').toLowerCase();
                                return symbol.includes(searchQuery) || baseAsset.includes(searchQuery);
                            });
                        }

                        // 然后应用类型过滤
                        switch (this.tickerFilter) {
                            case 'usdt':
                                filtered = filtered.filter(ticker => ticker.symbol.endsWith('USDT'));
                                break;
                            case 'btc':
                                filtered = filtered.filter(ticker => ticker.symbol.endsWith('BTC'));
                                break;
                            case 'favorites':
                                filtered = filtered.filter(ticker => ticker.isFavorite);
                                break;
                        }

                        // 排序
                        filtered.sort((a, b) => {
                            const field = this.tickerSort.field;
                            const direction = this.tickerSort.direction === 'asc' ? 1 : -1;

                            if (field === 'symbol') {
                                return direction * a.symbol.localeCompare(b.symbol);
                            } else {
                                return direction * (a[field] - b[field]);
                            }
                        });

                        this.filteredTickers = filtered;
                    },

                    // 搜索币种
                    searchTickers() {
                        this.filterTickers();
                    },

                    // 清除搜索
                    clearSearch() {
                        this.tickerSearchQuery = '';
                        this.filterTickers();
                    },

                    sortTickers(field) {
                        if (this.tickerSort.field === field) {
                            this.tickerSort.direction = this.tickerSort.direction === 'asc' ? 'desc' : 'asc';
                        } else {
                            this.tickerSort.field = field;
                            this.tickerSort.direction = 'desc';
                        }
                        this.filterTickers();
                    },

                    selectTicker(ticker) {
                        this.selectedSymbol = ticker.symbol;
                        // 可以在这里添加更多选择逻辑
                    },

                    toggleFavorite(ticker) {
                        ticker.isFavorite = !ticker.isFavorite;

                        if (ticker.isFavorite) {
                            if (!this.favoriteSymbols.includes(ticker.symbol)) {
                                this.favoriteSymbols.push(ticker.symbol);
                            }
                        } else {
                            const index = this.favoriteSymbols.indexOf(ticker.symbol);
                            if (index > -1) {
                                this.favoriteSymbols.splice(index, 1);
                            }
                        }

                        localStorage.setItem('favoriteSymbols', JSON.stringify(this.favoriteSymbols));
                        this.filterTickers();
                    },

                    refreshTickers() {
                        this.tickerRefreshing = true;
                        setTimeout(() => {
                            this.generateTickerData();
                            this.tickerRefreshing = false;
                        }, 1000);
                    },

                    startTrading(ticker) {
                        this.selectedTradingSymbol = ticker;
                        this.currentView = 'trading';
                        // 延迟初始化图表，确保DOM已渲染
                        this.$nextTick(() => {
                            // 检查图表库是否加载
                            if (typeof LightweightCharts === 'undefined') {
                                console.warn('LightweightCharts库未加载，将在3秒后重试');
                                setTimeout(() => {
                                    this.initTradingChart();
                                }, 3000);
                            } else {
                                this.initTradingChart();
                            }
                        });
                    },

                    updateTickerData() {
                        // 更新行情数据，模拟实时价格变化
                        this.tickers.forEach(ticker => {
                            const priceChange = (Math.random() - 0.5) * 0.02; // ±1%的价格变化
                            const oldPrice = ticker.price;
                            ticker.price = Math.max(0.000001, ticker.price * (1 + priceChange));

                            // 更新24h变化
                            const changePercent = (Math.random() - 0.5) * 20; // -10% to +10%
                            ticker.changePercent = changePercent;
                            ticker.changeAmount = ticker.price * (changePercent / 100);
                            ticker.priceChange = ticker.price > oldPrice ? 1 : ticker.price < oldPrice ? -1 : 0;

                            // 更新成交量
                            ticker.volume = Math.random() * 100000 + 10000;
                            ticker.volumeUsd = ticker.volume * ticker.price;
                        });

                        this.filterTickers();
                    },

                    // 交易详情页相关方法
                    backToDashboard() {
                        this.currentView = 'dashboard';
                        this.selectedTradingSymbol = null;
                        this.cleanupTradingChart();
                    },

                    toggleTradingFavorite() {
                        if (this.selectedTradingSymbol) {
                            this.toggleFavorite(this.selectedTradingSymbol);
                        }
                    },

                    formatTradingPrice(price) {
                        if (!price) return '0.00';
                        if (price >= 1000) return price.toFixed(2);
                        if (price >= 1) return price.toFixed(4);
                        return price.toFixed(6);
                    },

                    getTradingHigh() {
                        if (!this.selectedTradingSymbol) return 0;
                        // 模拟24小时高价（当前价格的1.05-1.15倍）
                        return this.selectedTradingSymbol.price * (1.05 + Math.random() * 0.1);
                    },

                    getTradingLow() {
                        if (!this.selectedTradingSymbol) return 0;
                        // 模拟24小时低价（当前价格的0.85-0.95倍）
                        return this.selectedTradingSymbol.price * (0.85 + Math.random() * 0.1);
                    },

                    changeTradingTimeframe(timeframe) {
                        this.tradingTimeframe = timeframe;
                        if (this.tradingChart) {
                            this.updateTradingChart();
                        }
                    },

                    initTradingChart() {
                        const container = document.getElementById('trading-chart');
                        if (!container || !this.selectedTradingSymbol) return;

                        // 清理现有图表
                        if (this.tradingChart) {
                            this.tradingChart.remove();
                            this.tradingChart = null;
                        }

                        // 清空容器
                        container.innerHTML = '';

                        // 显示简洁的加载状态
                        container.innerHTML = `
                            <div class="chart-loading">
                                正在加载图表数据...
                            </div>
                        `;

                        // 延迟执行以确保库已加载
                        setTimeout(() => {
                            this.createChart(container);
                        }, 100);
                    },

                    createChart(container) {
                        try {
                            // 清空容器
                            container.innerHTML = '';

                            // 获取当前主题颜色
                            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
                            const textColor = isDark ? '#ffffff' : '#333333';
                            const backgroundColor = isDark ? 'transparent' : 'transparent';
                            const gridColor = isDark ? 'rgba(197, 203, 206, 0.1)' : 'rgba(197, 203, 206, 0.3)';
                            const borderColor = isDark ? 'rgba(197, 203, 206, 0.2)' : 'rgba(197, 203, 206, 0.5)';

                            // 创建简洁移动端优化的图表
                            this.tradingChart = LightweightCharts.createChart(container, {
                                width: container.clientWidth,
                                height: container.clientHeight,
                                layout: {
                                    background: { color: backgroundColor },
                                    textColor: textColor,
                                    fontSize: 12, // 移动端适配字体
                                },
                                grid: {
                                    vertLines: {
                                        color: gridColor,
                                        style: 1, // 实线
                                        visible: true,
                                    },
                                    horzLines: {
                                        color: gridColor,
                                        style: 1, // 实线
                                        visible: true,
                                    },
                                },
                                crosshair: {
                                    mode: LightweightCharts.CrosshairMode.Normal,
                                    vertLine: {
                                        width: 1,
                                        color: isDark ? '#758696' : '#9598A1',
                                        style: 3, // 虚线
                                    },
                                    horzLine: {
                                        width: 1,
                                        color: isDark ? '#758696' : '#9598A1',
                                        style: 3, // 虚线
                                    },
                                },
                                rightPriceScale: {
                                    borderColor: borderColor,
                                    borderVisible: true,
                                    scaleMargins: {
                                        top: 0.05, // 减少上边距
                                        bottom: 0.25, // 减少下边距为成交量留空间
                                    },
                                    autoScale: true,
                                },
                                timeScale: {
                                    borderColor: borderColor,
                                    borderVisible: true,
                                    timeVisible: true,
                                    secondsVisible: false,
                                    fixLeftEdge: true,
                                    fixRightEdge: true,
                                    barSpacing: 8, // 增加K线间距，减少密集感
                                    minBarSpacing: 4,
                                },
                                handleScroll: {
                                    mouseWheel: true,
                                    pressedMouseMove: true,
                                    horzTouchDrag: true, // 移动端水平拖拽
                                    vertTouchDrag: false, // 禁用垂直拖拽
                                },
                                handleScale: {
                                    axisPressedMouseMove: true,
                                    mouseWheel: true,
                                    pinch: true, // 移动端双指缩放
                                    axisDoubleClickReset: true,
                                },
                                kineticScroll: {
                                    touch: true, // 移动端惯性滚动
                                    mouse: false,
                                },
                            });

                            // 添加简洁的K线系列 - 移动端优化
                            const candlestickSeries = this.tradingChart.addCandlestickSeries({
                                upColor: '#00D4AA', // 更现代的绿色
                                downColor: '#FF6B6B', // 更柔和的红色
                                borderVisible: false, // 无边框更简洁
                                wickUpColor: '#00D4AA',
                                wickDownColor: '#FF6B6B',
                                borderUpColor: '#00D4AA',
                                borderDownColor: '#FF6B6B',
                                wickVisible: true,
                                priceFormat: {
                                    type: 'price',
                                    precision: this.selectedTradingSymbol.price >= 1 ? 2 : 6,
                                    minMove: this.selectedTradingSymbol.price >= 1 ? 0.01 : 0.000001,
                                },
                                lastValueVisible: true, // 显示最新价格
                                priceLineVisible: true, // 显示价格线
                            });

                            // 添加简化的成交量系列
                            const volumeSeries = this.tradingChart.addHistogramSeries({
                                color: isDark ? 'rgba(134, 152, 170, 0.4)' : 'rgba(134, 152, 170, 0.6)',
                                priceFormat: {
                                    type: 'volume',
                                },
                                priceScaleId: '', // 独立价格轴
                                scaleMargins: {
                                    top: 0.75, // 成交量占底部25%
                                    bottom: 0,
                                },
                                lastValueVisible: false, // 隐藏成交量数值
                                priceLineVisible: false, // 隐藏价格线
                            });

                            // 生成K线数据
                            const candleData = this.generateTradingCandleData();
                            const volumeData = this.generateTradingVolumeData();

                            // 设置数据
                            candlestickSeries.setData(candleData);
                            volumeSeries.setData(volumeData);

                            // 保存系列引用以便后续更新
                            this.tradingChart.candlestickSeries = candlestickSeries;
                            this.tradingChart.volumeSeries = volumeSeries;

                            // 响应式调整
                            const resizeObserver = new ResizeObserver(entries => {
                                if (this.tradingChart && container.clientWidth > 0 && container.clientHeight > 0) {
                                    this.tradingChart.applyOptions({
                                        width: container.clientWidth,
                                        height: container.clientHeight,
                                    });
                                }
                            });
                            resizeObserver.observe(container);

                            // 保存ResizeObserver引用以便清理
                            this.tradingChart.resizeObserver = resizeObserver;

                            console.log('TradingView图表初始化成功');

                        } catch (error) {
                            console.error('TradingView图表初始化失败:', error);
                            this.showChartFallback(container, error.message);
                        }
                    },

                    showChartFallback(container, errorMessage = '') {
                        // 显示备用图表界面
                        container.innerHTML = `
                            <div class="trading-chart-placeholder">
                                <i class="fas fa-chart-line fa-3x" style="color: var(--primary-color); margin-bottom: 1rem;"></i>
                                <p style="font-size: 1.2rem; margin-bottom: 0.5rem;">K线图表</p>
                                <p class="subtitle" style="margin-bottom: 2rem;">${this.selectedTradingSymbol.symbol} 价格走势</p>

                                <!-- 模拟K线图 -->
                                <div style="width: 100%; max-width: 600px; height: 200px; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 2rem; position: relative; overflow: hidden;">
                                    <div style="position: absolute; top: 10px; left: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                                        ${this.tradingTimeframe} K线图
                                    </div>
                                    <div style="position: absolute; bottom: 0; left: 0; right: 0; height: 150px; display: flex; align-items: end; justify-content: space-around; padding: 0 20px;">
                                        ${this.generateMockCandlesticks()}
                                    </div>
                                    <div style="position: absolute; top: 50%; right: 15px; transform: translateY(-50%); font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">
                                        ${this.formatTradingPrice(this.selectedTradingSymbol.price)}
                                    </div>
                                </div>

                                <!-- 详细信息 -->
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; max-width: 400px; margin-bottom: 2rem;">
                                    <div style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                        <div style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">当前价格</div>
                                        <div style="color: var(--text-primary); font-weight: 600; font-size: 1.1rem;">${this.formatTradingPrice(this.selectedTradingSymbol.price)}</div>
                                    </div>
                                    <div style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                        <div style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">24h涨跌</div>
                                        <div style="color: ${this.selectedTradingSymbol.changePercent >= 0 ? '#22c55e' : '#ef4444'}; font-weight: 600; font-size: 1.1rem;">
                                            ${this.selectedTradingSymbol.changePercent >= 0 ? '+' : ''}${this.selectedTradingSymbol.changePercent.toFixed(2)}%
                                        </div>
                                    </div>
                                    <div style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                        <div style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">24h成交量</div>
                                        <div style="color: var(--text-primary); font-weight: 600; font-size: 1.1rem;">${this.formatVolume(this.selectedTradingSymbol.volume)}</div>
                                    </div>
                                    <div style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                        <div style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">时间周期</div>
                                        <div style="color: var(--primary-color); font-weight: 600; font-size: 1.1rem;">${this.tradingTimeframe}</div>
                                    </div>
                                </div>

                                <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">
                                    ${errorMessage ? '图表库加载失败，' : ''}正在使用备用显示模式
                                </div>

                                <button onclick="window.location.reload()" style="padding: 0.75rem 1.5rem; background: var(--primary-color); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem; transition: all 0.2s ease;">
                                    重新加载页面
                                </button>
                            </div>
                        `;
                    },

                    generateMockCandlesticks() {
                        let candlesticks = '';
                        const basePrice = this.selectedTradingSymbol?.price || 50000;

                        for (let i = 0; i < 20; i++) {
                            const height = Math.random() * 80 + 20;
                            const isUp = Math.random() > 0.5;
                            const color = isUp ? '#26a69a' : '#ef5350';

                            candlesticks += `
                                <div style="width: 8px; height: ${height}px; background: ${color}; border-radius: 1px; opacity: 0.8;"></div>
                            `;
                        }

                        return candlesticks;
                    },

                    updateTradingChart() {
                        if (!this.tradingChart || !this.tradingChart.candlestickSeries) {
                            this.initTradingChart();
                            return;
                        }

                        try {
                            // 生成新的数据
                            const candleData = this.generateTradingCandleData();
                            const volumeData = this.generateTradingVolumeData();

                            // 更新数据
                            this.tradingChart.candlestickSeries.setData(candleData);
                            this.tradingChart.volumeSeries.setData(volumeData);

                            console.log(`图表已更新为 ${this.tradingTimeframe} 时间周期`);
                        } catch (error) {
                            console.error('更新图表失败:', error);
                            this.initTradingChart();
                        }
                    },

                    generateTradingCandleData() {
                        const data = [];
                        const basePrice = this.selectedTradingSymbol?.price || 50000;
                        const timeframeMinutes = this.getTimeframeMinutes();
                        // 移动端优化：减少数据点，让图表更简洁
                        const dataPoints = window.innerWidth < 768 ? 50 : 80;

                        // 计算开始时间
                        let currentTime = Math.floor(Date.now() / 1000) - (dataPoints * timeframeMinutes * 60);

                        for (let i = 0; i < dataPoints; i++) {
                            const time = currentTime + (i * timeframeMinutes * 60);

                            // 生成价格数据，添加一些趋势
                            const trend = Math.sin(i * 0.1) * 0.02; // 添加趋势
                            const volatility = this.selectedTradingSymbol?.changePercent ?
                                Math.abs(this.selectedTradingSymbol.changePercent) / 100 * 0.5 : 0.02;

                            const priceVariation = basePrice * volatility;
                            const open = basePrice + (basePrice * trend) + (Math.random() - 0.5) * priceVariation;
                            const high = open + Math.random() * priceVariation * 0.5;
                            const low = open - Math.random() * priceVariation * 0.5;
                            const close = open + (Math.random() - 0.5) * priceVariation * 0.8;

                            data.push({
                                time: time,
                                open: Math.max(0.000001, open),
                                high: Math.max(0.000001, Math.max(open, close, high)),
                                low: Math.max(0.000001, Math.min(open, close, low)),
                                close: Math.max(0.000001, close),
                            });
                        }

                        return data;
                    },

                    generateTradingVolumeData() {
                        const data = [];
                        const baseVolume = this.selectedTradingSymbol?.volume || 10000;
                        const timeframeMinutes = this.getTimeframeMinutes();
                        // 移动端优化：与K线数据点保持一致
                        const dataPoints = window.innerWidth < 768 ? 50 : 80;

                        let currentTime = Math.floor(Date.now() / 1000) - (dataPoints * timeframeMinutes * 60);

                        for (let i = 0; i < dataPoints; i++) {
                            const time = currentTime + (i * timeframeMinutes * 60);
                            const volume = baseVolume * (0.5 + Math.random() * 1.5); // 50%-200%的基础成交量
                            const isUp = Math.random() > 0.5;

                            data.push({
                                time: time,
                                value: volume,
                                color: isUp ? '#26a69a' : '#ef5350',
                            });
                        }

                        return data;
                    },

                    getTimeframeMinutes() {
                        const timeframeMap = {
                            '分时': 1,
                            '1分': 1,
                            '5分': 5,
                            '1小时': 60,
                            '4小时': 240,
                            '更多': 60,
                            '指标': 60,
                            '深度': 1
                        };
                        return timeframeMap[this.tradingTimeframe] || 60;
                    },

                    // 清理图表资源
                    cleanupTradingChart() {
                        if (this.tradingChart) {
                            if (this.tradingChart.resizeObserver) {
                                this.tradingChart.resizeObserver.disconnect();
                            }
                            this.tradingChart.remove();
                            this.tradingChart = null;
                        }
                    },

                    // 更新图表主题
                    updateTradingChartTheme() {
                        if (!this.tradingChart) return;

                        try {
                            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
                            const textColor = isDark ? '#ffffff' : '#333333';
                            const backgroundColor = isDark ? '#1a1a1a' : '#ffffff';
                            const gridColor = isDark ? 'rgba(197, 203, 206, 0.1)' : 'rgba(197, 203, 206, 0.3)';
                            const borderColor = isDark ? 'rgba(197, 203, 206, 0.2)' : 'rgba(197, 203, 206, 0.5)';

                            this.tradingChart.applyOptions({
                                layout: {
                                    background: { color: backgroundColor },
                                    textColor: textColor,
                                },
                                grid: {
                                    vertLines: { color: gridColor },
                                    horzLines: { color: gridColor },
                                },
                                rightPriceScale: {
                                    borderColor: borderColor,
                                },
                                timeScale: {
                                    borderColor: borderColor,
                                },
                            });

                            console.log('图表主题已更新');
                        } catch (error) {
                            console.error('更新图表主题失败:', error);
                        }
                    },

                    // 预测倒计时相关方法
                    startPredictionTimer() {
                        // 清除现有计时器
                        if (this.predictionTimer) {
                            clearInterval(this.predictionTimer);
                        }

                        // 设置预测开始和结束时间
                        this.predictionStartTime = Date.now();

                        // 计算预测持续时间（基于最长的时间框架）
                        const maxTimeframe = this.getMaxTimeframe();
                        const durationMs = this.getTimeframeDuration(maxTimeframe);
                        this.predictionEndTime = this.predictionStartTime + durationMs;

                        // 记录预测开始时的币价
                        this.predictionStartPrice = this.getCurrentPrice();
                        this.predictionEndPrice = null; // 重置结束价格

                        console.log(`预测开始: ${new Date(this.predictionStartTime).toLocaleString()}`);
                        console.log(`预测结束: ${new Date(this.predictionEndTime).toLocaleString()}`);
                        console.log(`预测时长: ${maxTimeframe} (${durationMs / 1000}秒)`);
                        console.log(`开始价格: ${this.predictionStartPrice}`);

                        // 设置定时器在预测结束时检查结果
                        this.predictionTimer = setTimeout(() => {
                            this.checkPredictionResult();
                        }, durationMs);
                    },

                    startTimeUpdater() {
                        // 每秒更新当前时间
                        this.timerInterval = setInterval(() => {
                            this.currentTime = Date.now();
                        }, 1000);
                    },

                    getMaxTimeframe() {
                        // 获取选中的最长时间框架
                        const timeframeOrder = { '1m': 1, '5m': 5, '15m': 15, '1h': 60 };
                        let maxTimeframe = '1m';
                        let maxMinutes = 0;

                        this.selectedTimeframes.forEach(timeframe => {
                            const minutes = timeframeOrder[timeframe] || 1;
                            if (minutes > maxMinutes) {
                                maxMinutes = minutes;
                                maxTimeframe = timeframe;
                            }
                        });

                        return maxTimeframe;
                    },

                    getTimeframeDuration(timeframe) {
                        // 将时间框架转换为毫秒
                        const durations = {
                            '1m': 1 * 60 * 1000,      // 1分钟
                            '5m': 5 * 60 * 1000,      // 5分钟
                            '15m': 15 * 60 * 1000,    // 15分钟
                            '1h': 60 * 60 * 1000      // 1小时
                        };
                        return durations[timeframe] || durations['1m'];
                    },

                    getRemainingTime() {
                        if (!this.predictionEndTime) return 0;
                        return Math.max(0, this.predictionEndTime - this.currentTime);
                    },

                    formatRemainingTime() {
                        const remaining = this.getRemainingTime();

                        if (remaining <= 0) {
                            return '预测已到期';
                        }

                        const totalSeconds = Math.floor(remaining / 1000);
                        const hours = Math.floor(totalSeconds / 3600);
                        const minutes = Math.floor((totalSeconds % 3600) / 60);
                        const seconds = totalSeconds % 60;

                        if (hours > 0) {
                            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                        } else {
                            return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                        }
                    },

                    formatTime(timestamp) {
                        if (!timestamp) return '--:--';
                        const date = new Date(timestamp);
                        return date.toLocaleTimeString('zh-CN', {
                            hour: '2-digit',
                            minute: '2-digit',
                            second: '2-digit'
                        });
                    },

                    // 获取当前选择的币种符号
                    getCurrentSymbol() {
                        return this.selectedSymbol || 'BTCUSDT';
                    },

                    // 获取当前价格
                    getCurrentPrice() {
                        const marketData = this.marketData[this.selectedSymbol]?.[this.selectedExchange];
                        return marketData ? marketData.price : 0;
                    },

                    // 格式化价格显示
                    formatPrice(price) {
                        if (!price || price === 0) return '--';

                        // 根据价格大小决定小数位数
                        if (price >= 1000) {
                            return price.toFixed(2);
                        } else if (price >= 1) {
                            return price.toFixed(4);
                        } else {
                            return price.toFixed(6);
                        }
                    },

                    // 获取价格变化的CSS类
                    getPriceChangeClass() {
                        if (!this.predictionStartPrice || !this.predictionEndPrice) {
                            return 'price-neutral';
                        }

                        if (this.predictionEndPrice > this.predictionStartPrice) {
                            return 'price-up';
                        } else if (this.predictionEndPrice < this.predictionStartPrice) {
                            return 'price-down';
                        } else {
                            return 'price-neutral';
                        }
                    },

                    isPredictionExpired() {
                        return this.predictionEndTime && this.currentTime >= this.predictionEndTime;
                    },

                    getTimerDisplayClass() {
                        const remaining = this.getRemainingTime();
                        const total = this.predictionEndTime - this.predictionStartTime;
                        const percentage = remaining / total;

                        if (remaining <= 0) {
                            return 'expired';
                        } else if (percentage <= 0.2) {
                            return 'warning';
                        } else {
                            return 'active';
                        }
                    },

                    getPredictionStatusClass() {
                        const remaining = this.getRemainingTime();
                        const total = this.predictionEndTime - this.predictionStartTime;
                        const percentage = remaining / total;

                        if (remaining <= 0) {
                            return 'expired';
                        } else if (percentage <= 0.2) {
                            return 'warning';
                        } else {
                            return 'active';
                        }
                    },

                    getPredictionStatusIcon() {
                        const remaining = this.getRemainingTime();
                        const total = this.predictionEndTime - this.predictionStartTime;
                        const percentage = remaining / total;

                        if (remaining <= 0) {
                            return 'fa-exclamation-triangle';
                        } else if (percentage <= 0.2) {
                            return 'fa-clock';
                        } else {
                            return 'fa-play-circle';
                        }
                    },

                    getPredictionStatusText() {
                        const remaining = this.getRemainingTime();
                        const total = this.predictionEndTime - this.predictionStartTime;
                        const percentage = remaining / total;

                        if (remaining <= 0) {
                            return '预测已到期';
                        } else if (percentage <= 0.2) {
                            return '即将到期';
                        } else {
                            return '预测进行中';
                        }
                    },

                    // 检查预测结果
                    checkPredictionResult() {
                        if (!this.currentPredictionData) return;

                        // 获取当前价格（模拟从市场数据获取）
                        const currentMarketData = this.marketData[this.currentPredictionData.symbol]?.[this.selectedExchange];
                        if (!currentMarketData) {
                            console.error('无法获取当前市场数据');
                            return;
                        }

                        const startPrice = this.currentPredictionData.startPrice;
                        const currentPrice = currentMarketData.price;

                        // 记录预测结束时的币价
                        this.predictionEndPrice = currentPrice;
                        console.log(`结束价格: ${this.predictionEndPrice}`);

                        const priceChange = currentPrice - startPrice;
                        const actualDirection = priceChange > 0 ? 'up' : 'down';

                        // 获取主要预测（使用最长时间框架的预测）
                        const maxTimeframe = this.getMaxTimeframe();
                        const mainPrediction = this.currentPredictionData.predictions[maxTimeframe];

                        if (!mainPrediction) {
                            console.error('无法找到主要预测数据');
                            return;
                        }

                        const predictedDirection = mainPrediction.direction;
                        const isSuccess = predictedDirection === actualDirection;
                        const priceChangePercent = ((priceChange / startPrice) * 100).toFixed(2);

                        // 创建结果对象
                        this.predictionResult = {
                            isSuccess: isSuccess,
                            predictedDirection: predictedDirection,
                            actualDirection: actualDirection,
                            probability: mainPrediction.probability.toFixed(1),
                            confidence: (mainPrediction.confidence * 100).toFixed(1),
                            startPrice: startPrice,
                            endPrice: currentPrice,
                            priceChange: priceChange,
                            priceChangePercent: priceChangePercent,
                            timeframe: maxTimeframe,
                            message: this.generateResultMessage(isSuccess, predictedDirection, actualDirection, priceChangePercent)
                        };

                        // 显示结果
                        this.showPredictionResult = true;

                        // 更新统计数据
                        this.updatePredictionResultStats(isSuccess);

                        // 处理复投逻辑
                        this.processMartingaleBet(isSuccess);

                        console.log('预测结果:', this.predictionResult);
                    },

                    generateResultMessage(isSuccess, predicted, actual, changePercent) {
                        if (isSuccess) {
                            return `预测正确！价格按预期${predicted === 'up' ? '上涨' : '下跌'}了 ${Math.abs(changePercent)}%`;
                        } else {
                            return `预测错误。预测${predicted === 'up' ? '上涨' : '下跌'}，实际${actual === 'up' ? '上涨' : '下跌'}了 ${Math.abs(changePercent)}%`;
                        }
                    },

                    updatePredictionResultStats(isSuccess) {
                        // 更新实时统计
                        if (isSuccess) {
                            this.predictionStats.correctPredictions++;
                        }
                        this.predictionStats.totalPredictions++;

                        // 重新计算准确率
                        this.predictionStats.accuracy = this.predictionStats.totalPredictions > 0
                            ? (this.predictionStats.correctPredictions / this.predictionStats.totalPredictions) * 100
                            : 0;

                        // 更新今日统计
                        this.predictionStats.todayStats.total++;
                        if (isSuccess) {
                            this.predictionStats.todayStats.correct++;
                        }
                        this.predictionStats.todayStats.accuracy = this.predictionStats.todayStats.total > 0
                            ? (this.predictionStats.todayStats.correct / this.predictionStats.todayStats.total) * 100
                            : 0;

                        // 更新本周统计
                        this.predictionStats.weeklyStats.total++;
                        if (isSuccess) {
                            this.predictionStats.weeklyStats.correct++;
                        }
                        this.predictionStats.weeklyStats.accuracy = this.predictionStats.weeklyStats.total > 0
                            ? (this.predictionStats.weeklyStats.correct / this.predictionStats.weeklyStats.total) * 100
                            : 0;

                        // 更新时间框架统计
                        const timeframe = this.getMaxTimeframe();
                        if (this.predictionStats.timeframeStats[timeframe]) {
                            this.predictionStats.timeframeStats[timeframe].total++;
                            if (isSuccess) {
                                this.predictionStats.timeframeStats[timeframe].correct++;
                            }
                            this.predictionStats.timeframeStats[timeframe].accuracy =
                                this.predictionStats.timeframeStats[timeframe].total > 0
                                    ? (this.predictionStats.timeframeStats[timeframe].correct / this.predictionStats.timeframeStats[timeframe].total) * 100
                                    : 0;
                        }

                        // 更新趋势
                        this.updateAccuracyTrend();

                        // 保存数据
                        this.savePredictionData();
                    },

                    // 预测统计相关方法
                    initPredictionStats() {
                        // 从localStorage加载历史数据
                        const savedStats = localStorage.getItem('predictionStats');
                        if (savedStats) {
                            this.predictionStats = JSON.parse(savedStats);
                        }

                        // 生成一些模拟的历史数据来展示功能
                        if (this.predictionStats.totalPredictions === 0) {
                            this.generateMockPredictionHistory();
                        }

                        // 启动实时更新
                        this.startRealtimeStatsUpdate();
                    },

                    generateMockPredictionHistory() {
                        // 生成模拟的预测历史数据
                        const mockHistory = [];
                        const now = Date.now();
                        const oneDay = 24 * 60 * 60 * 1000;
                        const oneWeek = 7 * oneDay;

                        // 生成过去一周的数据
                        for (let i = 0; i < 50; i++) {
                            const timestamp = now - Math.random() * oneWeek;
                            const timeframe = ['1m', '5m', '15m', '1h'][Math.floor(Math.random() * 4)];
                            const isCorrect = Math.random() > 0.25; // 75%的基础准确率

                            mockHistory.push({
                                id: `mock_${i}`,
                                timestamp: timestamp,
                                timeframe: timeframe,
                                symbol: 'BTCUSDT',
                                prediction: Math.random() > 0.5 ? 'up' : 'down',
                                actual: Math.random() > 0.5 ? 'up' : 'down',
                                isCorrect: isCorrect,
                                confidence: Math.random() * 0.4 + 0.6
                            });
                        }

                        this.predictionHistory = mockHistory;
                        this.updatePredictionStats();
                        this.savePredictionData();
                    },

                    recordPrediction(predictions) {
                        const timestamp = Date.now();

                        // 为每个时间框架记录预测
                        Object.keys(predictions).forEach(timeframe => {
                            const prediction = predictions[timeframe];

                            // 模拟实际结果（在实际应用中，这应该在预测到期后根据真实价格变化来确定）
                            const actualDirection = Math.random() > 0.5 ? 'up' : 'down';
                            const isCorrect = prediction.direction === actualDirection;

                            const record = {
                                id: `${timestamp}_${timeframe}`,
                                timestamp: timestamp,
                                timeframe: timeframe,
                                symbol: this.predictionSymbol,
                                prediction: prediction.direction,
                                actual: actualDirection,
                                isCorrect: isCorrect,
                                confidence: prediction.confidence,
                                probability: prediction.probability
                            };

                            this.predictionHistory.push(record);
                        });

                        // 限制历史记录数量
                        if (this.predictionHistory.length > 200) {
                            this.predictionHistory = this.predictionHistory.slice(-200);
                        }

                        this.updatePredictionStats();
                        this.savePredictionData();
                    },

                    updatePredictionStats() {
                        const now = Date.now();
                        const oneDay = 24 * 60 * 60 * 1000;
                        const oneWeek = 7 * oneDay;

                        // 重置统计
                        this.predictionStats = {
                            totalPredictions: 0,
                            correctPredictions: 0,
                            accuracy: 0,
                            todayStats: { total: 0, correct: 0, accuracy: 0 },
                            weeklyStats: { total: 0, correct: 0, accuracy: 0 },
                            timeframeStats: {
                                '1m': { total: 0, correct: 0, accuracy: 0 },
                                '5m': { total: 0, correct: 0, accuracy: 0 },
                                '15m': { total: 0, correct: 0, accuracy: 0 },
                                '1h': { total: 0, correct: 0, accuracy: 0 }
                            }
                        };

                        // 计算统计数据
                        this.predictionHistory.forEach(record => {
                            // 总体统计
                            this.predictionStats.totalPredictions++;
                            if (record.isCorrect) {
                                this.predictionStats.correctPredictions++;
                            }

                            // 今日统计
                            if (now - record.timestamp < oneDay) {
                                this.predictionStats.todayStats.total++;
                                if (record.isCorrect) {
                                    this.predictionStats.todayStats.correct++;
                                }
                            }

                            // 本周统计
                            if (now - record.timestamp < oneWeek) {
                                this.predictionStats.weeklyStats.total++;
                                if (record.isCorrect) {
                                    this.predictionStats.weeklyStats.correct++;
                                }
                            }

                            // 时间框架统计
                            if (this.predictionStats.timeframeStats[record.timeframe]) {
                                this.predictionStats.timeframeStats[record.timeframe].total++;
                                if (record.isCorrect) {
                                    this.predictionStats.timeframeStats[record.timeframe].correct++;
                                }
                            }
                        });

                        // 计算准确率
                        this.predictionStats.accuracy = this.predictionStats.totalPredictions > 0
                            ? (this.predictionStats.correctPredictions / this.predictionStats.totalPredictions) * 100
                            : 0;

                        this.predictionStats.todayStats.accuracy = this.predictionStats.todayStats.total > 0
                            ? (this.predictionStats.todayStats.correct / this.predictionStats.todayStats.total) * 100
                            : 0;

                        this.predictionStats.weeklyStats.accuracy = this.predictionStats.weeklyStats.total > 0
                            ? (this.predictionStats.weeklyStats.correct / this.predictionStats.weeklyStats.total) * 100
                            : 0;

                        // 计算各时间框架准确率
                        Object.keys(this.predictionStats.timeframeStats).forEach(timeframe => {
                            const stats = this.predictionStats.timeframeStats[timeframe];
                            stats.accuracy = stats.total > 0 ? (stats.correct / stats.total) * 100 : 0;
                        });

                        // 更新趋势
                        this.updateAccuracyTrend();
                    },

                    updateAccuracyTrend() {
                        // 计算最近10次预测的准确率趋势
                        const recentPredictions = this.predictionHistory.slice(-20);
                        const firstHalf = recentPredictions.slice(0, 10);
                        const secondHalf = recentPredictions.slice(-10);

                        const firstHalfAccuracy = firstHalf.length > 0
                            ? (firstHalf.filter(p => p.isCorrect).length / firstHalf.length) * 100
                            : 0;
                        const secondHalfAccuracy = secondHalf.length > 0
                            ? (secondHalf.filter(p => p.isCorrect).length / secondHalf.length) * 100
                            : 0;

                        const difference = secondHalfAccuracy - firstHalfAccuracy;

                        if (difference > 5) {
                            this.accuracyTrend = 'up';
                        } else if (difference < -5) {
                            this.accuracyTrend = 'down';
                        } else {
                            this.accuracyTrend = 'stable';
                        }
                    },

                    startRealtimeStatsUpdate() {
                        // 每30秒更新一次统计数据（模拟实时更新）
                        setInterval(() => {
                            // 模拟一些新的预测结果
                            if (Math.random() > 0.7) { // 30%的概率添加新数据
                                this.simulateNewPredictionResult();
                            }
                        }, 30000);
                    },

                    simulateNewPredictionResult() {
                        // 模拟新的预测结果
                        const timeframes = ['1m', '5m', '15m', '1h'];
                        const timeframe = timeframes[Math.floor(Math.random() * timeframes.length)];
                        const isCorrect = Math.random() > 0.3; // 70%准确率

                        const record = {
                            id: `sim_${Date.now()}`,
                            timestamp: Date.now(),
                            timeframe: timeframe,
                            symbol: 'BTCUSDT',
                            prediction: Math.random() > 0.5 ? 'up' : 'down',
                            actual: Math.random() > 0.5 ? 'up' : 'down',
                            isCorrect: isCorrect,
                            confidence: Math.random() * 0.4 + 0.6
                        };

                        this.predictionHistory.push(record);

                        // 限制历史记录数量
                        if (this.predictionHistory.length > 200) {
                            this.predictionHistory = this.predictionHistory.slice(-200);
                        }

                        this.updatePredictionStats();
                        this.savePredictionData();
                    },

                    savePredictionData() {
                        // 保存到localStorage
                        localStorage.setItem('predictionStats', JSON.stringify(this.predictionStats));
                        localStorage.setItem('predictionHistory', JSON.stringify(this.predictionHistory));
                    },

                    // UI辅助方法
                    getAccuracyClass(accuracy) {
                        if (accuracy >= 80) return 'excellent';
                        if (accuracy >= 70) return 'good';
                        if (accuracy >= 60) return 'average';
                        return 'poor';
                    },

                    getAccuracyColor(accuracy) {
                        if (accuracy >= 80) return '#22c55e';
                        if (accuracy >= 70) return '#3b82f6';
                        if (accuracy >= 60) return '#f59e0b';
                        return '#ef4444';
                    },

                    getTrendIcon() {
                        switch (this.accuracyTrend) {
                            case 'up': return 'fa-arrow-up';
                            case 'down': return 'fa-arrow-down';
                            default: return 'fa-minus';
                        }
                    },

                    getTrendText() {
                        switch (this.accuracyTrend) {
                            case 'up': return '上升趋势';
                            case 'down': return '下降趋势';
                            default: return '保持稳定';
                        }
                    },

                    // 登录信息保存和加载
                    saveLoginInfo() {
                        if (this.rememberLogin) {
                            // 保存登录信息到localStorage
                            const loginInfo = {
                                email: this.currentForm.email,
                                password: this.currentForm.password,
                                rememberLogin: true
                            };
                            localStorage.setItem('savedLoginInfo', JSON.stringify(loginInfo));
                            console.log('登录信息已保存');
                        } else {
                            // 如果用户取消记住，则清除保存的信息
                            localStorage.removeItem('savedLoginInfo');
                            console.log('登录信息已清除');
                        }
                    },

                    loadSavedLoginInfo() {
                        try {
                            const savedInfo = localStorage.getItem('savedLoginInfo');
                            if (savedInfo) {
                                const loginInfo = JSON.parse(savedInfo);
                                if (loginInfo.rememberLogin) {
                                    // 自动填充登录表单
                                    this.loginForm.email = loginInfo.email;
                                    this.loginForm.password = loginInfo.password;
                                    this.rememberLogin = true;
                                    console.log('已加载保存的登录信息');
                                }
                            }
                        } catch (error) {
                            console.error('加载登录信息失败:', error);
                            // 清除损坏的数据
                            localStorage.removeItem('savedLoginInfo');
                        }
                    },

                    clearSavedLoginInfo() {
                        // 清除保存的登录信息
                        localStorage.removeItem('savedLoginInfo');
                        this.loginForm.email = '';
                        this.loginForm.password = '';
                        this.rememberLogin = false;
                        console.log('登录信息已清除');
                    },

                    // 图表响应式处理
                    handleChartResize() {
                        if (this.tradingChart) {
                            const container = document.getElementById('trading-chart');
                            if (container) {
                                this.tradingChart.applyOptions({
                                    width: container.clientWidth,
                                    height: container.clientHeight,
                                });
                            }
                        }
                    },

                    // 移动端优化：减少图表更新频率
                    throttledChartUpdate() {
                        if (this.chartUpdateTimeout) {
                            clearTimeout(this.chartUpdateTimeout);
                        }
                        this.chartUpdateTimeout = setTimeout(() => {
                            this.updateTradingChart();
                        }, 1000); // 移动端降低更新频率
                    },

                    // 复投机制相关方法
                    resetMartingale() {
                        this.martingaleSettings.currentRound = 0;
                        this.martingaleSettings.currentAmount = 0; // 完全重置时设为0
                        this.martingaleSettings.totalInvested = 0;
                        this.martingaleSettings.totalProfit = 0;
                        this.martingaleSettings.consecutiveLosses = 0;
                        this.martingaleSettings.history = [];
                        this.martingaleSettings.status = 'waiting';
                        this.martingaleSettings.lastResult = null;
                        this.martingaleSettings.nextRoundAmount = this.martingaleSettings.baseAmount;
                        this.martingaleSettings.currentMultiplier = 1;
                        this.martingaleSettings.isInProgress = false;
                        this.saveMartingaleData();
                    },

                    // 状态管理方法
                    getMartingaleStatusClass() {
                        return this.martingaleSettings.status;
                    },

                    getMartingaleStatusIcon() {
                        switch (this.martingaleSettings.status) {
                            case 'waiting': return 'fa-clock';
                            case 'success': return 'fa-check-circle';
                            case 'failed': return 'fa-times-circle';
                            case 'betting': return 'fa-dice';
                            default: return 'fa-clock';
                        }
                    },

                    getMartingaleStatusText() {
                        switch (this.martingaleSettings.status) {
                            case 'waiting': return '等待预测结果';
                            case 'success': return '预测成功，复投停止';
                            case 'failed': return '预测失败，准备复投';
                            case 'betting': return '复投进行中';
                            default: return '等待中';
                        }
                    },

                    getStepClass(round) {
                        if (round < this.martingaleSettings.currentRound) {
                            return 'completed';
                        } else if (round === this.martingaleSettings.currentRound && this.martingaleSettings.status === 'betting') {
                            return 'current';
                        } else if (round === this.martingaleSettings.currentRound && this.martingaleSettings.status === 'failed') {
                            return 'failed';
                        }
                        return '';
                    },

                    updateMartingaleStatus(status) {
                        this.martingaleSettings.status = status;
                        this.saveMartingaleData();
                    },

                    getCurrentBetDisplay() {
                        // 如果当前轮数为0，显示为0
                        if (this.martingaleSettings.currentRound === 0) {
                            return '0.0U';
                        }
                        // 否则显示当前投注金额
                        return this.martingaleSettings.currentAmount.toFixed(1) + 'U';
                    },

                    processMartingaleBet(isWin) {
                        if (!this.martingaleSettings.isActive) return;

                        // 更新预测结果
                        this.martingaleSettings.lastResult = isWin ? 'success' : 'failed';

                        // 如果是第一轮，设置为投注状态
                        if (this.martingaleSettings.currentRound === 0) {
                            this.martingaleSettings.currentRound = 1;
                            this.martingaleSettings.currentAmount = this.martingaleSettings.baseAmount;
                            this.martingaleSettings.currentMultiplier = 1;
                        }

                        const currentAmount = this.martingaleSettings.currentAmount;

                        if (isWin) {
                            // 预测成功 - 停止复投
                            // 先计算总投入（包括当前轮次）
                            const totalInvestedThisRound = this.martingaleSettings.totalInvested + currentAmount;

                            // 获得回报 = 投注金额 * 2（1:1赔率）
                            const totalReturn = currentAmount * 2;

                            // 重新计算总盈亏：总回报 - 总投入
                            this.martingaleSettings.totalProfit = totalReturn - totalInvestedThisRound;

                            this.martingaleSettings.consecutiveLosses = 0;
                            this.martingaleSettings.status = 'success';
                            this.martingaleSettings.isInProgress = false;

                            // 记录历史
                            this.martingaleSettings.history.push({
                                round: this.martingaleSettings.currentRound,
                                amount: currentAmount,
                                result: 'win',
                                profit: this.martingaleSettings.totalProfit,
                                totalReturn: totalReturn,
                                totalInvested: totalInvestedThisRound,
                                timestamp: Date.now()
                            });

                            // 显示成功消息
                            this.showMessage(`🎉 复投成功！第${this.martingaleSettings.currentRound}轮预测正确，净盈利${this.martingaleSettings.totalProfit.toFixed(1)}U`, 'success');

                            // 重置到起始状态（但保持历史和总盈亏）
                            this.resetMartingaleRound();
                        } else {
                            // 预测失败 - 准备下一轮复投
                            // 失败时，先累加总投入
                            this.martingaleSettings.totalInvested += currentAmount;

                            // 失败时，总盈亏 = 0 - 总投入（因为没有任何回报）
                            this.martingaleSettings.totalProfit = -this.martingaleSettings.totalInvested;
                            this.martingaleSettings.consecutiveLosses++;
                            this.martingaleSettings.status = 'failed';

                            // 记录历史
                            this.martingaleSettings.history.push({
                                round: this.martingaleSettings.currentRound,
                                amount: currentAmount,
                                result: 'loss',
                                profit: this.martingaleSettings.totalProfit, // 当前的总盈亏
                                totalReturn: 0, // 失败时没有回报
                                totalInvested: this.martingaleSettings.totalInvested,
                                timestamp: Date.now()
                            });

                            // 检查是否达到最大轮数
                            if (this.martingaleSettings.currentRound >= this.martingaleSettings.maxRounds) {
                                this.showMessage(`⚠️ 已达到最大复投轮数(${this.martingaleSettings.maxRounds}轮)，复投停止`, 'warning');
                                this.resetMartingaleRound();
                                this.martingaleSettings.status = 'waiting';
                            } else {
                                // 准备下一轮复投
                                this.prepareNextMartingaleRound();
                                this.showMessage(`❌ 第${this.martingaleSettings.currentRound}轮失败，下一轮将投注${this.martingaleSettings.nextRoundAmount.toFixed(1)}U`, 'warning');
                            }
                        }

                        this.saveMartingaleData();
                    },

                    resetMartingaleRound() {
                        this.martingaleSettings.currentRound = 0;
                        this.martingaleSettings.currentAmount = 0; // 重置时设为0
                        this.martingaleSettings.nextRoundAmount = this.martingaleSettings.baseAmount;
                        this.martingaleSettings.currentMultiplier = 1;
                        this.martingaleSettings.status = 'waiting';
                        this.martingaleSettings.isInProgress = false;
                        // 注意：不重置总投入和总盈亏，保持历史记录
                    },

                    // 完全重置复投系统（包括总投入和总盈亏）
                    resetMartingaleCompletely() {
                        this.martingaleSettings.currentRound = 0;
                        this.martingaleSettings.currentAmount = 0;
                        this.martingaleSettings.totalInvested = 0;
                        this.martingaleSettings.totalProfit = 0;
                        this.martingaleSettings.consecutiveLosses = 0;
                        this.martingaleSettings.nextRoundAmount = this.martingaleSettings.baseAmount;
                        this.martingaleSettings.currentMultiplier = 1;
                        this.martingaleSettings.status = 'waiting';
                        this.martingaleSettings.isInProgress = false;
                        this.martingaleSettings.history = [];
                        this.martingaleSettings.lastResult = null;
                        this.saveMartingaleData();
                        this.showMessage('复投系统已完全重置', 'info');
                    },

                    // 调试方法：显示当前复投状态
                    debugMartingaleStatus() {
                        console.log('=== 复投状态调试信息 ===');
                        console.log('当前轮数:', this.martingaleSettings.currentRound);
                        console.log('当前投注:', this.martingaleSettings.currentAmount);
                        console.log('总投入:', this.martingaleSettings.totalInvested);
                        console.log('总盈亏:', this.martingaleSettings.totalProfit);
                        console.log('状态:', this.martingaleSettings.status);
                        console.log('是否进行中:', this.martingaleSettings.isInProgress);
                        console.log('========================');
                    },

                    prepareNextMartingaleRound() {
                        this.martingaleSettings.currentRound++;
                        this.martingaleSettings.currentMultiplier = Math.pow(this.martingaleSettings.multiplier, this.martingaleSettings.currentRound - 1);
                        this.martingaleSettings.currentAmount = this.martingaleSettings.baseAmount * this.martingaleSettings.currentMultiplier;

                        // 计算下一轮的投注金额（如果还有下一轮的话）
                        if (this.martingaleSettings.currentRound < this.martingaleSettings.maxRounds) {
                            this.martingaleSettings.nextRoundAmount =
                                this.martingaleSettings.baseAmount * Math.pow(this.martingaleSettings.multiplier, this.martingaleSettings.currentRound);
                        }

                        this.martingaleSettings.status = 'betting';
                        this.martingaleSettings.isInProgress = true;
                    },

                    // 开始预测时调用
                    startMartingalePrediction() {
                        if (!this.martingaleSettings.isActive) return;

                        if (this.martingaleSettings.currentRound === 0) {
                            // 第一轮
                            this.martingaleSettings.currentRound = 1;
                            this.martingaleSettings.currentAmount = this.martingaleSettings.baseAmount;
                            this.martingaleSettings.currentMultiplier = 1;
                            this.martingaleSettings.nextRoundAmount = this.martingaleSettings.baseAmount * this.martingaleSettings.multiplier;
                        }

                        this.martingaleSettings.status = 'betting';
                        this.martingaleSettings.isInProgress = true;
                        this.saveMartingaleData();
                    },

                    // 计算器相关方法
                    calculateMartingale() {
                        this.calculator.results = [];
                        let totalInvested = 0;

                        for (let round = 1; round <= this.calculator.rounds; round++) {
                            const amount = this.calculator.baseAmount * Math.pow(this.calculator.multiplier, round - 1);
                            totalInvested += amount;

                            // 马丁格尔策略：如果在这一轮成功，获得的总回报是当前投注金额的2倍（1:1赔率）
                            // 净盈利 = 获得回报 - 总投入 = (amount * 2) - totalInvested = amount * 2 - totalInvested
                            const totalReturn = amount * 2; // 假设1:1赔率，投注amount，成功获得amount*2
                            const netProfit = totalReturn - totalInvested; // 净盈利

                            this.calculator.results.push({
                                round: round,
                                amount: amount,
                                totalInvested: totalInvested,
                                profit: netProfit,
                                totalReturn: totalReturn,
                                profitRate: ((netProfit / totalInvested) * 100) // 盈利率
                            });
                        }
                    },

                    getMaxInvestment() {
                        if (this.calculator.results.length === 0) {
                            this.calculateMartingale();
                        }
                        const lastResult = this.calculator.results[this.calculator.results.length - 1];
                        return lastResult ? lastResult.totalInvested.toFixed(1) : '0.0';
                    },

                    getBestCaseProfit() {
                        if (this.calculator.results.length === 0) {
                            this.calculateMartingale();
                        }
                        // 最佳情况是第一轮就成功
                        const firstResult = this.calculator.results[0];
                        return firstResult ? '+' + firstResult.profit.toFixed(1) : '+0.0';
                    },

                    getWorstCaseProfit() {
                        if (this.calculator.results.length === 0) {
                            this.calculateMartingale();
                        }
                        // 最差情况是最后一轮才成功
                        const lastResult = this.calculator.results[this.calculator.results.length - 1];
                        return lastResult ? (lastResult.profit >= 0 ? '+' : '') + lastResult.profit.toFixed(1) : '0.0';
                    },

                    applyCalculatorSettings() {
                        this.martingaleSettings.baseAmount = this.calculator.baseAmount;
                        this.martingaleSettings.multiplier = this.calculator.multiplier;
                        this.martingaleSettings.maxRounds = this.calculator.rounds;
                        this.resetMartingale();
                        this.calculator.visible = false;
                        this.showMessage('复投设置已应用', 'success');
                    },

                    saveMartingaleData() {
                        localStorage.setItem('martingaleSettings', JSON.stringify(this.martingaleSettings));
                    },

                    loadMartingaleData() {
                        const saved = localStorage.getItem('martingaleSettings');
                        if (saved) {
                            const data = JSON.parse(saved);
                            this.martingaleSettings = { ...this.martingaleSettings, ...data };
                        }

                        // 确保新字段有默认值
                        if (!this.martingaleSettings.status) {
                            this.martingaleSettings.status = 'waiting';
                        }
                        if (!this.martingaleSettings.nextRoundAmount) {
                            this.martingaleSettings.nextRoundAmount = this.martingaleSettings.baseAmount;
                        }
                        if (!this.martingaleSettings.currentMultiplier) {
                            this.martingaleSettings.currentMultiplier = 1;
                        }
                        if (this.martingaleSettings.isInProgress === undefined) {
                            this.martingaleSettings.isInProgress = false;
                        }

                        // 初始化计算器数据
                        this.calculator.baseAmount = this.martingaleSettings.baseAmount;
                        this.calculator.multiplier = this.martingaleSettings.multiplier;
                        this.calculator.rounds = this.martingaleSettings.maxRounds;
                        this.calculateMartingale();
                    },

                    getExchangeName(exchange) {
                        const exchangeObj = this.exchanges.find(ex => ex.id === exchange);
                        return exchangeObj ? exchangeObj.name : exchange;
                    },

                    getExchangeIcon(exchange) {
                        const exchangeObj = this.exchanges.find(ex => ex.id === exchange);
                        return exchangeObj ? exchangeObj.icon : exchange.charAt(0).toUpperCase();
                    },

                    getExchangeColor(exchange) {
                        const exchangeObj = this.exchanges.find(ex => ex.id === exchange);
                        return exchangeObj ? exchangeObj.color : '#667eea';
                    },

                    isHigherThanReference(exchange, price) {
                        if (exchange === this.selectedExchange) return false;
                        const referenceData = this.marketData[this.selectedSymbol]?.[this.selectedExchange];
                        return referenceData && price > referenceData.price;
                    },

                    isLowerThanReference(exchange, price) {
                        if (exchange === this.selectedExchange) return false;
                        const referenceData = this.marketData[this.selectedSymbol]?.[this.selectedExchange];
                        return referenceData && price < referenceData.price;
                    },

                    getPriceDifference(exchange, price) {
                        if (exchange === this.selectedExchange) return '';
                        const referenceData = this.marketData[this.selectedSymbol]?.[this.selectedExchange];
                        if (!referenceData) return '';

                        const diff = price - referenceData.price;
                        const diffPercent = (diff / referenceData.price) * 100;
                        const sign = diff > 0 ? '+' : '';

                        return `${sign}$${diff.toFixed(2)} (${sign}${diffPercent.toFixed(2)}%)`;
                    },

                    // 数据源指示器相关方法
                    getDataSourceIcon() {
                        switch (this.dataSource) {
                            case 'loading':
                                return 'fa-spinner fa-spin';
                            case 'real':
                                return 'fa-wifi';
                            case 'mock':
                                return 'fa-exclamation-triangle';
                            default:
                                return 'fa-question';
                        }
                    },

                    getDataSourceText() {
                        switch (this.dataSource) {
                            case 'loading':
                                return '加载中';
                            case 'real':
                                return '实时数据';
                            case 'mock':
                                return '模拟数据';
                            default:
                                return '未知';
                        }
                    },

                    getDataSourceTitle() {
                        switch (this.dataSource) {
                            case 'loading':
                                return '正在加载市场数据...';
                            case 'real':
                                return '当前使用币安API实时数据，BTC价格约11万U';
                            case 'mock':
                                return '无法连接API，使用模拟数据（价格可能不准确）';
                            default:
                                return '数据源状态未知';
                        }
                    },

                    getMembershipName(level) {
                        const names = {
                            trial: '试用版',
                            basic: '基础版',
                            pro: '专业版',
                            premium: '旗舰版'
                        };
                        return names[level] || level;
                    },

                    getTrialTimeLeft() {
                        // 模拟试用期剩余时间
                        return '23小时45分钟';
                    },

                    selectPlan(plan) {
                        alert(`您选择了${plan.name}套餐，价格：¥${plan.price}/月`);
                    },

                    // 主题相关方法
                    initTheme() {
                        // 从localStorage读取主题设置
                        const savedTheme = localStorage.getItem('theme');
                        if (savedTheme) {
                            this.isDarkMode = savedTheme === 'dark';
                        } else {
                            // 检测系统主题偏好
                            this.isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                        }
                        this.applyTheme();
                    },

                    toggleTheme() {
                        this.isDarkMode = !this.isDarkMode;
                        this.applyTheme();
                        localStorage.setItem('theme', this.isDarkMode ? 'dark' : 'light');

                        // 更新交易图表主题
                        if (this.currentView === 'trading' && this.tradingChart) {
                            this.$nextTick(() => {
                                this.updateTradingChartTheme();
                            });
                        }
                    },

                    applyTheme() {
                        if (this.isDarkMode) {
                            document.documentElement.setAttribute('data-theme', 'dark');
                        } else {
                            document.documentElement.removeAttribute('data-theme');
                        }
                    },

                    // 交易策略相关方法
                    selectStrategy(strategy) {
                        this.selectedStrategy = strategy;
                    },

                    getRiskLevelColor(riskLevel) {
                        switch (riskLevel) {
                            case 'low': return '#28a745';
                            case 'medium': return '#ffc107';
                            case 'high': return '#dc3545';
                            default: return '#6c757d';
                        }
                    },

                    getRiskLevelText(riskLevel) {
                        switch (riskLevel) {
                            case 'low': return '低风险';
                            case 'medium': return '中风险';
                            case 'high': return '高风险';
                            default: return '未知风险';
                        }
                    },

                    // 策略参数设置
                    setStrategyParams() {
                        // 这里可以添加策略参数设置的逻辑
                        console.log('策略参数设置:', this.strategyParams);
                    },

                    // AI策略分析
                    analyzeStrategy() {
                        if (!this.selectedStrategy) return;

                        console.log('AI策略分析:', this.selectedStrategy, this.strategyParams);

                        // 获取当前市场数据
                        const currentPrice = this.getCurrentPrice();
                        const marketData = this.marketData[this.selectedSymbol]?.[this.selectedExchange];

                        if (!marketData || !currentPrice) {
                            this.strategyAnalysis = {
                                summary: '无法获取市场数据，请检查网络连接',
                                recommendation: '请稍后重试',
                                riskLevel: 'unknown'
                            };
                            return;
                        }

                        let analysis = {};

                        if (this.selectedStrategy === 'ma_cross') {
                            analysis = this.analyzeMACrossStrategy(currentPrice, marketData);
                        } else if (this.selectedStrategy === 'momentum') {
                            analysis = this.analyzeMomentumStrategy(currentPrice, marketData);
                        }

                        this.strategyAnalysis = analysis;

                        // 生成策略信号
                        this.generateStrategySignals();
                    },

                    // 均线交叉策略分析
                    analyzeMACrossStrategy(currentPrice, marketData) {
                        const { shortPeriod, longPeriod, rsiThreshold } = this.strategyParams.maCross;

                        // 计算均线（模拟数据）
                        const shortMA = this.calculateMovingAverage(currentPrice, shortPeriod);
                        const longMA = this.calculateMovingAverage(currentPrice, longPeriod);
                        const rsi = this.calculateRSI(currentPrice, marketData);

                        // 判断均线交叉
                        const isGoldenCross = shortMA > longMA;
                        const isDeathCross = shortMA < longMA;

                        // 计算趋势强度
                        const trendStrength = Math.abs(shortMA - longMA) / longMA * 100;

                        // AI增强分析
                        let summary = '';
                        let recommendation = '';
                        let riskLevel = 'medium';

                        if (isGoldenCross && rsi > rsiThreshold) {
                            summary = `短期均线(${shortPeriod}日)已上穿长期均线(${longPeriod}日)，形成金叉信号。RSI为${rsi.toFixed(1)}，处于${rsi > 70 ? '超买' : '正常'}区间。`;
                            recommendation = '趋势向上，建议关注买入机会，但需注意风险控制。';
                            riskLevel = rsi > 70 ? 'high' : 'medium';
                        } else if (isDeathCross && rsi < rsiThreshold) {
                            summary = `短期均线(${shortPeriod}日)已下穿长期均线(${longPeriod}日)，形成死叉信号。RSI为${rsi.toFixed(1)}，处于${rsi < 30 ? '超卖' : '正常'}区间。`;
                            recommendation = '趋势向下，建议观望或考虑减仓。';
                            riskLevel = rsi < 30 ? 'medium' : 'high';
                        } else {
                            summary = `均线处于${isGoldenCross ? '多头' : '空头'}排列，RSI为${rsi.toFixed(1)}。趋势强度：${trendStrength.toFixed(2)}%。`;
                            recommendation = '市场处于盘整状态，建议等待明确信号。';
                            riskLevel = 'low';
                        }

                        return {
                            summary,
                            recommendation,
                            riskLevel,
                            signals: {
                                goldenCross: isGoldenCross,
                                deathCross: isDeathCross,
                                rsi: rsi,
                                trendStrength: trendStrength,
                                shortMA: shortMA,
                                longMA: longMA
                            }
                        };
                    },

                    // 动量反弹策略分析
                    analyzeMomentumStrategy(currentPrice, marketData) {
                        const { oversoldRsi, dropThreshold, confirmationDays } = this.strategyParams.momentum;

                        // 计算技术指标
                        const rsi = this.calculateRSI(currentPrice, marketData);
                        const priceChange = this.calculatePriceChange(currentPrice, marketData);
                        const volumeChange = this.calculateVolumeChange(marketData);

                        // 判断超卖条件
                        const isOversold = rsi < oversoldRsi;
                        const hasSignificantDrop = Math.abs(priceChange) > dropThreshold;
                        const hasVolumeIncrease = volumeChange > 0.2; // 成交量增加20%

                        // AI增强分析
                        let summary = '';
                        let recommendation = '';
                        let riskLevel = 'medium';

                        if (isOversold && hasSignificantDrop) {
                            if (hasVolumeIncrease) {
                                summary = `RSI为${rsi.toFixed(1)}，处于超卖区间。价格已下跌${Math.abs(priceChange).toFixed(2)}%，成交量增加${(volumeChange * 100).toFixed(1)}%。`;
                                recommendation = '超卖反弹信号强烈，建议关注反弹机会，设置止损位。';
                                riskLevel = 'medium';
                            } else {
                                summary = `RSI为${rsi.toFixed(1)}，处于超卖区间。价格已下跌${Math.abs(priceChange).toFixed(2)}%，但成交量未明显放大。`;
                                recommendation = '超卖信号存在，但需等待成交量确认，建议谨慎操作。';
                                riskLevel = 'high';
                            }
                        } else if (isOversold) {
                            summary = `RSI为${rsi.toFixed(1)}，处于超卖区间，但价格跌幅${Math.abs(priceChange).toFixed(2)}%未达到阈值。`;
                            recommendation = '超卖程度不足，建议继续观望。';
                            riskLevel = 'low';
                        } else {
                            summary = `RSI为${rsi.toFixed(1)}，未处于超卖区间。当前价格变化：${priceChange > 0 ? '+' : ''}${priceChange.toFixed(2)}%。`;
                            recommendation = '市场未出现超卖信号，建议等待更好的入场机会。';
                            riskLevel = 'low';
                        }

                        return {
                            summary,
                            recommendation,
                            riskLevel,
                            signals: {
                                isOversold,
                                hasSignificantDrop,
                                hasVolumeIncrease,
                                rsi,
                                priceChange,
                                volumeChange
                            }
                        };
                    },

                    // 计算移动平均线
                    calculateMovingAverage(currentPrice, period) {
                        // 模拟历史价格数据计算均线
                        const basePrice = currentPrice;
                        let sum = 0;

                        for (let i = 0; i < period; i++) {
                            // 模拟历史价格，添加一些随机波动
                            const historicalPrice = basePrice * (1 + (Math.random() - 0.5) * 0.1);
                            sum += historicalPrice;
                        }

                        return sum / period;
                    },

                    // 计算RSI指标
                    calculateRSI(currentPrice, marketData) {
                        // 模拟RSI计算
                        const basePrice = marketData?.price || currentPrice;
                        const priceChange = ((currentPrice - basePrice) / basePrice) * 100;

                        // 基于价格变化计算RSI
                        if (priceChange > 0) {
                            return Math.min(100, 50 + priceChange * 2);
                        } else {
                            return Math.max(0, 50 + priceChange * 2);
                        }
                    },

                    // 计算价格变化
                    calculatePriceChange(currentPrice, marketData) {
                        const basePrice = marketData?.price || currentPrice;
                        return ((currentPrice - basePrice) / basePrice) * 100;
                    },

                    // 计算成交量变化
                    calculateVolumeChange(marketData) {
                        // 模拟成交量变化
                        return (Math.random() - 0.5) * 0.4; // -20% 到 +20%
                    },

                    // 生成策略信号
                    generateStrategySignals() {
                        if (!this.strategyAnalysis) return;

                        const signals = this.strategyAnalysis.signals;

                        if (this.selectedStrategy === 'ma_cross') {
                            this.strategySignals.maCross = {
                                signal: signals.goldenCross ? 'BUY' : signals.deathCross ? 'SELL' : 'HOLD',
                                strength: signals.trendStrength,
                                rsi: signals.rsi,
                                timestamp: Date.now()
                            };
                        } else if (this.selectedStrategy === 'momentum') {
                            this.strategySignals.momentum = {
                                signal: signals.isOversold && signals.hasSignificantDrop ? 'BUY' : 'HOLD',
                                strength: Math.abs(signals.priceChange),
                                rsi: signals.rsi,
                                timestamp: Date.now()
                            };
                        }
                    },

                    // 策略信号变化监听
                    watchStrategySignals() {
                        // 监听策略信号变化，可以用于自动交易或提醒
                        if (this.strategySignals.maCross) {
                            console.log('均线交叉策略信号:', this.strategySignals.maCross);
                        }
                        if (this.strategySignals.momentum) {
                            console.log('动量反弹策略信号:', this.strategySignals.momentum);
                        }
                    },

                    // 清除策略分析
                    clearStrategyAnalysis() {
                        this.strategyAnalysis = null;
                        this.strategySignals.maCross = null;
                        this.strategySignals.momentum = null;
                        console.log('策略分析已清除');
                    },

                    // 策略参数验证
                    validateStrategyParams() {
                        if (!this.selectedStrategy) return false;

                        if (this.selectedStrategy === 'ma_cross') {
                            const { shortPeriod, longPeriod } = this.strategyParams.maCross;
                            if (shortPeriod >= longPeriod) {
                                alert('短期均线周期必须小于长期均线周期');
                                return false;
                            }
                        }

                        return true;
                    },

                    // 自动策略分析（定时执行）
                    startAutoStrategyAnalysis() {
                        if (this.autoAnalysisInterval) {
                            clearInterval(this.autoAnalysisInterval);
                        }

                        // 每5分钟自动分析一次策略
                        this.autoAnalysisInterval = setInterval(() => {
                            if (this.selectedStrategy && this.validateStrategyParams()) {
                                this.analyzeStrategy();
                            }
                        }, 5 * 60 * 1000);
                    },

                    // 停止自动策略分析
                    stopAutoStrategyAnalysis() {
                        if (this.autoAnalysisInterval) {
                            clearInterval(this.autoAnalysisInterval);
                            this.autoAnalysisInterval = null;
                        }
                    },

                    // 切换自动策略分析
                    toggleAutoAnalysis() {
                        if (this.autoStrategyAnalysis) {
                            this.startAutoStrategyAnalysis();
                            console.log('自动策略分析已启动');
                        } else {
                            this.stopAutoStrategyAnalysis();
                            console.log('自动策略分析已停止');
                        }
                    },

                    // 策略整合分析方法
                    getStrategySignalText() {
                        if (!this.selectedStrategy || !this.strategySignals) return '无策略信号';

                        if (this.selectedStrategy === 'ma_cross' && this.strategySignals.maCross) {
                            const signal = this.strategySignals.maCross.signal;
                            return signal === 'BUY' ? '🟢 买入信号' : signal === 'SELL' ? '🔴 卖出信号' : '⚪ 观望信号';
                        } else if (this.selectedStrategy === 'momentum' && this.strategySignals.momentum) {
                            const signal = this.strategySignals.momentum.signal;
                            return signal === 'BUY' ? '🟢 反弹信号' : '⚪ 等待信号';
                        }

                        return '无策略信号';
                    },

                    getPredictionSummary() {
                        if (!this.latestPrediction) return '无预测数据';

                        const timeframes = Object.keys(this.latestPrediction);
                        const upCount = timeframes.filter(tf => this.latestPrediction[tf].direction === 'up').length;
                        const downCount = timeframes.filter(tf => this.latestPrediction[tf].direction === 'down').length;

                        if (upCount > downCount) {
                            return `📈 偏上涨 (${upCount}/${timeframes.length})`;
                        } else if (downCount > upCount) {
                            return `📉 偏下跌 (${downCount}/${timeframes.length})`;
                        } else {
                            return `➡️ 中性 (${upCount}/${timeframes.length})`;
                        }
                    },

                    getCombinedRecommendation() {
                        if (!this.selectedStrategy || !this.strategyAnalysis || !this.latestPrediction) {
                            return '需要更多数据';
                        }

                        const strategySignal = this.getStrategySignalText();
                        const predictionSummary = this.getPredictionSummary();

                        // 策略信号与AI预测的一致性分析
                        const isConsistent = this.isStrategyPredictionConsistent();

                        if (isConsistent) {
                            return '🎯 信号一致，建议执行';
                        } else {
                            return '⚠️ 信号分歧，建议谨慎';
                        }
                    },

                    getStrategyInsight() {
                        if (!this.selectedStrategy || !this.strategyAnalysis) {
                            return '请先选择策略并进行分析';
                        }

                        const strategy = this.selectedStrategy;
                        const analysis = this.strategyAnalysis;

                        if (strategy === 'ma_cross') {
                            if (analysis.signals?.goldenCross) {
                                return '均线金叉信号确认，趋势向上，建议关注买入机会，但需注意RSI超买风险';
                            } else if (analysis.signals?.deathCross) {
                                return '均线死叉信号确认，趋势向下，建议观望或减仓，关注RSI超卖反弹机会';
                            } else {
                                return '均线处于盘整状态，建议等待明确趋势信号';
                            }
                        } else if (strategy === 'momentum') {
                            if (analysis.signals?.isOversold && analysis.signals?.hasSignificantDrop) {
                                return '超卖反弹信号强烈，建议关注反弹机会，设置合理止损位';
                            } else if (analysis.signals?.isOversold) {
                                return 'RSI超卖但跌幅不足，建议等待更好的入场机会';
                            } else {
                                return '未出现超卖信号，建议继续观望或寻找其他机会';
                            }
                        }

                        return '策略分析完成，请结合市场情况做出交易决策';
                    },

                    // 判断策略信号与AI预测是否一致
                    isStrategyPredictionConsistent() {
                        if (!this.selectedStrategy || !this.strategySignals || !this.latestPrediction) {
                            return false;
                        }

                        const strategy = this.selectedStrategy;
                        const signals = this.strategySignals;
                        const prediction = this.latestPrediction;

                        if (strategy === 'ma_cross' && signals.maCross) {
                            const strategyDirection = signals.maCross.signal === 'BUY' ? 'up' : 'down';
                            const predictionDirection = this.getPredictionDirection(prediction);
                            return strategyDirection === predictionDirection;
                        } else if (strategy === 'momentum' && signals.momentum) {
                            const strategyDirection = signals.momentum.signal === 'BUY' ? 'up' : 'neutral';
                            const predictionDirection = this.getPredictionDirection(prediction);
                            return strategyDirection === predictionDirection || predictionDirection === 'neutral';
                        }

                        return false;
                    },

                    // 获取预测的主要方向
                    getPredictionDirection(prediction) {
                        if (!prediction) return 'neutral';

                        const timeframes = Object.keys(prediction);
                        const upCount = timeframes.filter(tf => prediction[tf].direction === 'up').length;
                        const downCount = timeframes.filter(tf => prediction[tf].direction === 'down').length;

                        if (upCount > downCount) return 'up';
                        if (downCount > upCount) return 'down';
                        return 'neutral';
                    },

                    // 初始化策略相关功能
                    initStrategyFeatures() {
                        console.log('初始化交易策略功能...');

                        // 设置默认策略参数
                        this.strategyParams.maCross = {
                            shortPeriod: 5,
                            longPeriod: 20,
                            rsiThreshold: 50
                        };

                        this.strategyParams.momentum = {
                            oversoldRsi: 30,
                            dropThreshold: 10,
                            confirmationDays: 3
                        };

                        // 启动策略信号监听
                        this.watchStrategySignals();

                        console.log('交易策略功能初始化完成');
                    }
                }
            }).mount('#app');

            // 初始化TradingView图表
            function initTradingViewChart() {
                const chartContainer = document.getElementById('tradingview-chart');
                if (!chartContainer) return;

                // 获取当前主题
                function getChartTheme() {
                    const isDark = document.documentElement.hasAttribute('data-theme');
                    return isDark ? 'dark' : 'light';
                }

                // 创建图表实例
                const chart = LightweightCharts.createChart(chartContainer, {
                    width: chartContainer.clientWidth,
                    height: chartContainer.clientHeight,
                    layout: {
                        background: { color: getChartTheme() === 'dark' ? '#1e1e1e' : '#ffffff' },
                        textColor: getChartTheme() === 'dark' ? '#ffffff' : '#333333',
                    },
                    grid: {
                        vertLines: { color: getChartTheme() === 'dark' ? '#404040' : '#f0f0f0' },
                        horzLines: { color: getChartTheme() === 'dark' ? '#404040' : '#f0f0f0' },
                    },
                    crosshair: {
                        mode: LightweightCharts.CrosshairMode.Normal,
                    },
                    rightPriceScale: {
                        borderColor: getChartTheme() === 'dark' ? '#404040' : '#cccccc',
                    },
                    timeScale: {
                        borderColor: getChartTheme() === 'dark' ? '#404040' : '#cccccc',
                        timeVisible: true,
                        secondsVisible: false,
                    },
                });

                // 创建K线图系列
                const candlestickSeries = chart.addCandlestickSeries({
                    upColor: '#26a69a',
                    downColor: '#ef5350',
                    borderVisible: false,
                    wickUpColor: '#26a69a',
                    wickDownColor: '#ef5350',
                });

                // 创建成交量系列
                const volumeSeries = chart.addHistogramSeries({
                    color: '#26a69a',
                    priceFormat: {
                        type: 'volume',
                    },
                    priceScaleId: '',
                    scaleMargins: {
                        top: 0.8,
                        bottom: 0,
                    },
                });

                // 生成模拟K线数据
                function generateCandlestickData() {
                    const data = [];
                    let basePrice = 42000; // BTC基础价格
                    let currentTime = Math.floor(Date.now() / 1000);

                    for (let i = 0; i < 100; i++) {
                        const time = currentTime - (100 - i) * 3600; // 每小时一个数据点
                        const open = basePrice + (Math.random() - 0.5) * 2000;
                        const high = open + Math.random() * 1000;
                        const low = open - Math.random() * 1000;
                        const close = open + (Math.random() - 0.5) * 800;
                        const volume = Math.random() * 1000 + 500;

                        data.push({
                            time: time,
                            open: open,
                            high: high,
                            low: low,
                            close: close,
                        });

                        // 为成交量数据
                        volumeData.push({
                            time: time,
                            value: volume,
                            color: close > open ? '#26a69a' : '#ef5350',
                        });

                        basePrice = close;
                    }
                    return data;
                }

                // 生成模拟成交量数据
                const volumeData = [];
                const candlestickData = generateCandlestickData();

                // 设置数据
                candlestickSeries.setData(candlestickData);
                volumeSeries.setData(volumeData);

                // 响应式调整
                function resizeChart() {
                    chart.applyOptions({
                        width: chartContainer.clientWidth,
                        height: chartContainer.clientHeight,
                    });
                }

                // 主题切换处理
                function updateChartTheme() {
                    const isDark = getChartTheme() === 'dark';
                    chart.applyOptions({
                        layout: {
                            background: { color: isDark ? '#1e1e1e' : '#ffffff' },
                            textColor: isDark ? '#ffffff' : '#333333',
                        },
                        grid: {
                            vertLines: { color: isDark ? '#404040' : '#f0f0f0' },
                            horzLines: { color: isDark ? '#404040' : '#f0f0f0' },
                        },
                        rightPriceScale: {
                            borderColor: isDark ? '#404040' : '#cccccc',
                        },
                        timeScale: {
                            borderColor: isDark ? '#404040' : '#cccccc',
                        },
                    });
                }

                // 监听主题变化
                const observer = new MutationObserver(updateChartTheme);
                observer.observe(document.documentElement, {
                    attributes: true,
                    attributeFilter: ['data-theme']
                });

                window.addEventListener('resize', resizeChart);

                // 返回图表实例以便后续更新
                return {
                    chart,
                    candlestickSeries,
                    volumeSeries,
                    updateData: (newData) => {
                        if (newData && newData.length > 0) {
                            candlestickSeries.update(newData[newData.length - 1]);
                        }
                    },
                    updateTheme: updateChartTheme,
                    updateSymbol: (symbol) => {
                        // 根据交易对更新图表数据
                        let basePrice = symbol === 'BTCUSDT' ? 42000 : 2400; // ETH基础价格
                        const newData = [];
                        const newVolumeData = [];
                        let currentTime = Math.floor(Date.now() / 1000);

                        for (let i = 0; i < 100; i++) {
                            const time = currentTime - (100 - i) * 3600;
                            const open = basePrice + (Math.random() - 0.5) * (symbol === 'BTCUSDT' ? 2000 : 200);
                            const high = open + Math.random() * (symbol === 'BTCUSDT' ? 1000 : 100);
                            const low = open - Math.random() * (symbol === 'BTCUSDT' ? 1000 : 100);
                            const close = open + (Math.random() - 0.5) * (symbol === 'BTCUSDT' ? 800 : 80);
                            const volume = Math.random() * 1000 + 500;

                            newData.push({
                                time: time,
                                open: open,
                                high: high,
                                low: low,
                                close: close,
                            });

                            newVolumeData.push({
                                time: time,
                                value: volume,
                                color: close > open ? '#26a69a' : '#ef5350',
                            });

                            basePrice = close;
                        }

                        candlestickSeries.setData(newData);
                        volumeSeries.setData(newVolumeData);
                    },
                    updateTimeframe: (seconds, dataPoints) => {
                        // 更新图表的时间框架
                        chart.applyOptions({
                            timeScale: {
                                timeVisible: true,
                                secondsVisible: false,
                                rightOffset: 0,
                                barSpacing: 2,
                                fixLeftEdge: true,
                                lockVisibleTimeRangeOnResize: true,
                                rightBarStaysOnScroll: true,
                                timeScaleMargins: {
                                    top: 0.2,
                                    bottom: 0.2,
                                },
                                tickMarkSpacing: 10,
                                tickMarkFormatter: (time, tickMarkInfo) => {
                                    const date = new Date(time * 1000);
                                    return `${date.getHours()}:${date.getMinutes()}`;
                                },
                                minBarSpacing: 1,
                                tickSize: 5,
                                borderColor: getChartTheme() === 'dark' ? '#404040' : '#cccccc',
                                borderVisible: true,
                                visible: true,
                                timeVisible: true,
                                secondsVisible: false,
                                secondsBarSpacing: 10,
                                secondsBarColor: getChartTheme() === 'dark' ? '#404040' : '#cccccc',
                                secondsBarWidth: 1,
                                secondsVisible: false,
                                secondsBarSpacing: 10,
                                secondsBarColor: getChartTheme() === 'dark' ? '#404040' : '#cccccc',
                                secondsBarWidth: 1,
                            },
                            rightPriceScale: {
                                borderColor: getChartTheme() === 'dark' ? '#404040' : '#cccccc',
                            },
                        });
                    }
                };
            }

            // 等待DOM加载完成后初始化图表
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(() => {
                    window.tradingViewChart = initTradingViewChart();
                }, 1000);
            });
        </script>

        <!-- 模态框样式 -->
        <style>
            .modal-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
            }

            .modal-content {
                background: var(--bg-secondary);
                border-radius: 12px;
                width: 90%;
                max-width: 400px;
                max-height: 90vh;
                overflow-y: auto;
                color: var(--text-primary);
                border: 1px solid var(--border-color);
            }

            .modal-header {
                padding: 1.5rem;
                border-bottom: 1px solid var(--border-color);
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .modal-body {
                padding: 1.5rem;
            }

            .close-btn {
                background: none;
                border: none;
                font-size: 1.5rem;
                cursor: pointer;
                color: var(--text-secondary);
            }

            .form-group {
                margin-bottom: 1rem;
            }

            .form-group label {
                display: block;
                margin-bottom: 0.5rem;
                font-weight: 500;
            }

            .form-group input {
                width: 100%;
                padding: 0.75rem;
                border: 1px solid var(--border-color);
                border-radius: 6px;
                font-size: 1rem;
                background: var(--bg-secondary);
                color: var(--text-primary);
            }

            .form-group input:focus {
                outline: none;
                border-color: #667eea;
                box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
            }
        </style>

        <!-- 移动端触摸优化脚本 -->
        <script>
            // 移动端触摸优化
            document.addEventListener('DOMContentLoaded', function () {
                // 防止双击缩放
                let lastTouchEnd = 0;
                document.addEventListener('touchend', function (event) {
                    const now = (new Date()).getTime();
                    if (now - lastTouchEnd <= 300) {
                        event.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);

                // 触摸反馈优化
                const touchElements = document.querySelectorAll('.nav-item, .data-source-indicator, .theme-toggle');
                touchElements.forEach(element => {
                    element.addEventListener('touchstart', function () {
                        this.style.transform = 'scale(0.98)';
                        this.style.transition = 'transform 0.1s ease';
                    });

                    element.addEventListener('touchend', function () {
                        this.style.transform = '';
                        this.style.transition = '';
                    });
                });

                // 移动端视口优化
                if (window.innerWidth <= 768) {
                    const viewport = document.querySelector('meta[name="viewport"]');
                    if (viewport) {
                        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0');
                    }
                }

                // 键盘支持
                document.addEventListener('keydown', function (e) {
                    if (e.key === 'Enter' && document.activeElement.classList.contains('nav-item')) {
                        document.activeElement.click();
                    }
                });

                // 移动端滚动优化
                let isScrolling = false;
                document.addEventListener('touchmove', function () {
                    isScrolling = true;
                    setTimeout(() => {
                        isScrolling = false;
                    }, 100);
                });

                // 优化触摸事件
                document.addEventListener('touchstart', function () {
                    if (isScrolling) return;
                    // 触摸开始处理
                }, { passive: true });
            });

            // 移动端性能优化
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', function () {
                    // 可以在这里注册Service Worker
                });
            }

            // 移动端网络状态检测
            window.addEventListener('online', function () {
                console.log('网络已连接');
            });

            window.addEventListener('offline', function () {
                console.log('网络已断开');
            });
        </script>
    </body>

</html>
