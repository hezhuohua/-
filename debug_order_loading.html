<!DOCTYPE html>
<html lang="zh-CN">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>è®¢å•åŠ è½½è°ƒè¯•</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 20px;
                background: #1a1a1a;
                color: #fff;
            }

            .debug-panel {
                background: #2a2a2a;
                padding: 20px;
                border-radius: 8px;
                margin-bottom: 20px;
            }

            .test-button {
                background: #00f3ff;
                color: #000;
                border: none;
                padding: 10px 20px;
                border-radius: 4px;
                cursor: pointer;
                margin: 5px;
            }

            .test-button:hover {
                background: #00d4e0;
            }

            .result {
                background: #333;
                padding: 10px;
                border-radius: 4px;
                margin: 10px 0;
                white-space: pre-wrap;
            }

            .success {
                border-left: 4px solid #4CAF50;
            }

            .error {
                border-left: 4px solid #f44336;
            }

            .info {
                border-left: 4px solid #2196F3;
            }
        </style>
    </head>

    <body>
        <h1>ğŸ”§ è®¢å•åŠ è½½è°ƒè¯•å·¥å…·</h1>

        <div class="debug-panel">
            <h2>é…ç½®æ£€æŸ¥</h2>
            <button class="test-button" onclick="checkConfig()">æ£€æŸ¥é…ç½®</button>
            <div id="configResult" class="result"></div>
        </div>

        <div class="debug-panel">
            <h2>APIæµ‹è¯•</h2>
            <button class="test-button" onclick="testManualOrders()">æµ‹è¯•æ‰‹åŠ¨è®¢å•API</button>
            <button class="test-button" onclick="testQuantifiedOrders()">æµ‹è¯•é‡åŒ–è®¢å•API</button>
            <div id="apiResult" class="result"></div>
        </div>

        <div class="debug-panel">
            <h2>ç½‘ç»œè¯·æ±‚</h2>
            <button class="test-button" onclick="testNetworkRequests()">æµ‹è¯•ç½‘ç»œè¯·æ±‚</button>
            <div id="networkResult" class="result"></div>
        </div>

        <script>
            // æ¨¡æ‹ŸtradingApiConfig
            let tradingApiConfig = {
                apiKey: '',
                apiSecret: '',
                testnet: true,
                connected: false,
                userId: 'test_user_001'
            };

            function log(message, type = 'info') {
                const resultDiv = document.getElementById(type + 'Result');
                const timestamp = new Date().toLocaleTimeString();
                resultDiv.innerHTML += `[${timestamp}] ${message}\n`;
                resultDiv.scrollTop = resultDiv.scrollHeight;
            }

            function checkConfig() {
                log('=== é…ç½®æ£€æŸ¥ ===', 'config');
                log(`ç”¨æˆ·ID: ${tradingApiConfig.userId}`, 'config');
                log(`API Key: ${tradingApiConfig.apiKey ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®'}`, 'config');
                log(`API Secret: ${tradingApiConfig.apiSecret ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®'}`, 'config');
                log(`æµ‹è¯•ç½‘: ${tradingApiConfig.testnet}`, 'config');
                log(`è¿æ¥çŠ¶æ€: ${tradingApiConfig.connected}`, 'config');
            }

            async function testManualOrders() {
                log('=== æµ‹è¯•æ‰‹åŠ¨è®¢å•API ===', 'api');
                try {
                    const response = await fetch(`/api/manual-orders/${tradingApiConfig.userId}?limit=10&status=all`);
                    log(`HTTPçŠ¶æ€: ${response.status} ${response.statusText}`, 'api');

                    if (response.ok) {
                        const result = await response.json();
                        log(`å“åº”æˆåŠŸ: ${JSON.stringify(result, null, 2)}`, 'api');
                    } else {
                        log(`å“åº”å¤±è´¥: ${response.statusText}`, 'api');
                    }
                } catch (error) {
                    log(`è¯·æ±‚å¼‚å¸¸: ${error.message}`, 'api');
                }
            }

            async function testQuantifiedOrders() {
                log('=== æµ‹è¯•é‡åŒ–è®¢å•API ===', 'api');
                try {
                    const response = await fetch(`/api/quantified-orders/${tradingApiConfig.userId}?limit=10&status=all`);
                    log(`HTTPçŠ¶æ€: ${response.status} ${response.statusText}`, 'api');

                    if (response.ok) {
                        const result = await response.json();
                        log(`å“åº”æˆåŠŸ: ${JSON.stringify(result, null, 2)}`, 'api');
                    } else {
                        log(`å“åº”å¤±è´¥: ${response.statusText}`, 'api');
                    }
                } catch (error) {
                    log(`è¯·æ±‚å¼‚å¸¸: ${error.message}`, 'api');
                }
            }

            async function testNetworkRequests() {
                log('=== æµ‹è¯•ç½‘ç»œè¯·æ±‚ ===', 'network');

                // æµ‹è¯•æœåŠ¡å™¨è¿æ¥
                try {
                    const response = await fetch('/');
                    log(`æœåŠ¡å™¨è¿æ¥: ${response.status} ${response.statusText}`, 'network');
                } catch (error) {
                    log(`æœåŠ¡å™¨è¿æ¥å¤±è´¥: ${error.message}`, 'network');
                }

                // æµ‹è¯•APIç«¯ç‚¹
                const endpoints = [
                    '/api/manual-orders/test_user_001',
                    '/api/quantified-orders/test_user_001',
                    '/api/manual-orders/default',
                    '/api/quantified-orders/default'
                ];

                for (const endpoint of endpoints) {
                    try {
                        const response = await fetch(endpoint);
                        log(`${endpoint}: ${response.status} ${response.statusText}`, 'network');
                    } catch (error) {
                        log(`${endpoint}: è¯·æ±‚å¤±è´¥ - ${error.message}`, 'network');
                    }
                }
            }

            // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥é…ç½®
            window.onload = function () {
                checkConfig();
            };
        </script>
    </body>

</html>
